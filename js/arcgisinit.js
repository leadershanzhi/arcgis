// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.16/esri/copyright.txt for details.

//>>built
(function(b,l){var e,p=function(){},m=function(a){for(var c in a)return 0;return 1},n={}.toString,q=function(a){return"[object Function]"==n.call(a)},k=function(a){return"[object String]"==n.call(a)},g=function(a){return"[object Array]"==n.call(a)},a=function(a,c){if(a)for(var b=0;b<a.length;)c(a[b++])},f=function(a,c){for(var b in c)a[b]=c[b];return a},d=function(a,c){return f(Error(a),{src:"dojoLoader",info:c})},c=1,h=function(){return"_"+c++},r=function(a,c,b){return La(a,c,b,0,r)},t=this,v=t.document,
u=v&&v.createElement("DiV"),s=r.has=function(a){return q(y[a])?y[a]=y[a](t,v,u):y[a]},y=s.cache=l.hasCache;s.add=function(a,c,b,d){(void 0===y[a]||d)&&(y[a]=c);return b&&s(a)};s.add("host-webworker","undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope);s("host-webworker")&&(f(l.hasCache,{"host-browser":0,dom:0,"dojo-dom-ready-api":0,"dojo-sniff":0,"dojo-inject-api":1,"host-webworker":1}),l.loaderPatch={injectUrl:function(a,c){try{importScripts(a),c()}catch(b){console.info("failed to load resource ("+
a+")"),console.error(b)}}});for(var A in b.has)s.add(A,b.has[A],0,1);var w=0,F=[],x=0,C=p,I=p,O;r.isXdUrl=p;r.initSyncLoader=function(a,c,b){x||(x=a,C=c,I=b);return{sync:"sync",requested:1,arrived:2,nonmodule:3,executing:4,executed:5,syncExecStack:F,modules:z,execQ:Q,getModule:V,injectModule:pa,setArrived:ba,signal:D,finishExec:ga,execModule:ha,dojoRequirePlugin:x,getLegacyMode:function(){return w},guardCheckComplete:ia}};var P=location.protocol,K=location.host;r.isXdUrl=function(a){return/^\./.test(a)?
!1:/^\/\//.test(a)?!0:(a=a.match(/^([^\/\:]+\:)\/+([^\/]+)/))&&(a[1]!=P||K&&a[2]!=K)};s.add("dojo-force-activex-xhr",!v.addEventListener&&"file:"==window.location.protocol);s.add("native-xhr","undefined"!=typeof XMLHttpRequest);if(s("native-xhr")&&!s("dojo-force-activex-xhr"))O=function(){return new XMLHttpRequest};else{var S=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],B;for(e=0;3>e;)try{if(B=S[e++],new ActiveXObject(B))break}catch(G){}O=function(){return new ActiveXObject(B)}}r.getXhr=
O;s.add("dojo-gettext-api",1);r.getText=function(a,c,b){var f=O();f.open("GET",qa(a),!1);f.send(null);if(200==f.status||!location.host&&!f.status)b&&b(f.responseText,c);else throw d("xhrFailed",f.status);return f.responseText};var M=new Function("return eval(arguments[0]);");r.eval=function(a,c){return M(a+"\r\n//# sourceURL\x3d"+c)};var E={},D=r.signal=function(c,b){var d=E[c];a(d&&d.slice(0),function(a){a.apply(null,g(b)?b:[b])})},N=r.on=function(a,c){var b=E[a]||(E[a]=[]);b.push(c);return{remove:function(){for(var a=
0;a<b.length;a++)if(b[a]===c){b.splice(a,1);break}}}},da=[],Y={},$=[],L={},J=r.map={},T=[],z={},H="",W={},U={},ea={},X=0,ra=function(a){var c,b,d,f;for(c in U)b=U[c],(d=c.match(/^url\:(.+)/))?W["url:"+Ma(d[1],a)]=b:"*now"==c?f=b:"*noref"!=c&&(d=ja(c,a,!0),W[d.mid]=W["url:"+d.url]=b);f&&f(Ba(a));U={}},Na=function(a){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(a){return"\\"+a})},Ca=function(a,c){c.splice(0,c.length);for(var b in a)c.push([b,a[b],RegExp("^"+Na(b)+"(/|$)"),b.length]);c.sort(function(a,
c){return c[3]-a[3]});return c},$a=function(c,b){a(c,function(a){b.push([k(a[0])?RegExp("^"+Na(a[0])+"$"):a[0],a[1]])})},Oa=function(a){var c=a.name;c||(c=a,a={name:c});a=f({main:"main"},a);a.location=a.location?a.location:c;a.packageMap&&(J[c]=a.packageMap);a.main.indexOf("./")||(a.main=a.main.substring(2));L[c]=a},Pa=[],ka=function(c,b,d){for(var h in c){"waitSeconds"==h&&(r.waitms=1E3*(c[h]||0));"cacheBust"==h&&(H=c[h]?k(c[h])?c[h]:(new Date).getTime()+"":"");if("baseUrl"==h||"combo"==h)r[h]=c[h];
if("async"==h){var g=c[h];r.legacyMode=w=k(g)&&/sync|legacyAsync/.test(g)?g:!g?"sync":!1;r.async=!w}c[h]!==y&&(r.rawConfig[h]=c[h],"has"!=h&&s.add("config-"+h,c[h],0,b))}r.baseUrl||(r.baseUrl="./");/\/$/.test(r.baseUrl)||(r.baseUrl+="/");for(h in c.has)s.add(h,c.has[h],0,b);a(c.packages,Oa);for(var n in c.packagePaths)a(c.packagePaths[n],function(a){var c=n+"/"+a;k(a)&&(a={name:a});a.location=c;Oa(a)});Ca(f(J,c.map),T);a(T,function(a){a[1]=Ca(a[1],[]);"*"==a[0]&&(T.star=a)});Ca(f(Y,c.paths),$);$a(c.aliases,
da);if(b)Pa.push({config:c.config});else for(h in c.config)b=V(h,d),b.config=f(b.config||{},c.config[h]);c.cache&&(ra(),U=c.cache,c.cache["*noref"]&&ra());D("config",[c,r.rawConfig])};s("dojo-cdn");var sa=v.getElementsByTagName("script");e=0;for(var Z,ca,ta,la;e<sa.length;){Z=sa[e++];if((ta=Z.getAttribute("src"))&&(la=ta.match(/(((.*)\/)|^)dojo\.js(\W|$)/i)))ca=la[3]||"",l.baseUrl=l.baseUrl||ca,X=Z;if(ta=Z.getAttribute("data-dojo-config")||Z.getAttribute("djConfig"))ea=r.eval("({ "+ta+" })","data-dojo-config"),
X=Z}r.rawConfig={};ka(l,1);s("dojo-cdn")&&((L.dojo.location=ca)&&(ca+="/"),L.dijit.location=ca+"../dijit/",L.dojox.location=ca+"../dojox/");ka(b,1);ka(ea,1);var ma=function(c){ia(function(){a(c.deps,pa)})},La=function(a,c,b,s,n){var e;if(k(a)){if((e=V(a,s,!0))&&e.executed)return e.result;throw d("undefinedModule",a);}g(a)||(ka(a,0,s),a=c,c=b);if(g(a))if(a.length){b="require*"+h();for(var q,m=[],t=0;t<a.length;)q=a[t++],m.push(V(q,s));e=f(ua("",b,0,""),{injected:2,deps:m,def:c||p,require:s?s.require:
r,gc:1});z[e.mid]=e;ma(e);var x=na&&"sync"!=w;ia(function(){ha(e,x)});e.executed||Q.push(e);fa()}else c&&c();return n},Ba=function(a){if(!a)return r;var c=a.require;c||(c=function(b,d,f){return La(b,d,f,a,c)},a.require=f(c,r),c.module=a,c.toUrl=function(c){return Ma(c,a)},c.toAbsMid=function(c){return Da(c,a)},s("dojo-undef-api")&&(c.undef=function(c){r.undef(c,a)}),c.syncLoadNls=function(c){c=ja(c,a);var b=z[c.mid];if(!b||!b.executed)if(aa=W[c.mid]||W["url:"+c.url])va(aa),b=z[c.mid];return b&&b.executed&&
b.result});return c},Q=[],wa=[],R={},ab=function(a){a.injected=1;R[a.mid]=1;a.url&&(R[a.url]=a.pack||1);Qa()},ba=function(a){a.injected=2;delete R[a.mid];a.url&&delete R[a.url];m(R)&&(xa(),"xd"==w&&(w="sync"))},bb=r.idle=function(){return!wa.length&&m(R)&&!Q.length&&!na},Ea=function(a,c){if(c)for(var b=0;b<c.length;b++)if(c[b][2].test(a))return c[b];return 0},Ra=function(a){var c=[],b,d;for(a=a.replace(/\\/g,"/").split("/");a.length;)b=a.shift(),".."==b&&c.length&&".."!=d?(c.pop(),d=c[c.length-1]):
"."!=b&&c.push(d=b);return c.join("/")},ua=function(a,c,b,d){var f=r.isXdUrl(d);return{pid:a,mid:c,pack:b,url:d,executed:0,def:0,isXd:f,isAmd:!!(f||L[a]&&L[a].isAmd)}},Sa=function(c,b,f,h,g,r,n,e,k){var m,t,x,l;l=/^\./.test(c);if(/(^\/)|(\:)|(\.js$)/.test(c)||l&&!b)return ua(0,c,0,c);c=Ra(l?b.mid+"/../"+c:c);if(/^\./.test(c))throw d("irrationalPath",c);b&&(x=Ea(b.mid,r));(x=(x=x||r.star)&&Ea(c,x[1]))&&(c=x[1]+c.substring(x[3]));b=(la=c.match(/^([^\/]+)(\/(.+))?$/))?la[1]:"";(m=f[b])?c=b+"/"+(t=la[3]||
m.main):b="";var u=0;a(e,function(a){var b=c.match(a[0]);b&&0<b.length&&(u=q(a[1])?c.replace(a[0],a[1]):a[1])});if(u)return Sa(u,0,f,h,g,r,n,e,k);if(f=h[c])return k?ua(f.pid,f.mid,f.pack,f.url):h[c];h=(x=Ea(c,n))?x[1]+c.substring(x[3]):b?m.location+"/"+t:s("config-tlmSiblingOfDojo")?"../"+c:c;/(^\/)|(\:)/.test(h)||(h=g+h);return ua(b,c,m,Ra(h+".js"))},ja=function(a,c,b){return Sa(a,c,L,z,r.baseUrl,b?[]:T,b?[]:$,b?[]:da)},Ta=function(a,c,b){return a.normalize?a.normalize(c,function(a){return Da(a,
b)}):Da(c,b)},Ua=0,V=function(a,c,b){var d,f;(d=a.match(/^(.+?)\!(.*)$/))?(f=V(d[1],c,b),"sync"==w&&!f.executed&&(pa(f),2===f.injected&&!f.executed&&ia(function(){ha(f)}),f.executed?ya(f):Q.unshift(f)),5===f.executed&&!f.load&&ya(f),f.load?(d=Ta(f,d[2],c),a=f.mid+"!"+(f.dynamic?++Ua+"!":"")+d):(d=d[2],a=f.mid+"!"+ ++Ua+"!waitingForPlugin"),a={plugin:f,mid:a,req:Ba(c),prid:d}):a=ja(a,c);return z[a.mid]||!b&&(z[a.mid]=a)},Da=r.toAbsMid=function(a,c){return ja(a,c).mid},Ma=r.toUrl=function(a,c){var b=
ja(a+"/x",c),f=b.url;return qa(0===b.pid?a:f.substring(0,f.length-5))},Va={injected:2,executed:5,def:3,result:3},Fa=function(a){return z[a]=f({mid:a},Va)},cb=Fa("require"),db=Fa("exports"),eb=Fa("module"),za={},Ga=0,ya=function(a){var c=a.result;a.dynamic=c.dynamic;a.normalize=c.normalize;a.load=c.load;return a},fb=function(c){var b={};a(c.loadQ,function(a){var d=Ta(c,a.prid,a.req.module),h=c.dynamic?a.mid.replace(/waitingForPlugin$/,d):c.mid+"!"+d,d=f(f({},a),{mid:h,prid:d,injected:0});z[h]||Wa(z[h]=
d);b[a.mid]=z[h];ba(a);delete z[a.mid]});c.loadQ=0;var d=function(a){for(var c=a.deps||[],d=0;d<c.length;d++)(a=b[c[d].mid])&&(c[d]=a)},h;for(h in z)d(z[h]);a(Q,d)},ga=function(c){r.trace("loader-finish-exec",[c.mid]);c.executed=5;c.defOrder=Ga++;a(c.provides,function(a){a()});c.loadQ&&(ya(c),fb(c));for(e=0;e<Q.length;)Q[e]===c?Q.splice(e,1):e++;/^require\*/.test(c.mid)&&delete z[c.mid]},gb=[],ha=function(a,c){if(4===a.executed)return r.trace("loader-circular-dependency",[gb.concat(a.mid).join("-\x3e")]),
!a.def||c?za:a.cjs&&a.cjs.exports;if(!a.executed){if(!a.def)return za;var b=a.mid,f=a.deps||[],h,g=[],n=0;for(a.executed=4;h=f[n++];){h=h===cb?Ba(a):h===db?a.cjs.exports:h===eb?a.cjs:ha(h,c);if(h===za)return a.executed=0,r.trace("loader-exec-module",["abort",b]),za;g.push(h)}r.trace("loader-run-factory",[a.mid]);var b=a.def,e;F.unshift(a);if(s("config-dojo-loader-catches"))try{e=q(b)?b.apply(null,g):b}catch(k){D("error",a.result=d("factoryThrew",[a,k]))}else e=q(b)?b.apply(null,g):b;a.result=void 0===
e&&a.cjs?a.cjs.exports:e;F.shift(a);ga(a)}return a.result},na=0,ia=function(a){try{na++,a()}finally{na--}bb()&&D("idle",[])},fa=function(){na||ia(function(){C();for(var a,c,b=0;b<Q.length;)a=Ga,c=Q[b],ha(c),a!=Ga?(C(),b=0):b++})};s("dojo-undef-api")&&(r.undef=function(a,c){var b=V(a,c);ba(b);f(b,{def:0,executed:0,injected:0,node:0})});void 0===s("dojo-loader-eval-hint-url")&&s.add("dojo-loader-eval-hint-url",1);var qa="function"==typeof b.fixupUrl?b.fixupUrl:function(a){a+="";return a+(H?(/\?/.test(a)?
"\x26":"?")+H:"")},Wa=function(a){var c=a.plugin;5===c.executed&&!c.load&&ya(c);var b=function(c){a.result=c;ba(a);ga(a);fa()};c.load?c.load(a.prid,a.req,b):c.loadQ?c.loadQ.push(a):(c.loadQ=[a],Q.unshift(c),pa(c))},aa=0,oa=0,Ha=0,va=function(a,c){s("config-stripStrict")&&(a=a.replace(/"use strict"/g,""));Ha=1;if(s("config-dojo-loader-catches"))try{a===aa?aa.call(null):r.eval(a,s("dojo-loader-eval-hint-url")?c.url:c.mid)}catch(b){D("error",d("evalModuleThrew",c))}else a===aa?aa.call(null):r.eval(a,
s("dojo-loader-eval-hint-url")?c.url:c.mid);Ha=0},pa=function(c){var b=c.mid,h=c.url;if(!c.executed&&!c.injected&&!(R[b]||c.url&&(c.pack&&R[c.url]===c.pack||1==R[c.url])))if(ab(c),c.plugin)Wa(c);else{var g=function(){Xa(c);if(2!==c.injected){if(s("dojo-enforceDefine")){D("error",d("noDefine",c));return}ba(c);f(c,Va);r.trace("loader-define-nonmodule",[c.url])}w?!F.length&&fa():fa()};if(aa=W[b]||W["url:"+c.url])r.trace("loader-inject",["cache",c.mid,h]),va(aa,c),g();else{if(w)if(c.isXd)"sync"==w&&(w=
"xd");else if(!(c.isAmd&&"sync"!=w)){var n=function(d){if("sync"==w){F.unshift(c);va(d,c);F.shift();Xa(c);c.cjs||(ba(c),ga(c));if(c.finish){d=b+"*finish";var f=c.finish;delete c.finish;Ia(d,["dojo",("dojo/require!"+f.join(",")).replace(/\./g,"/")],function(c){a(f,function(a){c.require(a)})});Q.unshift(V(d))}g()}else(d=I(c,d))?(va(d,c),g()):(oa=c,r.injectUrl(qa(h),g,c),oa=0)};r.trace("loader-inject",["xhr",c.mid,h,"sync"!=w]);if(s("config-dojo-loader-catches"))try{r.getText(h,"sync"!=w,n)}catch(e){D("error",
d("xhrInjectFailed",[c,e]))}else r.getText(h,"sync"!=w,n);return}r.trace("loader-inject",["script",c.mid,h]);oa=c;r.injectUrl(qa(h),g,c);oa=0}}},Ja=function(a,c,b){r.trace("loader-define-module",[a.mid,c]);var h=a.mid;if(2===a.injected)return D("error",d("multipleDefine",a)),a;f(a,{deps:c,def:b,cjs:{id:a.mid,uri:a.url,exports:a.result={},setExports:function(c){a.cjs.exports=c},config:function(){return a.config}}});for(var g=0;c[g];g++)c[g]=V(c[g],a);w&&!R[h]&&(ma(a),Q.push(a),fa());ba(a);!q(b)&&!c.length&&
(a.result=b,ga(a));return a},Xa=function(c,b){for(var d=[],f,h;wa.length;)h=wa.shift(),b&&(h[0]=b.shift()),f=h[0]&&V(h[0])||c,d.push([f,h[1],h[2]]);ra(c);a(d,function(a){ma(Ja.apply(null,a))})},Aa=0,xa=p,Qa=p,xa=function(){Aa&&clearTimeout(Aa);Aa=0},Qa=function(){xa();r.waitms&&(Aa=t.setTimeout(function(){xa();D("error",d("timeout",R))},r.waitms))};s.add("ie-event-behavior",v.attachEvent&&"undefined"===typeof Windows&&("undefined"===typeof opera||"[object Opera]"!=opera.toString()));var Ka=function(a,
c,b,d){if(s("ie-event-behavior"))return a.attachEvent(b,d),function(){a.detachEvent(b,d)};a.addEventListener(c,d,!1);return function(){a.removeEventListener(c,d,!1)}},hb=Ka(window,"load","onload",function(){r.pageLoaded=1;"complete"!=v.readyState&&(v.readyState="complete");hb()}),sa=v.getElementsByTagName("script");for(e=0;!X;)if(!/^dojo/.test((Z=sa[e++])&&Z.type))X=Z;r.injectUrl=function(a,c,b){b=b.node=v.createElement("script");var f=Ka(b,"load","onreadystatechange",function(a){a=a||window.event;
var b=a.target||a.srcElement;if("load"===a.type||/complete|loaded/.test(b.readyState))f(),h(),c&&c()}),h=Ka(b,"error","onerror",function(c){f();h();D("error",d("scriptError",[a,c]))});b.type="text/javascript";b.charset="utf-8";b.src=a;X.parentNode.insertBefore(b,X);return b};r.log=function(){try{for(var a=0;a<arguments.length;a++)console.log(arguments[a])}catch(c){}};r.trace=p;var Ia=function(a,c,b){var f=arguments.length,h=["require","exports","module"],g=[0,a,c];1==f?g=[0,q(a)?h:[],a]:2==f&&k(a)?
g=[a,q(c)?h:[],c]:3==f&&(g=[a,c,b]);r.trace("loader-define",g.slice(0,2));if((f=g[0]&&V(g[0]))&&!R[f.mid])ma(Ja(f,g[1],g[2]));else if(!s("ie-event-behavior")||Ha)wa.push(g);else{f=f||oa;if(!f)for(a in R)if((h=z[a])&&h.node&&"interactive"===h.node.readyState){f=h;break}f?(ra(f),ma(Ja(f,g[1],g[2]))):D("error",d("ieDefineFailed",g[0]));fa()}};Ia.amd={vendor:"dojotoolkit.org"};f(f(r,l.loaderPatch),b.loaderPatch);N("error",function(a){try{if(console.error(a),a instanceof Error){for(var c in a)console.log(c+
":",a[c]);console.log(".")}}catch(b){}});f(r,{uid:h,cache:W,packs:L});if(t.define)D("error",d("defineAlreadyDefined",0));else{t.define=Ia;t.require=r;a(Pa,function(a){ka(a)});var Ya=ea.deps||b.deps||l.deps,Za=ea.callback||b.callback||l.callback;r.boot=Ya||Za?[Ya||[],Za]:0}})(this.dojoConfig||this.djConfig||this.require||{},{async:0,baseUrl:(location.protocol === 'file:' ? 'http:' : location.protocol) + '//' + "js.arcgis.com/3.16/dojo",hasCache:{"config-selectorEngine":"acme","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-has-api":1,"dojo-loader":1,"dojo-undef-api":0,
dom:1,"extend-esri":1,"host-browser":1},packages:[{location:"../moment",main:"moment.js",name:"moment"},{location:"../put-selector",main:"put",name:"put-selector"},{location:"../xstyle",name:"xstyle"},{location:"../dojox",name:"dojox"},{location:"../dstore",main:"Store",name:"dstore"},{location:"../esri",name:"esri"},{location:"../dijit",name:"dijit"},{location:"../dgrid",main:"OnDemandGrid",name:"dgrid"},{location:".",name:"dojo"}]});
require({cache:{"dojo/request/default":function(){define(["exports","require","../has"],function(b,l,e){var p=e("config-requestProvider");p||(p="./xhr");b.getPlatformDefaultId=function(){return"./xhr"};b.load=function(b,n,e,k){l(["platform"==b?"./xhr":p],function(b){e(b)})}})},"dojo/_base/fx":function(){define("./kernel ./config ./lang ../Evented ./Color ../aspect ../sniff ../dom ../dom-style".split(" "),function(b,l,e,p,m,n,q,k,g){var a=e.mixin,f={},d=f._Line=function(a,c){this.start=a;this.end=
c};d.prototype.getValue=function(a){return(this.end-this.start)*a+this.start};var c=f.Animation=function(c){a(this,c);e.isArray(this.curve)&&(this.curve=new d(this.curve[0],this.curve[1]))};c.prototype=new p;e.extend(c,{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,_getStep:function(){var a=this._percent,c=this.easing;return c?c(a):a},_fire:function(a,c){var b=c||[];if(this[a])if(l.debugAtAllCosts)this[a].apply(this,b);else try{this[a].apply(this,b)}catch(d){console.error("exception in animation handler for:",
a),console.error(d)}return this},play:function(a,c){this._delayTimer&&this._clearTimer();if(c)this._stopTimer(),this._active=this._paused=!1,this._percent=0;else if(this._active&&!this._paused)return this;this._fire("beforeBegin",[this.node]);var b=a||this.delay,d=e.hitch(this,"_play",c);if(0<b)return this._delayTimer=setTimeout(d,b),this;d();return this},_play:function(a){this._delayTimer&&this._clearTimer();this._startTime=(new Date).valueOf();this._paused&&(this._startTime-=this.duration*this._percent);
this._active=!0;this._paused=!1;a=this.curve.getValue(this._getStep());this._percent||(this._startRepeatCount||(this._startRepeatCount=this.repeat),this._fire("onBegin",[a]));this._fire("onPlay",[a]);this._cycle();return this},pause:function(){this._delayTimer&&this._clearTimer();this._stopTimer();if(!this._active)return this;this._paused=!0;this._fire("onPause",[this.curve.getValue(this._getStep())]);return this},gotoPercent:function(a,c){this._stopTimer();this._active=this._paused=!0;this._percent=
a;c&&this.play();return this},stop:function(a){this._delayTimer&&this._clearTimer();if(!this._timer)return this;this._stopTimer();a&&(this._percent=1);this._fire("onStop",[this.curve.getValue(this._getStep())]);this._active=this._paused=!1;return this},destroy:function(){this.stop()},status:function(){return this._active?this._paused?"paused":"playing":"stopped"},_cycle:function(){if(this._active){var a=(new Date).valueOf(),a=0===this.duration?1:(a-this._startTime)/this.duration;1<=a&&(a=1);this._percent=
a;this.easing&&(a=this.easing(a));this._fire("onAnimate",[this.curve.getValue(a)]);1>this._percent?this._startTimer():(this._active=!1,0<this.repeat?(this.repeat--,this.play(null,!0)):-1==this.repeat?this.play(null,!0):this._startRepeatCount&&(this.repeat=this._startRepeatCount,this._startRepeatCount=0),this._percent=0,this._fire("onEnd",[this.node]),!this.repeat&&this._stopTimer())}return this},_clearTimer:function(){clearTimeout(this._delayTimer);delete this._delayTimer}});var h=0,r=null,t={run:function(){}};
e.extend(c,{_startTimer:function(){this._timer||(this._timer=n.after(t,"run",e.hitch(this,"_cycle"),!0),h++);r||(r=setInterval(e.hitch(t,"run"),this.rate))},_stopTimer:function(){this._timer&&(this._timer.remove(),this._timer=null,h--);0>=h&&(clearInterval(r),r=null,h=0)}});var v=q("ie")?function(a){var c=a.style;!c.width.length&&"auto"==g.get(a,"width")&&(c.width="auto")}:function(){};f._fade=function(c){c.node=k.byId(c.node);var b=a({properties:{}},c);c=b.properties.opacity={};c.start=!("start"in
b)?function(){return+g.get(b.node,"opacity")||0}:b.start;c.end=b.end;c=f.animateProperty(b);n.after(c,"beforeBegin",e.partial(v,b.node),!0);return c};f.fadeIn=function(c){return f._fade(a({end:1},c))};f.fadeOut=function(c){return f._fade(a({end:0},c))};f._defaultEasing=function(a){return 0.5+Math.sin((a+1.5)*Math.PI)/2};var u=function(a){this._properties=a;for(var c in a){var b=a[c];b.start instanceof m&&(b.tempColor=new m)}};u.prototype.getValue=function(a){var c={},b;for(b in this._properties){var d=
this._properties[b],f=d.start;f instanceof m?c[b]=m.blendColors(f,d.end,a,d.tempColor).toCss():e.isArray(f)||(c[b]=(d.end-f)*a+f+("opacity"!=b?d.units||"px":0))}return c};f.animateProperty=function(d){var f=d.node=k.byId(d.node);d.easing||(d.easing=b._defaultEasing);d=new c(d);n.after(d,"beforeBegin",e.hitch(d,function(){var c={},b;for(b in this.properties){if("width"==b||"height"==b)this.node.display="block";var d=this.properties[b];e.isFunction(d)&&(d=d(f));d=c[b]=a({},e.isObject(d)?d:{end:d});
e.isFunction(d.start)&&(d.start=d.start(f));e.isFunction(d.end)&&(d.end=d.end(f));var h=0<=b.toLowerCase().indexOf("color"),r=function(a,c){var b={height:a.offsetHeight,width:a.offsetWidth}[c];if(void 0!==b)return b;b=g.get(a,c);return"opacity"==c?+b:h?b:parseFloat(b)};"end"in d?"start"in d||(d.start=r(f,b)):d.end=r(f,b);h?(d.start=new m(d.start),d.end=new m(d.end)):d.start="opacity"==b?+d.start:parseFloat(d.start)}this.curve=new u(c)}),!0);n.after(d,"onAnimate",e.hitch(g,"set",d.node),!0);return d};
f.anim=function(a,b,d,h,g,r){return f.animateProperty({node:a,duration:d||c.prototype.duration,properties:b,easing:h,onEnd:g}).play(r||0)};a(b,f);b._Animation=c;return f})},"dojo/dom-form":function(){define(["./_base/lang","./dom","./io-query","./json"],function(b,l,e,p){var m={fieldToObject:function(b){var e=null;if(b=l.byId(b)){var k=b.name,g=(b.type||"").toLowerCase();if(k&&g&&!b.disabled)if("radio"==g||"checkbox"==g)b.checked&&(e=b.value);else if(b.multiple){e=[];for(b=[b.firstChild];b.length;)for(k=
b.pop();k;k=k.nextSibling)if(1==k.nodeType&&"option"==k.tagName.toLowerCase())k.selected&&e.push(k.value);else{k.nextSibling&&b.push(k.nextSibling);k.firstChild&&b.push(k.firstChild);break}}else e=b.value}return e},toObject:function(e){var q={};e=l.byId(e).elements;for(var k=0,g=e.length;k<g;++k){var a=e[k],f=a.name,d=(a.type||"").toLowerCase();if(f&&d&&0>"file|submit|image|reset|button".indexOf(d)&&!a.disabled){var c=q,h=f,a=m.fieldToObject(a);if(null!==a){var r=c[h];"string"==typeof r?c[h]=[r,a]:
b.isArray(r)?r.push(a):c[h]=a}"image"==d&&(q[f+".x"]=q[f+".y"]=q[f].x=q[f].y=0)}}return q},toQuery:function(b){return e.objectToQuery(m.toObject(b))},toJson:function(b,e){return p.stringify(m.toObject(b),null,e?4:0)}};return m})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./_base/xhr ./json module".split(" "),function(b,l,e,p,m,n,q,k,g){e.add("dojo-preload-i18n-Api",1);var a=b.i18n={},f=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,d=function(a,
c,b,d){var f=[b+d];c=c.split("-");for(var h="",g=0;g<c.length;g++)if(h+=(h?"-":"")+c[g],!a||a[h])f.push(b+h+"/"+d),f.specificity=h;return f},c={},h=function(a,c,d){d=d?d.toLowerCase():b.locale;a=a.replace(/\./g,"/");c=c.replace(/\./g,"/");return/root/i.test(d)?a+"/nls/"+c:a+"/nls/"+d+"/"+c},r=b.getL10nName=function(a,c,b){return g.id+"!"+h(a,c,b)},t=function(a,b,f,h,g,r){a([b],function(e){var k=n.clone(e.root||e.ROOT),m=d(!e._v1x&&e,g,f,h);a(m,function(){for(var a=1;a<m.length;a++)k=n.mixin(n.clone(k),
arguments[a]);c[b+"/"+g]=k;k.$locale=m.specificity;r()})})},v=function(a){var c=m.extraLocale||[],c=n.isArray(c)?c:[c];c.push(a);return c},u=function(a,d,h){if(e("dojo-preload-i18n-Api")){var g=a.split("*"),r="preload"==g[1];r&&(c[a]||(c[a]=1,F(g[2],k.parse(g[3]),1,d)),h(1));if(!(g=r))A&&w.push([a,d,h]),g=A;if(g)return}a=f.exec(a);var m=a[1]+"/",s=a[5]||a[4],q=m+s,g=(a=a[5]&&a[4])||b.locale||"",l=q+"/"+g;a=a?[g]:v(g);var u=a.length,y=function(){--u||h(n.delegate(c[l]))};p.forEach(a,function(a){var b=
q+"/"+a;e("dojo-preload-i18n-Api")&&x(b);c[b]?y():t(d,q,m,s,a,y)})};if(e("dojo-unit-tests"))var s=a.unitTests=[];e("dojo-preload-i18n-Api");var y=a.normalizeLocale=function(a){a=a?a.toLowerCase():b.locale;return"root"==a?"ROOT":a},A=0,w=[],F=a._preloadLocalizations=function(a,d,f,h){function g(a,c){h.isXdUrl(l.toUrl(a+".js"))||f?h([a],c):O([a],c,h)}function r(a,c){for(var b=a.split("-");b.length;){if(c(b.join("-")))return;b.pop()}c("ROOT")}function e(){for(--A;!A&&w.length;)u.apply(null,w.shift())}
function k(b){b=y(b);r(b,function(f){if(0<=p.indexOf(d,f)){var k=a.replace(/\./g,"/")+"_"+f;A++;g(k,function(a){for(var d in a){var g=a[d],k=d.match(/(.+)\/([^\/]+)$/),m;if(k){m=k[2];k=k[1]+"/";g._localized=g._localized||{};var s;if("ROOT"===f){var t=s=g._localized;delete g._localized;t.root=g;c[l.toAbsMid(d)]=t}else s=g._localized,c[l.toAbsMid(k+m+"/"+f)]=g;f!==b&&function(a,d,f,g){var k=[],m=[];r(b,function(c){g[c]&&(k.push(l.toAbsMid(a+c+"/"+d)),m.push(l.toAbsMid(a+d+"/"+c)))});k.length?(A++,h(k,
function(){for(var h=0;h<k.length;h++)f=n.mixin(n.clone(f),arguments[h]),c[m[h]]=f;c[l.toAbsMid(a+d+"/"+b)]=n.clone(f);e()})):c[l.toAbsMid(a+d+"/"+b)]=f}(k,m,g,s)}}e()});return!0}return!1})}h=h||l;k();p.forEach(b.config.extraLocale,k)},x=function(){},C={},I=new Function("__bundle","__checkForLegacyModules","__mid","__amdValue","var define \x3d function(mid, factory){define.called \x3d 1; __amdValue.result \x3d factory || mid;},\t   require \x3d function(){define.called \x3d 1;};try{define.called \x3d 0;eval(__bundle);if(define.called\x3d\x3d1)return __amdValue;if((__checkForLegacyModules \x3d __checkForLegacyModules(__mid)))return __checkForLegacyModules;}catch(e){}try{return eval('('+__bundle+')');}catch(e){return e;}"),
O=function(a,b,d){var f=[];p.forEach(a,function(a){function b(d){d=I(d,x,a,C);d===C?f.push(c[h]=C.result):(d instanceof Error&&(console.error("failed to evaluate i18n bundle; url\x3d"+h,d),d={}),f.push(c[h]=/nls\/[^\/]+\/[^\/]+$/.test(h)?d:{root:d,_v1x:1}))}var h=d.toUrl(a+".js");if(c[h])f.push(c[h]);else{var g=d.syncLoadNls(a);if(g)f.push(g);else if(q)q.get({url:h,sync:!0,load:b,error:function(){f.push(c[h]={})}});else try{d.getText(h,!0,b)}catch(r){f.push(c[h]={})}}});b&&b.apply(null,f)},x=function(a){for(var d,
f=a.split("/"),h=b.global[f[0]],g=1;h&&g<f.length-1;h=h[f[g++]]);h&&((d=h[f[g]])||(d=h[f[g].replace(/-/g,"_")]),d&&(c[a]=d));return d};a.getLocalization=function(a,c,b){var d;a=h(a,c,b);u(a,!l.isXdUrl(l.toUrl(a+".js"))?function(a,c){O(a,c,l)}:l,function(a){d=a});return d};e("dojo-unit-tests")&&s.push(function(a){a.register("tests.i18n.unit",function(a){var c;c=I("{prop:1}",x,"nonsense",C);a.is({prop:1},c);a.is(void 0,c[1]);c=I("({prop:1})",x,"nonsense",C);a.is({prop:1},c);a.is(void 0,c[1]);c=I("{'prop-x':1}",
x,"nonsense",C);a.is({"prop-x":1},c);a.is(void 0,c[1]);c=I("({'prop-x':1})",x,"nonsense",C);a.is({"prop-x":1},c);a.is(void 0,c[1]);c=I("define({'prop-x':1})",x,"nonsense",C);a.is(C,c);a.is({"prop-x":1},C.result);c=I("define('some/module', {'prop-x':1})",x,"nonsense",C);a.is(C,c);a.is({"prop-x":1},C.result);c=I("this is total nonsense and should throw an error",x,"nonsense",C);a.is(c instanceof Error,!0)})});return n.mixin(a,{dynamic:!0,normalize:function(a,c){return/^\./.test(a)?c(a):a},load:u,cache:c,
getL10nName:r})})},"dojo/promise/tracer":function(){define(["../_base/lang","./Promise","../Evented"],function(b,l,e){function p(b){setTimeout(function(){n.apply(m,b)},0)}var m=new e,n=m.emit;m.emit=null;l.prototype.trace=function(){var e=b._toArray(arguments);this.then(function(b){p(["resolved",b].concat(e))},function(b){p(["rejected",b].concat(e))},function(b){p(["progress",b].concat(e))});return this};l.prototype.traceRejected=function(){var e=b._toArray(arguments);this.otherwise(function(b){p(["rejected",
b].concat(e))});return this};return m})},"dojo/errors/RequestError":function(){define(["./create"],function(b){return b("RequestError",function(b,e){this.response=e})})},"dojo/_base/html":function(){define("./kernel ../dom ../dom-style ../dom-attr ../dom-prop ../dom-class ../dom-construct ../dom-geometry".split(" "),function(b,l,e,p,m,n,q,k){b.byId=l.byId;b.isDescendant=l.isDescendant;b.setSelectable=l.setSelectable;b.getAttr=p.get;b.setAttr=p.set;b.hasAttr=p.has;b.removeAttr=p.remove;b.getNodeProp=
p.getNodeProp;b.attr=function(b,a,f){return 2==arguments.length?p["string"==typeof a?"get":"set"](b,a):p.set(b,a,f)};b.hasClass=n.contains;b.addClass=n.add;b.removeClass=n.remove;b.toggleClass=n.toggle;b.replaceClass=n.replace;b._toDom=b.toDom=q.toDom;b.place=q.place;b.create=q.create;b.empty=function(b){q.empty(b)};b._destroyElement=b.destroy=function(b){q.destroy(b)};b._getPadExtents=b.getPadExtents=k.getPadExtents;b._getBorderExtents=b.getBorderExtents=k.getBorderExtents;b._getPadBorderExtents=
b.getPadBorderExtents=k.getPadBorderExtents;b._getMarginExtents=b.getMarginExtents=k.getMarginExtents;b._getMarginSize=b.getMarginSize=k.getMarginSize;b._getMarginBox=b.getMarginBox=k.getMarginBox;b.setMarginBox=k.setMarginBox;b._getContentBox=b.getContentBox=k.getContentBox;b.setContentSize=k.setContentSize;b._isBodyLtr=b.isBodyLtr=k.isBodyLtr;b._docScroll=b.docScroll=k.docScroll;b._getIeDocumentElementOffset=b.getIeDocumentElementOffset=k.getIeDocumentElementOffset;b._fixIeBiDiScrollLeft=b.fixIeBiDiScrollLeft=
k.fixIeBiDiScrollLeft;b.position=k.position;b.marginBox=function(b,a){return a?k.setMarginBox(b,a):k.getMarginBox(b)};b.contentBox=function(b,a){return a?k.setContentSize(b,a):k.getContentBox(b)};b.coords=function(g,a){b.deprecated("dojo.coords()","Use dojo.position() or dojo.marginBox().");g=l.byId(g);var f=e.getComputedStyle(g),f=k.getMarginBox(g,f),d=k.position(g,a);f.x=d.x;f.y=d.y;return f};b.getProp=m.get;b.setProp=m.set;b.prop=function(b,a,f){return 2==arguments.length?m["string"==typeof a?
"get":"set"](b,a):m.set(b,a,f)};b.getStyle=e.get;b.setStyle=e.set;b.getComputedStyle=e.getComputedStyle;b.__toPixelValue=b.toPixelValue=e.toPixelValue;b.style=function(b,a,f){switch(arguments.length){case 1:return e.get(b);case 2:return e["string"==typeof a?"get":"set"](b,a)}return e.set(b,a,f)};return b})},"dojo/_base/kernel":function(){define(["../has","./config","require","module"],function(b,l,e,p){var m,n;m=function(){return this}();var q={},k={},g={config:l,global:m,dijit:q,dojox:k},q={dojo:["dojo",
g],dijit:["dijit",q],dojox:["dojox",k]};p=e.map&&e.map[p.id.match(/[^\/]+/)[0]];for(n in p)q[n]?q[n][0]=p[n]:q[n]=[p[n],{}];for(n in q)p=q[n],p[1]._scopeName=p[0],l.noGlobals||(m[p[0]]=p[1]);g.scopeMap=q;g.baseUrl=g.config.baseUrl=e.baseUrl;g.isAsync=e.async;g.locale=l.locale;m="$Rev: f4fef70 $".match(/[0-9a-f]{7,}/);g.version={major:1,minor:10,patch:4,flag:"",revision:m?m[0]:NaN,toString:function(){var a=g.version;return a.major+"."+a.minor+"."+a.patch+a.flag+" ("+a.revision+")"}};Function("d","d.eval \x3d function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(g);
g.exit=function(){};"undefined"!=typeof console||(console={});p="assert count debug dir dirxml error group groupEnd info profile profileEnd time timeEnd trace warn log".split(" ");var a;for(m=0;a=p[m++];)console[a]||function(){var b=a+"";console[b]="log"in console?function(){var a=Array.prototype.slice.call(arguments);a.unshift(b+":");console.log(a.join(" "))}:function(){};console[b]._fake=!0}();b.add("dojo-debug-messages",!!l.isDebug);g.deprecated=g.experimental=function(){};b("dojo-debug-messages")&&
(g.deprecated=function(a,b,c){a="DEPRECATED: "+a;b&&(a+=" "+b);c&&(a+=" -- will be removed in version: "+c);console.warn(a)},g.experimental=function(a,b){var c="EXPERIMENTAL: "+a+" -- APIs subject to change without notice.";b&&(c+=" "+b);console.warn(c)});if(l.modulePaths){g.deprecated("dojo.modulePaths","use paths configuration");b={};for(n in l.modulePaths)b[n.replace(/\./g,"/")]=l.modulePaths[n];e({paths:b})}g.moduleUrl=function(a,b){g.deprecated("dojo.moduleUrl()","use require.toUrl","2.0");var c=
null;a&&(c=e.toUrl(a.replace(/\./g,"/")+(b?"/"+b:"")+"/*.*").replace(/\/\*\.\*/,"")+(b?"":"/"));return c};g._hasResource={};return g})},"dojo/io-query":function(){define(["./_base/lang"],function(b){var l={};return{objectToQuery:function(e){var p=encodeURIComponent,m=[],n;for(n in e){var q=e[n];if(q!=l[n]){var k=p(n)+"\x3d";if(b.isArray(q))for(var g=0,a=q.length;g<a;++g)m.push(k+p(q[g]));else m.push(k+p(q))}}return m.join("\x26")},queryToObject:function(e){var l=decodeURIComponent;e=e.split("\x26");
for(var m={},n,q,k=0,g=e.length;k<g;++k)if(q=e[k],q.length){var a=q.indexOf("\x3d");0>a?(n=l(q),q=""):(n=l(q.slice(0,a)),q=l(q.slice(a+1)));"string"==typeof m[n]&&(m[n]=[m[n]]);b.isArray(m[n])?m[n].push(q):m[n]=q}return m}}})},"dojo/_base/Deferred":function(){define("./kernel ../Deferred ../promise/Promise ../errors/CancelError ../has ./lang ../when".split(" "),function(b,l,e,p,m,n,q){var k=function(){},g=Object.freeze||function(){},a=b.Deferred=function(b){function d(a){if(r)throw Error("This deferred has already been resolved");
h=a;r=!0;c()}function c(){for(var a;!a&&y;){var c=y;y=y.next;if(a=c.progress==k)r=!1;var b=u?c.error:c.resolved;m("config-useDeferredInstrumentation")&&u&&l.instrumentRejected&&l.instrumentRejected(h,!!b);if(b)try{var d=b(h);d&&"function"===typeof d.then?d.then(n.hitch(c.deferred,"resolve"),n.hitch(c.deferred,"reject"),n.hitch(c.deferred,"progress")):(b=a&&void 0===d,a&&!b&&(u=d instanceof Error),c.deferred[b&&u?"reject":"resolve"](b?h:d))}catch(f){c.deferred.reject(f)}else u?c.deferred.reject(h):
c.deferred.resolve(h)}}var h,r,t,q,u,s,y,A=this.promise=new e;this.isResolved=A.isResolved=function(){return 0==q};this.isRejected=A.isRejected=function(){return 1==q};this.isFulfilled=A.isFulfilled=function(){return 0<=q};this.isCanceled=A.isCanceled=function(){return t};this.resolve=this.callback=function(a){this.fired=q=0;this.results=[a,null];d(a)};this.reject=this.errback=function(a){u=!0;this.fired=q=1;m("config-useDeferredInstrumentation")&&l.instrumentRejected&&l.instrumentRejected(a,!!y);
d(a);this.results=[null,a]};this.progress=function(a){for(var c=y;c;){var b=c.progress;b&&b(a);c=c.next}};this.addCallbacks=function(a,c){this.then(a,c,k);return this};A.then=this.then=function(b,d,f){var h=f==k?this:new a(A.cancel);b={resolved:b,error:d,progress:f,deferred:h};y?s=s.next=b:y=s=b;r&&c();return h.promise};var w=this;A.cancel=this.cancel=function(){if(!r){var a=b&&b(w);r||(a instanceof Error||(a=new p(a)),a.log=!1,w.reject(a))}t=!0};g(A)};n.extend(a,{addCallback:function(a){return this.addCallbacks(n.hitch.apply(b,
arguments))},addErrback:function(a){return this.addCallbacks(null,n.hitch.apply(b,arguments))},addBoth:function(a){var d=n.hitch.apply(b,arguments);return this.addCallbacks(d,d)},fired:-1});a.when=b.when=q;return a})},"dojo/NodeList-dom":function(){define("./_base/kernel ./query ./_base/array ./_base/lang ./dom-class ./dom-construct ./dom-geometry ./dom-attr ./dom-style".split(" "),function(b,l,e,p,m,n,q,k,g){function a(a){return function(c,b,d){return 2==arguments.length?a["string"==typeof b?"get":
"set"](c,b):a.set(c,b,d)}}var f=function(a){return 1==a.length&&"string"==typeof a[0]},d=function(a){var c=a.parentNode;c&&c.removeChild(a)},c=l.NodeList,h=c._adaptWithCondition,r=c._adaptAsForEach,t=c._adaptAsMap;p.extend(c,{_normalize:function(a,c){var d=!0===a.parse;if("string"==typeof a.template){var f=a.templateFunc||b.string&&b.string.substitute;a=f?f(a.template,a):a}f=typeof a;"string"==f||"number"==f?(a=n.toDom(a,c&&c.ownerDocument),a=11==a.nodeType?p._toArray(a.childNodes):[a]):p.isArrayLike(a)?
p.isArray(a)||(a=p._toArray(a)):a=[a];d&&(a._runParse=!0);return a},_cloneNode:function(a){return a.cloneNode(!0)},_place:function(a,c,d,f){if(!(1!=c.nodeType&&"only"==d))for(var h,g=a.length,r=g-1;0<=r;r--){var e=f?this._cloneNode(a[r]):a[r];if(a._runParse&&b.parser&&b.parser.parse){h||(h=c.ownerDocument.createElement("div"));h.appendChild(e);b.parser.parse(h);for(e=h.firstChild;h.firstChild;)h.removeChild(h.firstChild)}r==g-1?n.place(e,c,d):c.parentNode.insertBefore(e,c);c=e}},position:t(q.position),
attr:h(a(k),f),style:h(a(g),f),addClass:r(m.add),removeClass:r(m.remove),toggleClass:r(m.toggle),replaceClass:r(m.replace),empty:r(n.empty),removeAttr:r(k.remove),marginBox:t(q.getMarginBox),place:function(a,c){var b=l(a)[0];return this.forEach(function(a){n.place(a,b,c)})},orphan:function(a){return(a?l._filterResult(this,a):this).forEach(d)},adopt:function(a,c){return l(a).place(this[0],c)._stash(this)},query:function(a){if(!a)return this;var b=new c;this.map(function(c){l(a,c).forEach(function(a){void 0!==
a&&b.push(a)})});return b._stash(this)},filter:function(a){var c=arguments,b=this,d=0;if("string"==typeof a){b=l._filterResult(this,c[0]);if(1==c.length)return b._stash(this);d=1}return this._wrap(e.filter(b,c[d],c[d+1]),this)},addContent:function(a,c){a=this._normalize(a,this[0]);for(var b=0,d;d=this[b];b++)a.length?this._place(a,d,c,0<b):n.empty(d);return this}});return c})},"dojo/query":function(){define("./_base/kernel ./has ./dom ./on ./_base/array ./_base/lang ./selector/_loader ./selector/_loader!default".split(" "),
function(b,l,e,p,m,n,q,k){function g(a,c){var b=function(b,d){if("string"==typeof d&&(d=e.byId(d),!d))return new c([]);var f="string"==typeof b?a(b,d):b?b.end&&b.on?b:[b]:[];return f.end&&f.on?f:new c(f)};b.matches=a.match||function(a,c,d){return 0<b.filter([a],c,d).length};b.filter=a.filter||function(a,c,d){return b(c,d).filter(function(c){return-1<m.indexOf(a,c)})};if("function"!=typeof a){var d=a.search;a=function(a,c){return d(c||document,a)}}return b}l.add("array-extensible",function(){return 1==
n.delegate([],{length:1}).length&&!l("bug-for-in-skips-shadowed")});var a=Array.prototype,f=a.slice,d=a.concat,c=m.forEach,h=function(a,c,d){c=[0].concat(f.call(c,0));d=d||b.global;return function(b){c[0]=b;return a.apply(d,c)}},r=function(a){var c=this instanceof t&&l("array-extensible");"number"==typeof a&&(a=Array(a));var b=a&&"length"in a?a:arguments;if(c||!b.sort){for(var d=c?this:[],f=d.length=b.length,h=0;h<f;h++)d[h]=b[h];if(c)return d;b=d}n._mixin(b,v);b._NodeListCtor=function(a){return t(a)};
return b},t=r,v=t.prototype=l("array-extensible")?[]:{};t._wrap=v._wrap=function(a,c,b){a=new (b||this._NodeListCtor||t)(a);return c?a._stash(c):a};t._adaptAsMap=function(a,c){return function(){return this.map(h(a,arguments,c))}};t._adaptAsForEach=function(a,c){return function(){this.forEach(h(a,arguments,c));return this}};t._adaptAsFilter=function(a,c){return function(){return this.filter(h(a,arguments,c))}};t._adaptWithCondition=function(a,c,d){return function(){var f=arguments,g=h(a,f,d);if(c.call(d||
b.global,f))return this.map(g);this.forEach(g);return this}};c(["slice","splice"],function(c){var b=a[c];v[c]=function(){return this._wrap(b.apply(this,arguments),"slice"==c?this:null)}});c(["indexOf","lastIndexOf","every","some"],function(a){var c=m[a];v[a]=function(){return c.apply(b,[this].concat(f.call(arguments,0)))}});n.extend(r,{constructor:t,_NodeListCtor:t,toString:function(){return this.join(",")},_stash:function(a){this._parent=a;return this},on:function(a,c){var b=this.map(function(b){return p(b,
a,c)});b.remove=function(){for(var a=0;a<b.length;a++)b[a].remove()};return b},end:function(){return this._parent?this._parent:new this._NodeListCtor(0)},concat:function(a){var c=f.call(this,0),b=m.map(arguments,function(a){return f.call(a,0)});return this._wrap(d.apply(c,b),this)},map:function(a,c){return this._wrap(m.map(this,a,c),this)},forEach:function(a,b){c(this,a,b);return this},filter:function(a){var c=arguments,b=this,d=0;if("string"==typeof a){b=u._filterResult(this,c[0]);if(1==c.length)return b._stash(this);
d=1}return this._wrap(m.filter(b,c[d],c[d+1]),this)},instantiate:function(a,c){var b=n.isFunction(a)?a:n.getObject(a);c=c||{};return this.forEach(function(a){new b(c,a)})},at:function(){var a=new this._NodeListCtor(0);c(arguments,function(c){0>c&&(c=this.length+c);this[c]&&a.push(this[c])},this);return a._stash(this)}});var u=g(k,r);b.query=g(k,function(a){return r(a)});u.load=function(a,c,b){q.load(a,c,function(a){b(g(a,r))})};b._filterQueryResult=u._filterResult=function(a,c,b){return new r(u.filter(a,
c,b))};b.NodeList=u.NodeList=r;return u})},"dojo/has":function(){define(["require","module"],function(b,l){var e=b.has||function(){};if(!e("dojo-has-api")){var p="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location==location&&window.document==document,m=function(){return this}(),n=p&&document,q=n&&n.createElement("DiV"),k=l.config&&l.config()||{},e=function(b){return"function"==typeof k[b]?k[b]=k[b](m,n,q):k[b]};e.cache=k;e.add=function(b,a,f,d){("undefined"==
typeof k[b]||d)&&(k[b]=a);return f&&e(b)}}e.add("dom-addeventlistener",!!document.addEventListener);e.add("touch","ontouchstart"in document||"onpointerdown"in document&&0<navigator.maxTouchPoints||window.navigator.msMaxTouchPoints);e.add("touch-events","ontouchstart"in document);e.add("pointer-events","onpointerdown"in document);e.add("MSPointer","msMaxTouchPoints"in navigator);e.add("device-width",screen.availWidth||innerWidth);p=document.createElement("form");e.add("dom-attributes-explicit",0==
p.attributes.length);e.add("dom-attributes-specified-flag",0<p.attributes.length&&40>p.attributes.length);e.clearElement=function(b){b.innerHTML="";return b};e.normalize=function(b,a){var f=b.match(/[\?:]|[^:\?]*/g),d=0,c=function(a){var b=f[d++];if(":"==b)return 0;if("?"==f[d++]){if(!a&&e(b))return c();c(!0);return c(a)}return b||0};return(b=c())&&a(b)};e.load=function(b,a,f){b?a([b],f):f()};return e})},"dojo/_base/loader":function(){define("./kernel ../has require module ../json ./lang ./array".split(" "),
function(b,l,e,p,m,n,q){var k=function(a){return a.replace(/\./g,"/")},g=/\/\/>>built/,a=[],f=[],d=function(b,d,h){a.push(h);q.forEach(b.split(","),function(a){a=K(a,d.module);f.push(a);S(a)});c()},c=function(){var c,b;for(b in O)if(c=O[b],void 0===c.noReqPluginCheck&&(c.noReqPluginCheck=/loadInit\!/.test(b)||/require\!/.test(b)?1:0),!c.executed&&!c.noReqPluginCheck&&c.injected==A)return;N(function(){var c=a;a=[];q.forEach(c,function(a){a(1)})})},h=function(a,c,d){var f=/\(|\)/g,h=1;for(f.lastIndex=
c;(c=f.exec(a))&&!(h=")"==c[0]?h-1:h+1,0==h););if(0!=h)throw"unmatched paren around character "+f.lastIndex+" in: "+a;return[b.trim(a.substring(d,f.lastIndex))+";\n",f.lastIndex]},r=/(\/\*([\s\S]*?)\*\/|\/\/(.*)$)/mg,t=/(^|\s)dojo\.(loadInit|require|provide|requireLocalization|requireIf|requireAfterIf|platformRequire)\s*\(/mg,v=/(^|\s)(require|define)\s*\(/m,u=function(a,c){var b,d,f,g=[],e=[];b=[];for(c=c||a.replace(r,function(a){t.lastIndex=v.lastIndex=0;return t.test(a)||v.test(a)?"":a});b=t.exec(c);)d=
t.lastIndex,f=d-b[0].length,d=h(c,d,f),"loadInit"==b[2]?g.push(d[0]):e.push(d[0]),t.lastIndex=d[1];b=g.concat(e);return b.length||!v.test(c)?[a.replace(/(^|\s)dojo\.loadInit\s*\(/g,"\n0 \x26\x26 dojo.loadInit("),b.join(""),b]:0},s=e.initSyncLoader(d,c,function(a,c){var b,d,f=[],h=[];if(g.test(c)||!(b=u(c)))return 0;d=a.mid+"-*loadInit";for(var e in K("dojo",a).result.scopeMap)f.push(e),h.push('"'+e+'"');return"// xdomain rewrite of "+a.mid+"\ndefine('"+d+"',{\n\tnames:"+m.stringify(f)+",\n\tdef:function("+
f.join(",")+"){"+b[1]+"}});\n\ndefine("+m.stringify(f.concat(["dojo/loadInit!"+d]))+", function("+f.join(",")+"){\n"+b[0]+"});"}),y=s.sync,A=s.requested,w=s.arrived,F=s.nonmodule,x=s.executing,C=s.executed,I=s.syncExecStack,O=s.modules,P=s.execQ,K=s.getModule,S=s.injectModule,B=s.setArrived,G=s.signal,M=s.finishExec,E=s.execModule,D=s.getLegacyMode,N=s.guardCheckComplete,d=s.dojoRequirePlugin;b.provide=function(a){var c=I[0],b=n.mixin(K(k(a),e.module),{executed:x,result:n.getObject(a,!0)});B(b);c&&
(c.provides||(c.provides=[])).push(function(){b.result=n.getObject(a);delete b.provides;b.executed!==C&&M(b)});return b.result};l.add("config-publishRequireResult",1,0,0);b.require=function(a,c){var b=function(a,c){var b=K(k(a),e.module);if(I.length&&I[0].finish)I[0].finish.push(a);else{if(b.executed)return b.result;c&&(b.result=F);var d=D();S(b);d=D();b.executed!==C&&b.injected===w&&s.guardCheckComplete(function(){E(b)});if(b.executed)return b.result;d==y?b.cjs?P.unshift(b):I.length&&(I[0].finish=
[a]):P.push(b)}}(a,c);l("config-publishRequireResult")&&(!n.exists(a)&&void 0!==b)&&n.setObject(a,b);return b};b.loadInit=function(a){a()};b.registerModulePath=function(a,c){var b={};b[a.replace(/\./g,"/")]=c;e({paths:b})};b.platformRequire=function(a){a=(a.common||[]).concat(a[b._name]||a["default"]||[]);for(var c;a.length;)n.isArray(c=a.shift())?b.require.apply(b,c):b.require(c)};b.requireIf=b.requireAfterIf=function(a,c,d){a&&b.require(c,d)};b.requireLocalization=function(a,c,b){e(["../i18n"],
function(d){d.getLocalization(a,c,b)})};return{extractLegacyApiApplications:u,require:d,loadInit:function(a,c,f){c([a],function(a){c(a.names,function(){for(var h="",g=[],e=0;e<arguments.length;e++)h+="var "+a.names[e]+"\x3d arguments["+e+"]; ",g.push(arguments[e]);eval(h);var r=c.module,n=[],m,h={provide:function(a){a=k(a);a=K(a,r);a!==r&&B(a)},require:function(a,c){a=k(a);c&&(K(a,r).result=F);n.push(a)},requireLocalization:function(a,c,d){m||(m=["dojo/i18n"]);d=(d||b.locale).toLowerCase();a=k(a)+
"/nls/"+(/root/i.test(d)?"":d+"/")+k(c);K(a,r).isXd&&m.push("dojo/i18n!"+a)},loadInit:function(a){a()}},e={},t;try{for(t in h)e[t]=b[t],b[t]=h[t];a.def.apply(null,g)}catch(q){G("error",[{src:p.id,id:"failedDojoLoadInit"},q])}finally{for(t in h)b[t]=e[t]}m&&(n=n.concat(m));n.length?d(n.join(","),c,f):f()})})}}})},"dojo/json":function(){define(["./has"],function(b){var l="undefined"!=typeof JSON;b.add("json-parse",l);b.add("json-stringify",l&&'{"a":1}'==JSON.stringify({a:0},function(b,e){return e||
1}));if(b("json-stringify"))return JSON;var e=function(b){return('"'+b.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")};return{parse:b("json-parse")?JSON.parse:function(b,e){if(e&&!/^([\s\[\{]*(?:"(?:\\.|[^"])*"|-?\d[\d\.]*(?:[Ee][+-]?\d+)?|null|true|false|)[\s\]\}]*(?:,|:|$))+$/.test(b))throw new SyntaxError("Invalid characters in JSON");return eval("("+b+")")},stringify:function(b,m,n){function q(b,
a,f){m&&(b=m(f,b));var d;d=typeof b;if("number"==d)return isFinite(b)?b+"":"null";if("boolean"==d)return b+"";if(null===b)return"null";if("string"==typeof b)return e(b);if("function"==d||"undefined"==d)return k;if("function"==typeof b.toJSON)return q(b.toJSON(f),a,f);if(b instanceof Date)return'"{FullYear}-{Month+}-{Date}T{Hours}:{Minutes}:{Seconds}Z"'.replace(/\{(\w+)(\+)?\}/g,function(a,c,d){a=b["getUTC"+c]()+(d?1:0);return 10>a?"0"+a:a});if(b.valueOf()!==b)return q(b.valueOf(),a,f);var c=n?a+n:
"",h=n?" ":"",r=n?"\n":"";if(b instanceof Array){var h=b.length,t=[];for(f=0;f<h;f++)d=q(b[f],c,f),"string"!=typeof d&&(d="null"),t.push(r+c+d);return"["+t.join(",")+r+a+"]"}t=[];for(f in b){var l;if(b.hasOwnProperty(f)){if("number"==typeof f)l='"'+f+'"';else if("string"==typeof f)l=e(f);else continue;d=q(b[f],c,f);"string"==typeof d&&t.push(r+c+l+":"+h+d)}}return"{"+t.join(",")+r+a+"}"}var k;"string"==typeof m&&(n=m,m=null);return q(b,"","")}}})},"dojo/_base/declare":function(){define(["./kernel",
"../has","./lang"],function(b,l,e){function p(a,c){throw Error("declare"+(c?" "+c:"")+": "+a);}function m(a,c,b){var d,f,h,e,r,g,k,n=this._inherited=this._inherited||{};"string"==typeof a&&(d=a,a=c,c=b);b=0;e=a.callee;(d=d||e.nom)||p("can't deduce a name to call inherited()",this.declaredClass);r=this.constructor._meta;h=r.bases;k=n.p;if(d!=x){if(n.c!==e&&(k=0,g=h[0],r=g._meta,r.hidden[d]!==e)){(f=r.chains)&&"string"==typeof f[d]&&p("calling chained method with inherited: "+d,this.declaredClass);
do if(r=g._meta,f=g.prototype,r&&(f[d]===e&&f.hasOwnProperty(d)||r.hidden[d]===e))break;while(g=h[++k]);k=g?k:-1}if(g=h[++k])if(f=g.prototype,g._meta&&f.hasOwnProperty(d))b=f[d];else{e=y[d];do if(f=g.prototype,(b=f[d])&&(g._meta?f.hasOwnProperty(d):b!==e))break;while(g=h[++k])}b=g&&b||y[d]}else{if(n.c!==e&&(k=0,(r=h[0]._meta)&&r.ctor!==e)){f=r.chains;for((!f||"manual"!==f.constructor)&&p("calling chained constructor with inherited",this.declaredClass);(g=h[++k])&&!((r=g._meta)&&r.ctor===e););k=g?
k:-1}for(;(g=h[++k])&&!(b=(r=g._meta)?r.ctor:g););b=g&&b}n.c=b;n.p=k;if(b)return!0===c?b:b.apply(this,c||a)}function n(a,c){return"string"==typeof a?this.__inherited(a,c,!0):this.__inherited(a,!0)}function q(a,c,b){var d=this.getInherited(a,c);if(d)return d.apply(this,b||c||a)}function k(a){for(var c=this.constructor._meta.bases,b=0,d=c.length;b<d;++b)if(c[b]===a)return!0;return this instanceof a}function g(a,c){for(var b in c)b!=x&&c.hasOwnProperty(b)&&(a[b]=c[b]);if(l("bug-for-in-skips-shadowed"))for(var d=
e._extraNames,f=d.length;f;)b=d[--f],b!=x&&c.hasOwnProperty(b)&&(a[b]=c[b])}function a(a){u.safeMixin(this.prototype,a);return this}function f(a,c){a instanceof Array||"function"==typeof a||(c=a,a=void 0);c=c||{};a=a||[];return u([this].concat(a),c)}function d(a,c){return function(){var b=arguments,d=b,f=b[0],h,e;e=a.length;var g;if(!(this instanceof b.callee))return v(b);if(c&&(f&&f.preamble||this.preamble)){g=Array(a.length);g[0]=b;for(h=0;;){if(f=b[0])(f=f.preamble)&&(b=f.apply(this,b)||b);f=a[h].prototype;
(f=f.hasOwnProperty("preamble")&&f.preamble)&&(b=f.apply(this,b)||b);if(++h==e)break;g[h]=b}}for(h=e-1;0<=h;--h)f=a[h],(f=(e=f._meta)?e.ctor:f)&&f.apply(this,g?g[h]:b);(f=this.postscript)&&f.apply(this,d)}}function c(a,c){return function(){var b=arguments,d=b,f=b[0];if(!(this instanceof b.callee))return v(b);c&&(f&&(f=f.preamble)&&(d=f.apply(this,d)||d),(f=this.preamble)&&f.apply(this,d));a&&a.apply(this,b);(f=this.postscript)&&f.apply(this,b)}}function h(a){return function(){var c=arguments,b=0,
d,f;if(!(this instanceof c.callee))return v(c);for(;d=a[b];++b)if(d=(f=d._meta)?f.ctor:d){d.apply(this,c);break}(d=this.postscript)&&d.apply(this,c)}}function r(a,c,b){return function(){var d,f,h=0,e=1;b&&(h=c.length-1,e=-1);for(;d=c[h];h+=e)f=d._meta,(d=(f?f.hidden:d.prototype)[a])&&d.apply(this,arguments)}}function t(a){w.prototype=a.prototype;a=new w;w.prototype=null;return a}function v(a){var c=a.callee,b=t(c);c.apply(b,a);return b}function u(b,q,l){"string"!=typeof b&&(l=q,q=b,b="");l=l||{};
var v,w,B,G,M,E,D,N=1,da=q;if("[object Array]"==A.call(q)){N=b;B=[];G=[{cls:0,refs:[]}];E={};for(var Y=1,$=q.length,L=0,J,T,z,H;L<$;++L){(J=q[L])?"[object Function]"!=A.call(J)&&p("mixin #"+L+" is not a callable constructor.",N):p("mixin #"+L+" is unknown. Did you use dojo.require to pull it in?",N);T=J._meta?J._meta.bases:[J];z=0;for(J=T.length-1;0<=J;--J)H=T[J].prototype,H.hasOwnProperty("declaredClass")||(H.declaredClass="uniqName_"+F++),H=H.declaredClass,E.hasOwnProperty(H)||(E[H]={count:0,refs:[],
cls:T[J]},++Y),H=E[H],z&&z!==H&&(H.refs.push(z),++z.count),z=H;++z.count;G[0].refs.push(z)}for(;G.length;){z=G.pop();B.push(z.cls);for(--Y;w=z.refs,1==w.length;){z=w[0];if(!z||--z.count){z=0;break}B.push(z.cls);--Y}if(z){L=0;for($=w.length;L<$;++L)z=w[L],--z.count||G.push(z)}}Y&&p("can't build consistent linearization",N);J=q[0];B[0]=J?J._meta&&J===B[B.length-J._meta.bases.length]?J._meta.bases.length:1:0;E=B;B=E[0];N=E.length-B;q=E[N]}else E=[0],q?"[object Function]"==A.call(q)?(B=q._meta,E=E.concat(B?
B.bases:q)):p("base class is not a callable constructor.",b):null!==q&&p("unknown base class. Did you use dojo.require to pull it in?",b);if(q)for(w=N-1;;--w){v=t(q);if(!w)break;B=E[w];(B._meta?g:s)(v,B.prototype);G=new Function;G.superclass=q;G.prototype=v;q=v.constructor=G}else v={};u.safeMixin(v,l);B=l.constructor;B!==y.constructor&&(B.nom=x,v.constructor=B);for(w=N-1;w;--w)(B=E[w]._meta)&&B.chains&&(D=s(D||{},B.chains));v["-chains-"]&&(D=s(D||{},v["-chains-"]));B=!D||!D.hasOwnProperty(x);E[0]=
G=D&&"manual"===D.constructor?h(E):1==E.length?c(l.constructor,B):d(E,B);G._meta={bases:E,hidden:l,chains:D,parents:da,ctor:l.constructor};G.superclass=q&&q.prototype;G.extend=a;G.createSubclass=f;G.prototype=v;v.constructor=G;v.getInherited=n;v.isInstanceOf=k;v.inherited=C;v.__inherited=m;b&&(v.declaredClass=b,e.setObject(b,G));if(D)for(M in D)v[M]&&("string"==typeof D[M]&&M!=x)&&(B=v[M]=r(M,E,"after"===D[M]),B.nom=M);return G}var s=e.mixin,y=Object.prototype,A=y.toString,w=new Function,F=0,x="constructor",
C=b.config.isDebug?q:m;b.safeMixin=u.safeMixin=function(a,c){var b,d;for(b in c)if(d=c[b],(d!==y[b]||!(b in y))&&b!=x)"[object Function]"==A.call(d)&&(d.nom=b),a[b]=d;if(l("bug-for-in-skips-shadowed"))for(var f=e._extraNames,h=f.length;h;)if(b=f[--h],d=c[b],(d!==y[b]||!(b in y))&&b!=x)"[object Function]"==A.call(d)&&(d.nom=b),a[b]=d;return a};return b.declare=u})},"dojo/dom":function(){define(["./sniff","./_base/window"],function(b,l){if(7>=b("ie"))try{document.execCommand("BackgroundImageCache",
!1,!0)}catch(e){}var p={};b("ie")?p.byId=function(b,e){if("string"!=typeof b)return b;var k=e||l.doc,g=b&&k.getElementById(b);if(g&&(g.attributes.id.value==b||g.id==b))return g;k=k.all[b];if(!k||k.nodeName)k=[k];for(var a=0;g=k[a++];)if(g.attributes&&g.attributes.id&&g.attributes.id.value==b||g.id==b)return g}:p.byId=function(b,e){return("string"==typeof b?(e||l.doc).getElementById(b):b)||null};p.isDescendant=function(b,e){try{b=p.byId(b);for(e=p.byId(e);b;){if(b==e)return!0;b=b.parentNode}}catch(k){}return!1};
b.add("css-user-select",function(b,e,k){if(!k)return!1;b=k.style;e=["Khtml","O","Moz","Webkit"];k=e.length;var g="userSelect";do if("undefined"!==typeof b[g])return g;while(k--&&(g=e[k]+"UserSelect"));return!1});var m=b("css-user-select");p.setSelectable=m?function(b,e){p.byId(b).style[m]=e?"":"none"}:function(b,e){b=p.byId(b);var k=b.getElementsByTagName("*"),g=k.length;if(e)for(b.removeAttribute("unselectable");g--;)k[g].removeAttribute("unselectable");else for(b.setAttribute("unselectable","on");g--;)k[g].setAttribute("unselectable",
"on")};return p})},"dojo/_base/browser":function(){require.has&&require.has.add("config-selectorEngine","acme");define("../ready ./kernel ./connect ./unload ./window ./event ./html ./NodeList ../query ./xhr ./fx".split(" "),function(b){return b})},"dojo/selector/acme":function(){define(["../dom","../sniff","../_base/array","../_base/lang","../_base/window"],function(b,l,e,p,m){var n=p.trim,q=e.forEach,k="BackCompat"==m.doc.compatMode,g=!1,a=function(){return!0},f=function(a){a=0<="\x3e~+".indexOf(a.slice(-1))?
a+" * ":a+" ";for(var c=function(c,b){return n(a.slice(c,b))},b=[],d=-1,f=-1,h=-1,e=-1,r=-1,k=-1,m=-1,t,q="",l="",p,u=0,x=a.length,s=null,v=null,y=function(){0<=k&&(s.id=c(k,u).replace(/\\/g,""),k=-1);if(0<=m){var a=m==u?null:c(m,u);s[0>"\x3e~+".indexOf(a)?"tag":"oper"]=a;m=-1}0<=r&&(s.classes.push(c(r+1,u).replace(/\\/g,"")),r=-1)};q=l,l=a.charAt(u),u<x;u++)if("\\"!=q)if(s||(p=u,s={query:null,pseudos:[],attrs:[],classes:[],tag:null,oper:null,id:null,getTag:function(){return g?this.otag:this.tag}},
m=u),t)l==t&&(t=null);else if("'"==l||'"'==l)t=l;else if(0<=d)if("]"==l){v.attr?v.matchFor=c(h||d+1,u):v.attr=c(d+1,u);if((d=v.matchFor)&&('"'==d.charAt(0)||"'"==d.charAt(0)))v.matchFor=d.slice(1,-1);v.matchFor&&(v.matchFor=v.matchFor.replace(/\\/g,""));s.attrs.push(v);v=null;d=h=-1}else"\x3d"==l&&(h=0<="|~^$*".indexOf(q)?q:"",v.type=h+l,v.attr=c(d+1,u-h.length),h=u+1);else 0<=f?")"==l&&(0<=e&&(v.value=c(f+1,u)),e=f=-1):"#"==l?(y(),k=u+1):"."==l?(y(),r=u):":"==l?(y(),e=u):"["==l?(y(),d=u,v={}):"("==
l?(0<=e&&(v={name:c(e+1,u),value:null},s.pseudos.push(v)),f=u):" "==l&&q!=l&&(y(),0<=e&&s.pseudos.push({name:c(e+1,u)}),s.loops=s.pseudos.length||s.attrs.length||s.classes.length,s.oquery=s.query=c(p,u),s.otag=s.tag=s.oper?null:s.tag||"*",s.tag&&(s.tag=s.tag.toUpperCase()),b.length&&b[b.length-1].oper&&(s.infixOper=b.pop(),s.query=s.infixOper.query+" "+s.query),b.push(s),s=null);return b},d=function(a,c){return!a?c:!c?a:function(){return a.apply(window,arguments)&&c.apply(window,arguments)}},c=function(a,
c){var b=c||[];a&&b.push(a);return b},h=function(a){return 1==a.nodeType},r=function(a,c){return!a?"":"class"==c?a.className||"":"for"==c?a.htmlFor||"":"style"==c?a.style.cssText||"":(g?a.getAttribute(c):a.getAttribute(c,2))||""},t={"*\x3d":function(a,c){return function(b){return 0<=r(b,a).indexOf(c)}},"^\x3d":function(a,c){return function(b){return 0==r(b,a).indexOf(c)}},"$\x3d":function(a,c){return function(b){b=" "+r(b,a);var d=b.lastIndexOf(c);return-1<d&&d==b.length-c.length}},"~\x3d":function(a,
c){var b=" "+c+" ";return function(c){return 0<=(" "+r(c,a)+" ").indexOf(b)}},"|\x3d":function(a,c){var b=c+"-";return function(d){d=r(d,a);return d==c||0==d.indexOf(b)}},"\x3d":function(a,c){return function(b){return r(b,a)==c}}},v="undefined"==typeof m.doc.firstChild.nextElementSibling,u=!v?"nextElementSibling":"nextSibling",s=!v?"previousElementSibling":"previousSibling",y=v?h:a,A=function(a){for(;a=a[s];)if(y(a))return!1;return!0},w=function(a){for(;a=a[u];)if(y(a))return!1;return!0},F=function(a){var c=
a.parentNode,c=7!=c.nodeType?c:c.nextSibling,b=0,d=c.children||c.childNodes,f=a._i||a.getAttribute("_i")||-1,h=c._l||("undefined"!==typeof c.getAttribute?c.getAttribute("_l"):-1);if(!d)return-1;d=d.length;if(h==d&&0<=f&&0<=h)return f;l("ie")&&"undefined"!==typeof c.setAttribute?c.setAttribute("_l",d):c._l=d;f=-1;for(c=c.firstElementChild||c.firstChild;c;c=c[u])y(c)&&(l("ie")?c.setAttribute("_i",++b):c._i=++b,a===c&&(f=b));return f},x=function(a){return!(F(a)%2)},C=function(a){return F(a)%2},I={checked:function(a,
c){return function(a){return!!("checked"in a?a.checked:a.selected)}},disabled:function(a,c){return function(a){return a.disabled}},enabled:function(a,c){return function(a){return!a.disabled}},"first-child":function(){return A},"last-child":function(){return w},"only-child":function(a,c){return function(a){return A(a)&&w(a)}},empty:function(a,c){return function(a){var c=a.childNodes;for(a=a.childNodes.length-1;0<=a;a--){var b=c[a].nodeType;if(1===b||3==b)return!1}return!0}},contains:function(a,c){var b=
c.charAt(0);if('"'==b||"'"==b)c=c.slice(1,-1);return function(a){return 0<=a.innerHTML.indexOf(c)}},not:function(a,c){var b=f(c)[0],d={el:1};"*"!=b.tag&&(d.tag=1);b.classes.length||(d.classes=1);var h=P(b,d);return function(a){return!h(a)}},"nth-child":function(a,c){var b=parseInt;if("odd"==c)return C;if("even"==c)return x;if(-1!=c.indexOf("n")){var d=c.split("n",2),f=d[0]?"-"==d[0]?-1:b(d[0]):1,h=d[1]?b(d[1]):0,e=0,g=-1;0<f?0>h?h=h%f&&f+h%f:0<h&&(h>=f&&(e=h-h%f),h%=f):0>f&&(f*=-1,0<h&&(g=h,h%=f));
if(0<f)return function(a){a=F(a);return a>=e&&(0>g||a<=g)&&a%f==h};c=h}var r=b(c);return function(a){return F(a)==r}}},O=9>l("ie")||9==l("ie")&&l("quirks")?function(a){var c=a.toLowerCase();"class"==c&&(a="className");return function(b){return g?b.getAttribute(a):b[a]||b[c]}}:function(a){return function(c){return c&&c.getAttribute&&c.hasAttribute(a)}},P=function(c,b){if(!c)return a;b=b||{};var f=null;"el"in b||(f=d(f,h));"tag"in b||"*"!=c.tag&&(f=d(f,function(a){return a&&(g?a.tagName:a.tagName.toUpperCase())==
c.getTag()}));"classes"in b||q(c.classes,function(a,c,b){var h=RegExp("(?:^|\\s)"+a+"(?:\\s|$)");f=d(f,function(a){return h.test(a.className)});f.count=c});"pseudos"in b||q(c.pseudos,function(a){var c=a.name;I[c]&&(f=d(f,I[c](c,a.value)))});"attrs"in b||q(c.attrs,function(a){var c,b=a.attr;a.type&&t[a.type]?c=t[a.type](b,a.matchFor):b.length&&(c=O(b));c&&(f=d(f,c))});"id"in b||c.id&&(f=d(f,function(a){return!!a&&a.id==c.id}));f||"default"in b||(f=a);return f},K=function(a){return function(c,b,d){for(;c=
c[u];)if(!v||h(c)){(!d||U(c,d))&&a(c)&&b.push(c);break}return b}},S=function(a){return function(c,b,d){for(c=c[u];c;){if(y(c)){if(d&&!U(c,d))break;a(c)&&b.push(c)}c=c[u]}return b}},B=function(c){c=c||a;return function(a,b,d){for(var f=0,h=a.children||a.childNodes;a=h[f++];)y(a)&&((!d||U(a,d))&&c(a,f))&&b.push(a);return b}},G={},M=function(d){var f=G[d.query];if(f)return f;var h=d.infixOper,h=h?h.oper:"",e=P(d,{el:1}),g="*"==d.tag,r=m.doc.getElementsByClassName;if(h)r={el:1},g&&(r.tag=1),e=P(d,r),
"+"==h?f=K(e):"~"==h?f=S(e):"\x3e"==h&&(f=B(e));else if(d.id)e=!d.loops&&g?a:P(d,{el:1,id:1}),f=function(a,f){var h=b.byId(d.id,a.ownerDocument||a);if(h&&e(h)){if(9==a.nodeType)return c(h,f);for(var g=h.parentNode;g&&g!=a;)g=g.parentNode;if(g)return c(h,f)}};else if(r&&/\{\s*\[native code\]\s*\}/.test(String(r))&&d.classes.length&&!k)var e=P(d,{el:1,classes:1,id:1}),t=d.classes.join(" "),f=function(a,b,d){b=c(0,b);for(var f,h=0,g=a.getElementsByClassName(t);f=g[h++];)e(f,a)&&U(f,d)&&b.push(f);return b};
else!g&&!d.loops?f=function(a,b,f){b=c(0,b);for(var h=0,e=d.getTag(),e=e?a.getElementsByTagName(e):[];a=e[h++];)U(a,f)&&b.push(a);return b}:(e=P(d,{el:1,tag:1,id:1}),f=function(a,b,f){b=c(0,b);for(var h,g=0,r=(h=d.getTag())?a.getElementsByTagName(h):[];h=r[g++];)e(h,a)&&U(h,f)&&b.push(h);return b});return G[d.query]=f},E={},D={},N=function(a){var b=f(n(a));if(1==b.length){var d=M(b[0]);return function(a){if(a=d(a,[]))a.nozip=!0;return a}}return function(a){a=c(a);for(var d,f,h=b.length,e,g,r=0;r<
h;r++){g=[];d=b[r];f=a.length-1;0<f&&(e={},g.nozip=!0);f=M(d);for(var k=0;d=a[k];k++)f(d,g,e);if(!g.length)break;a=g}return g}},da=l("ie")?"commentStrip":"nozip",Y=!!m.doc.querySelectorAll,$=/\\[>~+]|n\+\d|([^ \\])?([>~+])([^ =])?/g,L=function(a,c,b,d){return b?(c?c+" ":"")+b+(d?" "+d:""):a},J=/([^[]*)([^\]]*])?/g,T=function(a,c,b){return c.replace($,L)+(b||"")},z=function(a,c){a=a.replace(J,T);if(Y){var b=D[a];if(b&&!c)return b}if(b=E[a])return b;var b=a.charAt(0),d=-1==a.indexOf(" ");0<=a.indexOf("#")&&
d&&(c=!0);if(Y&&!c&&-1=="\x3e~+".indexOf(b)&&(!l("ie")||-1==a.indexOf(":"))&&!(k&&0<=a.indexOf("."))&&-1==a.indexOf(":contains")&&-1==a.indexOf(":checked")&&-1==a.indexOf("|\x3d")){var f=0<="\x3e~+".indexOf(a.charAt(a.length-1))?a+" *":a;return D[a]=function(c){try{if(!(9==c.nodeType||d))throw"";var b=c.querySelectorAll(f);b[da]=!0;return b}catch(h){return z(a,!0)(c)}}}var h=a.match(/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g);return E[a]=2>h.length?N(a):function(a){for(var c=0,b=[],d;d=
h[c++];)b=b.concat(N(d)(a));return b}},H=0,W=l("ie")?function(a){return g?a.getAttribute("_uid")||a.setAttribute("_uid",++H)||H:a.uniqueID}:function(a){return a._uid||(a._uid=++H)},U=function(a,c){if(!c)return 1;var b=W(a);return!c[b]?c[b]=1:0},ea=function(a){if(a&&a.nozip)return a;if(!a||!a.length)return[];if(2>a.length)return[a[0]];var c=[];H++;var b,d;if(l("ie")&&g){var f=H+"";for(b=0;b<a.length;b++)if((d=a[b])&&d.getAttribute("_zipIdx")!=f)c.push(d),d.setAttribute("_zipIdx",f)}else if(l("ie")&&
a.commentStrip)try{for(b=0;b<a.length;b++)(d=a[b])&&h(d)&&c.push(d)}catch(e){}else for(b=0;b<a.length;b++)if((d=a[b])&&d._zipIdx!=H)c.push(d),d._zipIdx=H;return c},X=function(a,c){c=c||m.doc;g="div"===(c.ownerDocument||c).createElement("div").tagName;var b=z(a)(c);return b&&b.nozip?b:ea(b)};X.filter=function(a,c,d){for(var h=[],g=f(c),g=1==g.length&&!/[^\w#\.]/.test(c)?P(g[0]):function(a){return-1!=e.indexOf(X(c,b.byId(d)),a)},r=0,k;k=a[r];r++)g(k)&&h.push(k);return h};return X})},"dojo/errors/RequestTimeoutError":function(){define(["./create",
"./RequestError"],function(b,l){return b("RequestTimeoutError",null,l,{dojoType:"timeout"})})},"dojo/dom-style":function(){define(["./sniff","./dom"],function(b,l){function e(c,d,e){d=d.toLowerCase();if(b("ie")||b("trident")){if("auto"==e){if("height"==d)return c.offsetHeight;if("width"==d)return c.offsetWidth}if("fontweight"==d)switch(e){case 700:return"bold";default:return"normal"}}d in a||(a[d]=f.test(d));return a[d]?n(c,e):e}var p,m={};p=b("webkit")?function(a){var b;if(1==a.nodeType){var d=a.ownerDocument.defaultView;
b=d.getComputedStyle(a,null);!b&&a.style&&(a.style.display="",b=d.getComputedStyle(a,null))}return b||{}}:b("ie")&&(9>b("ie")||b("quirks"))?function(a){return 1==a.nodeType&&a.currentStyle?a.currentStyle:{}}:function(a){return 1==a.nodeType?a.ownerDocument.defaultView.getComputedStyle(a,null):{}};m.getComputedStyle=p;var n;n=b("ie")?function(a,b){if(!b)return 0;if("medium"==b)return 4;if(b.slice&&"px"==b.slice(-2))return parseFloat(b);var d=a.style,f=a.runtimeStyle,e=d.left,g=f.left;f.left=a.currentStyle.left;
try{d.left=b,b=d.pixelLeft}catch(k){b=0}d.left=e;f.left=g;return b}:function(a,b){return parseFloat(b)||0};m.toPixelValue=n;var q=function(a,b){try{return a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(d){return b?{}:null}},k=9>b("ie")||10>b("ie")&&b("quirks")?function(a){try{return q(a).Opacity/100}catch(b){return 1}}:function(a){return p(a).opacity},g=9>b("ie")||10>b("ie")&&b("quirks")?function(a,b){""===b&&(b=1);var d=100*b;1===b?(a.style.zoom="",q(a)&&(a.style.filter=a.style.filter.replace(/\s*progid:DXImageTransform.Microsoft.Alpha\([^\)]+?\)/i,
""))):(a.style.zoom=1,q(a)?q(a,1).Opacity=d:a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity\x3d"+d+")",q(a,1).Enabled=!0);if("tr"==a.tagName.toLowerCase())for(d=a.firstChild;d;d=d.nextSibling)"td"==d.tagName.toLowerCase()&&g(d,b);return b}:function(a,b){return a.style.opacity=b},a={left:!0,top:!0},f=/margin|padding|width|height|max|min|offset/,d={cssFloat:1,styleFloat:1,"float":1};m.get=function(a,b){var f=l.byId(a),g=arguments.length;if(2==g&&"opacity"==b)return k(f);b=d[b]?"cssFloat"in
f.style?"cssFloat":"styleFloat":b;var n=m.getComputedStyle(f);return 1==g?n:e(f,b,n[b]||f.style[b])};m.set=function(a,b,f){var e=l.byId(a),k=arguments.length,n="opacity"==b;b=d[b]?"cssFloat"in e.style?"cssFloat":"styleFloat":b;if(3==k)return n?g(e,f):e.style[b]=f;for(var q in b)m.set(a,q,b[q]);return m.getComputedStyle(e)};return m})},"dojo/dom-geometry":function(){define(["./sniff","./_base/window","./dom","./dom-style"],function(b,l,e,p){function m(a,b,d,c,h,e){e=e||"px";a=a.style;isNaN(b)||(a.left=
b+e);isNaN(d)||(a.top=d+e);0<=c&&(a.width=c+e);0<=h&&(a.height=h+e)}function n(a){return"button"==a.tagName.toLowerCase()||"input"==a.tagName.toLowerCase()&&"button"==(a.getAttribute("type")||"").toLowerCase()}function q(a){return"border-box"==k.boxModel||"table"==a.tagName.toLowerCase()||n(a)}var k={boxModel:"content-box"};b("ie")&&(k.boxModel="BackCompat"==document.compatMode?"border-box":"content-box");k.getPadExtents=function(a,b){a=e.byId(a);var d=b||p.getComputedStyle(a),c=p.toPixelValue,h=
c(a,d.paddingLeft),g=c(a,d.paddingTop),k=c(a,d.paddingRight),d=c(a,d.paddingBottom);return{l:h,t:g,r:k,b:d,w:h+k,h:g+d}};k.getBorderExtents=function(a,b){a=e.byId(a);var d=p.toPixelValue,c=b||p.getComputedStyle(a),h="none"!=c.borderLeftStyle?d(a,c.borderLeftWidth):0,g="none"!=c.borderTopStyle?d(a,c.borderTopWidth):0,k="none"!=c.borderRightStyle?d(a,c.borderRightWidth):0,d="none"!=c.borderBottomStyle?d(a,c.borderBottomWidth):0;return{l:h,t:g,r:k,b:d,w:h+k,h:g+d}};k.getPadBorderExtents=function(a,b){a=
e.byId(a);var d=b||p.getComputedStyle(a),c=k.getPadExtents(a,d),d=k.getBorderExtents(a,d);return{l:c.l+d.l,t:c.t+d.t,r:c.r+d.r,b:c.b+d.b,w:c.w+d.w,h:c.h+d.h}};k.getMarginExtents=function(a,b){a=e.byId(a);var d=b||p.getComputedStyle(a),c=p.toPixelValue,h=c(a,d.marginLeft),g=c(a,d.marginTop),k=c(a,d.marginRight),d=c(a,d.marginBottom);return{l:h,t:g,r:k,b:d,w:h+k,h:g+d}};k.getMarginBox=function(a,f){a=e.byId(a);var d=f||p.getComputedStyle(a),c=k.getMarginExtents(a,d),h=a.offsetLeft-c.l,g=a.offsetTop-
c.t,m=a.parentNode,n=p.toPixelValue;if(b("mozilla")){var l=parseFloat(d.left),d=parseFloat(d.top);!isNaN(l)&&!isNaN(d)?(h=l,g=d):m&&m.style&&(m=p.getComputedStyle(m),"visible"!=m.overflow&&(h+="none"!=m.borderLeftStyle?n(a,m.borderLeftWidth):0,g+="none"!=m.borderTopStyle?n(a,m.borderTopWidth):0))}else if((b("opera")||8==b("ie")&&!b("quirks"))&&m)m=p.getComputedStyle(m),h-="none"!=m.borderLeftStyle?n(a,m.borderLeftWidth):0,g-="none"!=m.borderTopStyle?n(a,m.borderTopWidth):0;return{l:h,t:g,w:a.offsetWidth+
c.w,h:a.offsetHeight+c.h}};k.getContentBox=function(a,f){a=e.byId(a);var d=f||p.getComputedStyle(a),c=a.clientWidth,h=k.getPadExtents(a,d),g=k.getBorderExtents(a,d);c?(d=a.clientHeight,g.w=g.h=0):(c=a.offsetWidth,d=a.offsetHeight);b("opera")&&(h.l+=g.l,h.t+=g.t);return{l:h.l,t:h.t,w:c-h.w-g.w,h:d-h.h-g.h}};k.setContentSize=function(a,b,d){a=e.byId(a);var c=b.w;b=b.h;q(a)&&(d=k.getPadBorderExtents(a,d),0<=c&&(c+=d.w),0<=b&&(b+=d.h));m(a,NaN,NaN,c,b)};var g={l:0,t:0,w:0,h:0};k.setMarginBox=function(a,
f,d){a=e.byId(a);var c=d||p.getComputedStyle(a);d=f.w;var h=f.h,r=q(a)?g:k.getPadBorderExtents(a,c),c=k.getMarginExtents(a,c);if(b("webkit")&&n(a)){var l=a.style;0<=d&&!l.width&&(l.width="4px");0<=h&&!l.height&&(l.height="4px")}0<=d&&(d=Math.max(d-r.w-c.w,0));0<=h&&(h=Math.max(h-r.h-c.h,0));m(a,f.l,f.t,d,h)};k.isBodyLtr=function(a){a=a||l.doc;return"ltr"==(l.body(a).dir||a.documentElement.dir||"ltr").toLowerCase()};k.docScroll=function(a){a=a||l.doc;var f=l.doc.parentWindow||l.doc.defaultView;return"pageXOffset"in
f?{x:f.pageXOffset,y:f.pageYOffset}:(f=b("quirks")?l.body(a):a.documentElement)&&{x:k.fixIeBiDiScrollLeft(f.scrollLeft||0,a),y:f.scrollTop||0}};b("ie")&&(k.getIeDocumentElementOffset=function(a){a=a||l.doc;a=a.documentElement;if(8>b("ie")){var f=a.getBoundingClientRect(),d=f.left,f=f.top;7>b("ie")&&(d+=a.clientLeft,f+=a.clientTop);return{x:0>d?0:d,y:0>f?0:f}}return{x:0,y:0}});k.fixIeBiDiScrollLeft=function(a,f){f=f||l.doc;var d=b("ie");if(d&&!k.isBodyLtr(f)){var c=b("quirks"),h=c?l.body(f):f.documentElement,
e=l.global;6==d&&(!c&&e.frameElement&&h.scrollHeight>h.clientHeight)&&(a+=h.clientLeft);return 8>d||c?a+h.clientWidth-h.scrollWidth:-a}return a};k.position=function(a,f){a=e.byId(a);var d=l.body(a.ownerDocument),c=a.getBoundingClientRect(),c={x:c.left,y:c.top,w:c.right-c.left,h:c.bottom-c.top};if(9>b("ie")){var h=k.getIeDocumentElementOffset(a.ownerDocument);c.x-=h.x+(b("quirks")?d.clientLeft+d.offsetLeft:0);c.y-=h.y+(b("quirks")?d.clientTop+d.offsetTop:0)}f&&(d=k.docScroll(a.ownerDocument),c.x+=
d.x,c.y+=d.y);return c};k.getMarginSize=function(a,b){a=e.byId(a);var d=k.getMarginExtents(a,b||p.getComputedStyle(a)),c=a.getBoundingClientRect();return{w:c.right-c.left+d.w,h:c.bottom-c.top+d.h}};k.normalizeEvent=function(a){"layerX"in a||(a.layerX=a.offsetX,a.layerY=a.offsetY);if(!b("dom-addeventlistener")){var f=a.target,f=f&&f.ownerDocument||document,d=b("quirks")?f.body:f.documentElement,c=k.getIeDocumentElementOffset(f);a.pageX=a.clientX+k.fixIeBiDiScrollLeft(d.scrollLeft||0,f)-c.x;a.pageY=
a.clientY+(d.scrollTop||0)-c.y}};return k})},"dojo/dom-prop":function(){define("exports ./_base/kernel ./sniff ./_base/lang ./dom ./dom-style ./dom-construct ./_base/connect".split(" "),function(b,l,e,p,m,n,q,k){function g(a){var b="";a=a.childNodes;for(var d=0,f;f=a[d];d++)8!=f.nodeType&&(b=1==f.nodeType?b+g(f):b+f.nodeValue);return b}var a={},f=0,d=l._scopeName+"attrid";e.add("dom-textContent",function(a,b,d){return"textContent"in d});b.names={"class":"className","for":"htmlFor",tabindex:"tabIndex",
readonly:"readOnly",colspan:"colSpan",frameborder:"frameBorder",rowspan:"rowSpan",textcontent:"textContent",valuetype:"valueType"};b.get=function(a,d){a=m.byId(a);var f=d.toLowerCase(),f=b.names[f]||d;return"textContent"==f&&!e("dom-textContent")?g(a):a[f]};b.set=function(c,h,g){c=m.byId(c);if(2==arguments.length&&"string"!=typeof h){for(var l in h)b.set(c,l,h[l]);return c}l=h.toLowerCase();l=b.names[l]||h;if("style"==l&&"string"!=typeof g)return n.set(c,g),c;if("innerHTML"==l)return e("ie")&&c.tagName.toLowerCase()in
{col:1,colgroup:1,table:1,tbody:1,tfoot:1,thead:1,tr:1,title:1}?(q.empty(c),c.appendChild(q.toDom(g,c.ownerDocument))):c[l]=g,c;if("textContent"==l&&!e("dom-textContent"))return q.empty(c),c.appendChild(c.ownerDocument.createTextNode(g)),c;if(p.isFunction(g)){var v=c[d];v||(v=f++,c[d]=v);a[v]||(a[v]={});var u=a[v][l];if(u)k.disconnect(u);else try{delete c[l]}catch(s){}g?a[v][l]=k.connect(c,l,g):c[l]=null;return c}c[l]=g;return c}})},"dojo/when":function(){define(["./Deferred","./promise/Promise"],
function(b,l){return function(e,p,m,n){var q=e&&"function"===typeof e.then,k=q&&e instanceof l;if(q)k||(q=new b(e.cancel),e.then(q.resolve,q.reject,q.progress),e=q.promise);else return 1<arguments.length?p?p(e):e:(new b).resolve(e);return p||m||n?e.then(p,m,n):e}})},"dojo/dom-attr":function(){define("exports ./sniff ./_base/lang ./dom ./dom-style ./dom-prop".split(" "),function(b,l,e,p,m,n){function q(a,b){var d=a.getAttributeNode&&a.getAttributeNode(b);return!!d&&d.specified}var k={innerHTML:1,textContent:1,
className:1,htmlFor:l("ie"),value:1},g={classname:"class",htmlfor:"for",tabindex:"tabIndex",readonly:"readOnly"};b.has=function(a,b){var d=b.toLowerCase();return k[n.names[d]||b]||q(p.byId(a),g[d]||b)};b.get=function(a,b){a=p.byId(a);var d=b.toLowerCase(),c=n.names[d]||b,h=a[c];if(k[c]&&"undefined"!=typeof h)return h;if("textContent"==c)return n.get(a,c);if("href"!=c&&("boolean"==typeof h||e.isFunction(h)))return h;d=g[d]||b;return q(a,d)?a.getAttribute(d):null};b.set=function(a,f,d){a=p.byId(a);
if(2==arguments.length){for(var c in f)b.set(a,c,f[c]);return a}c=f.toLowerCase();var h=n.names[c]||f,r=k[h];if("style"==h&&"string"!=typeof d)return m.set(a,d),a;if(r||"boolean"==typeof d||e.isFunction(d))return n.set(a,f,d);a.setAttribute(g[c]||f,d);return a};b.remove=function(a,b){p.byId(a).removeAttribute(g[b.toLowerCase()]||b)};b.getNodeProp=function(a,b){a=p.byId(a);var d=b.toLowerCase(),c=n.names[d]||b;if(c in a&&"href"!=c)return a[c];d=g[d]||b;return q(a,d)?a.getAttribute(d):null}})},"dojo/dom-construct":function(){define("exports ./_base/kernel ./sniff ./_base/window ./dom ./dom-attr".split(" "),
function(b,l,e,p,m,n){function q(a,b){var c=b.parentNode;c&&c.insertBefore(a,b)}function k(a){if("innerHTML"in a)try{a.innerHTML="";return}catch(b){}for(var c;c=a.lastChild;)a.removeChild(c)}var g={option:["select"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","thead","tr"],legend:["fieldset"],caption:["table"],colgroup:["table"],col:["table","colgroup"],li:["ul"]},a=/<\s*([\w\:]+)/,f={},d=0,c="__"+l._scopeName+"ToDomId",h;for(h in g)g.hasOwnProperty(h)&&
(l=g[h],l.pre="option"==h?'\x3cselect multiple\x3d"multiple"\x3e':"\x3c"+l.join("\x3e\x3c")+"\x3e",l.post="\x3c/"+l.reverse().join("\x3e\x3c/")+"\x3e");var r;8>=e("ie")&&(r=function(a){a.__dojo_html5_tested="yes";var b=t("div",{innerHTML:"\x3cnav\x3ea\x3c/nav\x3e",style:{visibility:"hidden"}},a.body);1!==b.childNodes.length&&"abbr article aside audio canvas details figcaption figure footer header hgroup mark meter nav output progress section summary time video".replace(/\b\w+\b/g,function(b){a.createElement(b)});
v(b)});b.toDom=function(b,h){h=h||p.doc;var k=h[c];k||(h[c]=k=++d+"",f[k]=h.createElement("div"));8>=e("ie")&&!h.__dojo_html5_tested&&h.body&&r(h);b+="";var m=b.match(a),l=m?m[1].toLowerCase():"",k=f[k];if(m&&g[l]){m=g[l];k.innerHTML=m.pre+b+m.post;for(m=m.length;m;--m)k=k.firstChild}else k.innerHTML=b;if(1==k.childNodes.length)return k.removeChild(k.firstChild);for(l=h.createDocumentFragment();m=k.firstChild;)l.appendChild(m);return l};b.place=function(a,c,d){c=m.byId(c);"string"==typeof a&&(a=/^\s*</.test(a)?
b.toDom(a,c.ownerDocument):m.byId(a));if("number"==typeof d){var f=c.childNodes;!f.length||f.length<=d?c.appendChild(a):q(a,f[0>d?0:d])}else switch(d){case "before":q(a,c);break;case "after":d=a;(f=c.parentNode)&&(f.lastChild==c?f.appendChild(d):f.insertBefore(d,c.nextSibling));break;case "replace":c.parentNode.replaceChild(a,c);break;case "only":b.empty(c);c.appendChild(a);break;case "first":if(c.firstChild){q(a,c.firstChild);break}default:c.appendChild(a)}return a};var t=b.create=function(a,c,d,
f){var h=p.doc;d&&(d=m.byId(d),h=d.ownerDocument);"string"==typeof a&&(a=h.createElement(a));c&&n.set(a,c);d&&b.place(a,d,f);return a};b.empty=function(a){k(m.byId(a))};var v=b.destroy=function(a){if(a=m.byId(a)){var b=a;a=a.parentNode;b.firstChild&&k(b);a&&(e("ie")&&a.canHaveChildren&&"removeNode"in b?b.removeNode(!1):a.removeChild(b))}}})},"dojo/request/xhr":function(){define(["../errors/RequestError","./watch","./handlers","./util","../has"],function(b,l,e,p,m){function n(a,c){var d=a.xhr;a.status=
a.xhr.status;try{a.text=d.responseText}catch(f){}"xml"===a.options.handleAs&&(a.data=d.responseXML);if(!c)try{e(a)}catch(h){c=h}c?this.reject(c):p.checkStatus(d.status)?this.resolve(a):(c=new b("Unable to load "+a.url+" status: "+d.status,a),this.reject(c))}function q(a){return this.xhr.getResponseHeader(a)}function k(e,t,v){var A=m("native-formdata")&&t&&t.data&&t.data instanceof FormData,w=p.parseArgs(e,p.deepCreate(r,t),A);e=w.url;t=w.options;var F,x=p.deferred(w,c,a,f,n,function(){F&&F()}),C=
w.xhr=k._create();if(!C)return x.cancel(new b("XHR was not created")),v?x:x.promise;w.getHeader=q;d&&(F=d(C,x,w));var I=t.data,O=!t.sync,P=t.method;try{C.open(P,e,O,t.user||h,t.password||h);t.withCredentials&&(C.withCredentials=t.withCredentials);m("native-response-type")&&t.handleAs in g&&(C.responseType=g[t.handleAs]);var K=t.headers;e=A?!1:"application/x-www-form-urlencoded";if(K)for(var S in K)"content-type"===S.toLowerCase()?e=K[S]:K[S]&&C.setRequestHeader(S,K[S]);e&&!1!==e&&C.setRequestHeader("Content-Type",
e);(!K||!("X-Requested-With"in K))&&C.setRequestHeader("X-Requested-With","XMLHttpRequest");p.notify&&p.notify.emit("send",w,x.promise.cancel);C.send(I)}catch(B){x.reject(B)}l(x);C=null;return v?x:x.promise}m.add("native-xhr",function(){return"undefined"!==typeof XMLHttpRequest});m.add("dojo-force-activex-xhr",function(){return m("activex")&&!document.addEventListener&&"file:"===window.location.protocol});m.add("native-xhr2",function(){if(m("native-xhr")){var a=new XMLHttpRequest;return"undefined"!==
typeof a.addEventListener&&("undefined"===typeof opera||"undefined"!==typeof a.upload)}});m.add("native-formdata",function(){return"undefined"!==typeof FormData});m.add("native-response-type",function(){return m("native-xhr")&&"undefined"!==typeof(new XMLHttpRequest).responseType});m.add("native-xhr2-blob",function(){if(m("native-response-type")){var a=new XMLHttpRequest;a.open("GET","/",!0);a.responseType="blob";var b=a.responseType;a.abort();return"blob"===b}});var g={blob:m("native-xhr2-blob")?
"blob":"arraybuffer",document:"document",arraybuffer:"arraybuffer"},a,f,d,c;m("native-xhr2")?(a=function(a){return!this.isFulfilled()},c=function(a,b){b.xhr.abort()},d=function(a,c,d){function f(a){c.handleResponse(d)}function h(a){a=new b("Unable to load "+d.url+" status: "+a.target.status,d);c.handleResponse(d,a)}function e(a){a.lengthComputable?(d.loaded=a.loaded,d.total=a.total,c.progress(d)):3===d.xhr.readyState&&(d.loaded="loaded"in a?a.loaded:a.position,c.progress(d))}a.addEventListener("load",
f,!1);a.addEventListener("error",h,!1);a.addEventListener("progress",e,!1);return function(){a.removeEventListener("load",f,!1);a.removeEventListener("error",h,!1);a.removeEventListener("progress",e,!1);a=null}}):(a=function(a){return a.xhr.readyState},f=function(a){return 4===a.xhr.readyState},c=function(a,b){var c=b.xhr,d=typeof c.abort;("function"===d||"object"===d||"unknown"===d)&&c.abort()});var h,r={data:null,query:null,sync:!1,method:"GET"};k._create=function(){throw Error("XMLHTTP not available");
};if(m("native-xhr")&&!m("dojo-force-activex-xhr"))k._create=function(){return new XMLHttpRequest};else if(m("activex"))try{new ActiveXObject("Msxml2.XMLHTTP"),k._create=function(){return new ActiveXObject("Msxml2.XMLHTTP")}}catch(t){try{new ActiveXObject("Microsoft.XMLHTTP"),k._create=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}catch(v){}}p.addCommonMethods(k);return k})},"dojo/text":function(){define(["./_base/kernel","require","./has","./request"],function(b,l,e,p){var m;m=function(a,
b,d){p(a,{sync:!!b,headers:{"X-Requested-With":null}}).then(d)};var n={},q=function(a){if(a){a=a.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var b=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);b&&(a=b[1])}else a="";return a},k={},g={};b.cache=function(a,b,d){var c;"string"==typeof a?/\//.test(a)?(c=a,d=b):c=l.toUrl(a.replace(/\./g,"/")+(b?"/"+b:"")):(c=a+"",d=b);a=void 0!=d&&"string"!=typeof d?d.value:d;d=d&&d.sanitize;if("string"==typeof a)return n[c]=a,d?q(a):a;if(null===
a)return delete n[c],null;c in n||m(c,!0,function(a){n[c]=a});return d?q(n[c]):n[c]};return{dynamic:!0,normalize:function(a,b){var d=a.split("!"),c=d[0];return(/^\./.test(c)?b(c):c)+(d[1]?"!"+d[1]:"")},load:function(a,b,d){a=a.split("!");var c=1<a.length,h=a[0],e=b.toUrl(a[0]);a="url:"+e;var l=k,p=function(a){d(c?q(a):a)};h in n?l=n[h]:b.cache&&a in b.cache?l=b.cache[a]:e in n&&(l=n[e]);if(l===k)if(g[e])g[e].push(p);else{var u=g[e]=[p];m(e,!b.async,function(a){n[h]=n[e]=a;for(var b=0;b<u.length;)u[b++](a);
delete g[e]})}else p(l)}}})},"dojo/keys":function(){define(["./_base/kernel","./sniff"],function(b,l){return b.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:l("webkit")?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,
NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145,UP_DPAD:175,DOWN_DPAD:176,LEFT_DPAD:177,RIGHT_DPAD:178,copyKey:l("mac")&&!l("air")?l("safari")?91:224:17}})},"dojo/domReady":function(){define(["./has"],function(b){function l(a){g.push(a);k&&e()}function e(){if(!a){for(a=!0;g.length;)try{g.shift()(m)}catch(b){console.error(b,
"in domReady callback",b.stack)}a=!1;l._onQEmpty()}}var p=function(){return this}(),m=document,n={loaded:1,complete:1},q="string"!=typeof m.readyState,k=!!n[m.readyState],g=[],a;l.load=function(a,b,c){l(c)};l._Q=g;l._onQEmpty=function(){};q&&(m.readyState="loading");if(!k){var f=[],d=function(a){a=a||p.event;k||"readystatechange"==a.type&&!n[m.readyState]||(q&&(m.readyState="complete"),k=1,e())},c=function(a,b){a.addEventListener(b,d,!1);g.push(function(){a.removeEventListener(b,d,!1)})};if(!b("dom-addeventlistener")){var c=
function(a,b){b="on"+b;a.attachEvent(b,d);g.push(function(){a.detachEvent(b,d)})},h=m.createElement("div");try{h.doScroll&&null===p.frameElement&&f.push(function(){try{return h.doScroll("left"),1}catch(a){}})}catch(r){}}c(m,"DOMContentLoaded");c(p,"load");"onreadystatechange"in m?c(m,"readystatechange"):q||f.push(function(){return n[m.readyState]});if(f.length){var t=function(){if(!k){for(var a=f.length;a--;)if(f[a]()){d("poller");return}setTimeout(t,30)}};t()}}return l})},"dojo/_base/lang":function(){define(["./kernel",
"../has","../sniff"],function(b,l){l.add("bug-for-in-skips-shadowed",function(){for(var a in{toString:1})return 0;return 1});var e=l("bug-for-in-skips-shadowed")?"hasOwnProperty valueOf isPrototypeOf propertyIsEnumerable toLocaleString toString constructor".split(" "):[],p=e.length,m=function(a,f,d){d||(d=a[0]&&b.scopeMap[a[0]]?b.scopeMap[a.shift()][1]:b.global);try{for(var c=0;c<a.length;c++){var h=a[c];if(!(h in d))if(f)d[h]={};else return;d=d[h]}return d}catch(e){}},n=Object.prototype.toString,
q=function(a,b,d){return(d||[]).concat(Array.prototype.slice.call(a,b||0))},k=/\{([^\}]+)\}/g,g={_extraNames:e,_mixin:function(a,b,d){var c,h,g,k={};for(c in b)if(h=b[c],!(c in a)||a[c]!==h&&(!(c in k)||k[c]!==h))a[c]=d?d(h):h;if(l("bug-for-in-skips-shadowed")&&b)for(g=0;g<p;++g)if(c=e[g],h=b[c],!(c in a)||a[c]!==h&&(!(c in k)||k[c]!==h))a[c]=d?d(h):h;return a},mixin:function(a,b){a||(a={});for(var d=1,c=arguments.length;d<c;d++)g._mixin(a,arguments[d]);return a},setObject:function(a,b,d){var c=a.split(".");
a=c.pop();return(d=m(c,!0,d))&&a?d[a]=b:void 0},getObject:function(a,b,d){return m(a?a.split("."):[],b,d)},exists:function(a,b){return void 0!==g.getObject(a,!1,b)},isString:function(a){return"string"==typeof a||a instanceof String},isArray:function(a){return a&&(a instanceof Array||"array"==typeof a)},isFunction:function(a){return"[object Function]"===n.call(a)},isObject:function(a){return void 0!==a&&(null===a||"object"==typeof a||g.isArray(a)||g.isFunction(a))},isArrayLike:function(a){return a&&
void 0!==a&&!g.isString(a)&&!g.isFunction(a)&&!(a.tagName&&"form"==a.tagName.toLowerCase())&&(g.isArray(a)||isFinite(a.length))},isAlien:function(a){return a&&!g.isFunction(a)&&/\{\s*\[native code\]\s*\}/.test(String(a))},extend:function(a,b){for(var d=1,c=arguments.length;d<c;d++)g._mixin(a.prototype,arguments[d]);return a},_hitchArgs:function(a,f){var d=g._toArray(arguments,2),c=g.isString(f);return function(){var h=g._toArray(arguments),e=c?(a||b.global)[f]:f;return e&&e.apply(a||this,d.concat(h))}},
hitch:function(a,f){if(2<arguments.length)return g._hitchArgs.apply(b,arguments);f||(f=a,a=null);if(g.isString(f)){a=a||b.global;if(!a[f])throw['lang.hitch: scope["',f,'"] is null (scope\x3d"',a,'")'].join("");return function(){return a[f].apply(a,arguments||[])}}return!a?f:function(){return f.apply(a,arguments||[])}},delegate:function(){function a(){}return function(b,d){a.prototype=b;var c=new a;a.prototype=null;d&&g._mixin(c,d);return c}}(),_toArray:l("ie")?function(){function a(a,b,c){c=c||[];
for(b=b||0;b<a.length;b++)c.push(a[b]);return c}return function(b){return(b.item?a:q).apply(this,arguments)}}():q,partial:function(a){return g.hitch.apply(b,[null].concat(g._toArray(arguments)))},clone:function(a){if(!a||"object"!=typeof a||g.isFunction(a))return a;if(a.nodeType&&"cloneNode"in a)return a.cloneNode(!0);if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return RegExp(a);var b,d,c;if(g.isArray(a)){b=[];d=0;for(c=a.length;d<c;++d)d in a&&b.push(g.clone(a[d]))}else b=
a.constructor?new a.constructor:{};return g._mixin(b,a,g.clone)},trim:String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(a,b,d){return a.replace(d||k,g.isFunction(b)?b:function(a,d){return g.getObject(d,!1,b)})}};g.mixin(b,g);return g})},"dojo/request/util":function(){define("exports ../errors/RequestError ../errors/CancelError ../Deferred ../io-query ../_base/array ../_base/lang ../promise/Promise".split(" "),function(b,
l,e,p,m,n,q,k){function g(a){return f(a)}function a(a){return a.data||a.text}b.deepCopy=function(a,c){for(var f in c){var e=a[f],g=c[f];e!==g&&(e&&"object"===typeof e&&g&&"object"===typeof g?b.deepCopy(e,g):a[f]=g)}return a};b.deepCreate=function(a,c){c=c||{};var f=q.delegate(a),e,g;for(e in a)(g=a[e])&&"object"===typeof g&&(f[e]=b.deepCreate(g,c[e]));return b.deepCopy(f,c)};var f=Object.freeze||function(a){return a};b.deferred=function(d,c,h,m,n,v){var u=new p(function(a){c&&c(u,d);return!a||!(a instanceof
l)&&!(a instanceof e)?new e("Request canceled",d):a});u.response=d;u.isValid=h;u.isReady=m;u.handleResponse=n;h=u.then(g).otherwise(function(a){a.response=d;throw a;});b.notify&&h.then(q.hitch(b.notify,"emit","load"),q.hitch(b.notify,"emit","error"));m=h.then(a);n=new k;for(var s in m)m.hasOwnProperty(s)&&(n[s]=m[s]);n.response=h;f(n);v&&u.then(function(a){v.call(u,a)},function(a){v.call(u,d,a)});u.promise=n;u.then=n.then;return u};b.addCommonMethods=function(a,b){n.forEach(b||["GET","POST","PUT",
"DELETE"],function(b){a[("DELETE"===b?"DEL":b).toLowerCase()]=function(c,f){f=q.delegate(f||{});f.method=b;return a(c,f)}})};b.parseArgs=function(a,b,f){var e=b.data,g=b.query;e&&!f&&"object"===typeof e&&(b.data=m.objectToQuery(e));g?("object"===typeof g&&(g=m.objectToQuery(g)),b.preventCache&&(g+=(g?"\x26":"")+"request.preventCache\x3d"+ +new Date)):b.preventCache&&(g="request.preventCache\x3d"+ +new Date);a&&g&&(a+=(~a.indexOf("?")?"\x26":"?")+g);return{url:a,options:b,getHeader:function(a){return null}}};
b.checkStatus=function(a){a=a||0;return 200<=a&&300>a||304===a||1223===a||!a}})},"dojo/Evented":function(){define(["./aspect","./on"],function(b,l){function e(){}var p=b.after;e.prototype={on:function(b,e){return l.parse(this,b,e,function(b,k){return p(b,"on"+k,e,!0)})},emit:function(b,e){var q=[this];q.push.apply(q,arguments);return l.emit.apply(l,q)}};return e})},"dojo/mouse":function(){define(["./_base/kernel","./on","./has","./dom","./_base/window"],function(b,l,e,p,m){function n(b,e){var g=function(a,
f){return l(a,b,function(b){if(e)return e(b,f);if(!p.isDescendant(b.relatedTarget,a))return f.call(this,b)})};g.bubble=function(a){return n(b,function(b,d){var c=a(b.target),h=b.relatedTarget;if(c&&c!=(h&&1==h.nodeType&&a(h)))return d.call(c,b)})};return g}e.add("dom-quirks",m.doc&&"BackCompat"==m.doc.compatMode);e.add("events-mouseenter",m.doc&&"onmouseenter"in m.doc.createElement("div"));e.add("events-mousewheel",m.doc&&"onmousewheel"in m.doc);m=e("dom-quirks")&&e("ie")||!e("dom-addeventlistener")?
{LEFT:1,MIDDLE:4,RIGHT:2,isButton:function(b,e){return b.button&e},isLeft:function(b){return b.button&1},isMiddle:function(b){return b.button&4},isRight:function(b){return b.button&2}}:{LEFT:0,MIDDLE:1,RIGHT:2,isButton:function(b,e){return b.button==e},isLeft:function(b){return 0==b.button},isMiddle:function(b){return 1==b.button},isRight:function(b){return 2==b.button}};b.mouseButtons=m;b=e("events-mousewheel")?"mousewheel":function(b,e){return l(b,"DOMMouseScroll",function(b){b.wheelDelta=-b.detail;
e.call(this,b)})};return{_eventHandler:n,enter:n("mouseover"),leave:n("mouseout"),wheel:b,isLeft:m.isLeft,isMiddle:m.isMiddle,isRight:m.isRight}})},"dojo/_base/xhr":function(){define("./kernel ./sniff require ../io-query ../dom ../dom-form ./Deferred ./config ./json ./lang ./array ../on ../aspect ../request/watch ../request/xhr ../request/util".split(" "),function(b,l,e,p,m,n,q,k,g,a,f,d,c,h,r,t){b._xhrObj=r._create;var v=b.config;b.objectToQuery=p.objectToQuery;b.queryToObject=p.queryToObject;b.fieldToObject=
n.fieldToObject;b.formToObject=n.toObject;b.formToQuery=n.toQuery;b.formToJson=n.toJson;b._blockAsync=!1;l.add("native-xhr2-blob",function(){if(l("native-xhr2")){var a=new XMLHttpRequest;a.open("GET","/",!0);a.responseType="blob";var b=a.responseType;a.abort();return"blob"===b}});var u=b._contentHandlers=b.contentHandlers={text:function(a){return a.responseText},json:function(a){return g.fromJson(a.responseText||null)},"json-comment-filtered":function(a){k.useCommentedJson||console.warn("Consider using the standard mimetype:application/json. json-commenting can introduce security issues. To decrease the chances of hijacking, use the standard the 'json' handler and prefix your json with: {}\x26\x26\nUse djConfig.useCommentedJson\x3dtrue to turn off this message.");
a=a.responseText;var b=a.indexOf("/*"),c=a.lastIndexOf("*/");if(-1==b||-1==c)throw Error("JSON was not comment filtered");return g.fromJson(a.substring(b+2,c))},javascript:function(a){return b.eval(a.responseText)},xml:function(a){var b=a.responseXML;b&&(l("dom-qsa2.1")&&!b.querySelectorAll&&l("dom-parser"))&&(b=(new DOMParser).parseFromString(a.responseText,"application/xml"));if(l("ie")&&(!b||!b.documentElement)){var c=function(a){return"MSXML"+a+".DOMDocument"},c=["Microsoft.XMLDOM",c(6),c(4),
c(3),c(2)];f.some(c,function(c){try{var d=new ActiveXObject(c);d.async=!1;d.loadXML(a.responseText);b=d}catch(f){return!1}return!0})}return b},"json-comment-optional":function(a){return a.responseText&&/^[^{\[]*\/\*/.test(a.responseText)?u["json-comment-filtered"](a):u.json(a)}};l("native-xhr2")&&(u.arraybuffer=u.blob=u.document=function(a,b){return"blob"===b.args.handleAs&&!l("native-xhr2-blob")?new Blob([a.response],{type:a.getResponseHeader("Content-Type")}):a.response});b._ioSetArgs=function(c,
d,f,h){var e={args:c,url:c.url},g=null;if(c.form){var g=m.byId(c.form),k=g.getAttributeNode("action");e.url=e.url||(k?k.value:null);g=n.toObject(g)}k=[{}];g&&k.push(g);c.content&&k.push(c.content);c.preventCache&&k.push({"dojo.preventCache":(new Date).valueOf()});e.query=p.objectToQuery(a.mixin.apply(null,k));e.handleAs=c.handleAs||"text";var l=new q(function(a){a.canceled=!0;d&&d(a);var b=a.ioArgs.error;b||(b=Error("request cancelled"),b.dojoType="cancel",a.ioArgs.error=b);return b});l.addCallback(f);
var r=c.load;r&&a.isFunction(r)&&l.addCallback(function(a){return r.call(c,a,e)});var t=c.error;t&&a.isFunction(t)&&l.addErrback(function(a){return t.call(c,a,e)});var s=c.handle;s&&a.isFunction(s)&&l.addBoth(function(a){return s.call(c,a,e)});l.addErrback(function(a){return h(a,l)});v.ioPublish&&(b.publish&&!1!==e.args.ioPublish)&&(l.addCallbacks(function(a){b.publish("/dojo/io/load",[l,a]);return a},function(a){b.publish("/dojo/io/error",[l,a]);return a}),l.addBoth(function(a){b.publish("/dojo/io/done",
[l,a]);return a}));l.ioArgs=e;return l};var s=function(a){a=u[a.ioArgs.handleAs](a.ioArgs.xhr,a.ioArgs);return void 0===a?null:a},y=function(a,b){b.ioArgs.args.failOk||console.error(a);return a},A=function(a){0>=w&&(w=0,v.ioPublish&&(b.publish&&(!a||a&&!1!==a.ioArgs.args.ioPublish))&&b.publish("/dojo/io/stop"))},w=0;c.after(h,"_onAction",function(){w-=1});c.after(h,"_onInFlight",A);b._ioCancelAll=h.cancelAll;b._ioNotifyStart=function(a){v.ioPublish&&(b.publish&&!1!==a.ioArgs.args.ioPublish)&&(w||
b.publish("/dojo/io/start"),w+=1,b.publish("/dojo/io/send",[a]))};b._ioWatch=function(b,c,d,f){b.ioArgs.options=b.ioArgs.args;a.mixin(b,{response:b.ioArgs,isValid:function(a){return c(b)},isReady:function(a){return d(b)},handleResponse:function(a){return f(b)}});h(b);A(b)};b._ioAddQueryToUrl=function(a){a.query.length&&(a.url+=(-1==a.url.indexOf("?")?"?":"\x26")+a.query,a.query=null)};b.xhr=function(a,c,d){var f,h=b._ioSetArgs(c,function(a){f&&f.cancel()},s,y),e=h.ioArgs;"postData"in c?e.query=c.postData:
"putData"in c?e.query=c.putData:"rawBody"in c?e.query=c.rawBody:(2<arguments.length&&!d||-1==="POST|PUT".indexOf(a.toUpperCase()))&&b._ioAddQueryToUrl(e);var g;l("native-xhr2")&&(g={arraybuffer:1,blob:1,document:1});g=l("native-xhr2")&&g[c.handleAs]?c.handleAs:"text";"blob"===g&&!l("native-xhr2-blob")&&(g="arraybuffer");g={method:a,handleAs:g,responseType:c.responseType,timeout:c.timeout,withCredentials:c.withCredentials,ioArgs:e};"undefined"!==typeof c.headers&&(g.headers=c.headers);"undefined"!==
typeof c.contentType&&(g.headers||(g.headers={}),g.headers["Content-Type"]=c.contentType);"undefined"!==typeof e.query&&(g.data=e.query);"undefined"!==typeof c.sync&&(g.sync=c.sync);b._ioNotifyStart(h);try{f=r(e.url,g,!0)}catch(k){return h.cancel(),h}h.ioArgs.xhr=f.response.xhr;f.then(function(){h.resolve(h)}).otherwise(function(a){e.error=a;a.response&&(a.status=a.response.status,a.responseText=a.response.text,a.xhr=a.response.xhr);h.reject(a)});return h};b.xhrGet=function(a){return b.xhr("GET",
a)};b.rawXhrPost=b.xhrPost=function(a){return b.xhr("POST",a,!0)};b.rawXhrPut=b.xhrPut=function(a){return b.xhr("PUT",a,!0)};b.xhrDelete=function(a){return b.xhr("DELETE",a)};b._isDocumentOk=function(a){return t.checkStatus(a.status)};b._getText=function(a){var c;b.xhrGet({url:a,sync:!0,load:function(a){c=a}});return c};a.mixin(b.xhr,{_xhrObj:b._xhrObj,fieldToObject:n.fieldToObject,formToObject:n.toObject,objectToQuery:p.objectToQuery,formToQuery:n.toQuery,formToJson:n.toJson,queryToObject:p.queryToObject,
contentHandlers:u,_ioSetArgs:b._ioSetArgs,_ioCancelAll:b._ioCancelAll,_ioNotifyStart:b._ioNotifyStart,_ioWatch:b._ioWatch,_ioAddQueryToUrl:b._ioAddQueryToUrl,_isDocumentOk:b._isDocumentOk,_getText:b._getText,get:b.xhrGet,post:b.xhrPost,put:b.xhrPut,del:b.xhrDelete});return b.xhr})},"dojo/topic":function(){define(["./Evented"],function(b){var l=new b;return{publish:function(b,p){return l.emit.apply(l,arguments)},subscribe:function(b,p){return l.on.apply(l,arguments)}}})},"dojo/loadInit":function(){define(["./_base/loader"],
function(b){return{dynamic:0,normalize:function(b){return b},load:b.loadInit}})},"dojo/_base/unload":function(){define(["./kernel","./lang","../on"],function(b,l,e){var p=window,m={addOnWindowUnload:function(m,q){b.windowUnloaded||e(p,"unload",b.windowUnloaded=function(){});e(p,"unload",l.hitch(m,q))},addOnUnload:function(b,m){e(p,"beforeunload",l.hitch(b,m))}};b.addOnWindowUnload=m.addOnWindowUnload;b.addOnUnload=m.addOnUnload;return m})},"dojo/require":function(){define(["./_base/loader"],function(b){return{dynamic:0,
normalize:function(b){return b},load:b.require}})},"dojo/Deferred":function(){define(["./has","./_base/lang","./errors/CancelError","./promise/Promise","./promise/instrumentation"],function(b,l,e,p,m){var n=Object.freeze||function(){},q=function(a,b,h,e,g){2===b&&(f.instrumentRejected&&0===a.length)&&f.instrumentRejected(h,!1,e,g);for(g=0;g<a.length;g++)k(a[g],b,h,e)},k=function(b,c,h,e){var k=b[c],m=b.deferred;if(k)try{var l=k(h);if(0===c)"undefined"!==typeof l&&a(m,c,l);else{if(l&&"function"===
typeof l.then){b.cancel=l.cancel;l.then(g(m,1),g(m,2),g(m,0));return}a(m,1,l)}}catch(n){a(m,2,n)}else a(m,c,h);2===c&&f.instrumentRejected&&f.instrumentRejected(h,!!k,e,m.promise)},g=function(b,c){return function(f){a(b,c,f)}},a=function(a,b,f){if(!a.isCanceled())switch(b){case 0:a.progress(f);break;case 1:a.resolve(f);break;case 2:a.reject(f)}},f=function(a){var b=this.promise=new p,h=this,g,m,l,u=!1,s=[];Error.captureStackTrace&&(Error.captureStackTrace(h,f),Error.captureStackTrace(b,f));this.isResolved=
b.isResolved=function(){return 1===g};this.isRejected=b.isRejected=function(){return 2===g};this.isFulfilled=b.isFulfilled=function(){return!!g};this.isCanceled=b.isCanceled=function(){return u};this.progress=function(a,d){if(g){if(!0===d)throw Error("This deferred has already been fulfilled.");return b}q(s,0,a,null,h);return b};this.resolve=function(a,d){if(g){if(!0===d)throw Error("This deferred has already been fulfilled.");return b}q(s,g=1,m=a,null,h);s=null;return b};var y=this.reject=function(a,
d){if(g){if(!0===d)throw Error("This deferred has already been fulfilled.");return b}Error.captureStackTrace&&Error.captureStackTrace(l={},y);q(s,g=2,m=a,l,h);s=null;return b};this.then=b.then=function(a,d,e){var h=[e,a,d];h.cancel=b.cancel;h.deferred=new f(function(a){return h.cancel&&h.cancel(a)});g&&!s?k(h,g,m,l):s.push(h);return h.deferred.promise};this.cancel=b.cancel=function(b,c){if(g){if(!0===c)throw Error("This deferred has already been fulfilled.");}else{if(a){var f=a(b);b="undefined"===
typeof f?b:f}u=!0;if(g){if(2===g&&m===b)return b}else return"undefined"===typeof b&&(b=new e),y(b),b}};n(b)};f.prototype.toString=function(){return"[object Deferred]"};m&&m(f);return f})},"dojo/_base/NodeList":function(){define(["./kernel","../query","./array","./html","../NodeList-dom"],function(b,l,e){l=l.NodeList;var p=l.prototype;p.connect=l._adaptAsForEach(function(){return b.connect.apply(this,arguments)});p.coords=l._adaptAsMap(b.coords);l.events="blur focus change click error keydown keypress keyup load mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup submit".split(" ");
e.forEach(l.events,function(b){var e="on"+b;p[e]=function(b,k){return this.connect(e,b,k)}});return b.NodeList=l})},"dojo/request":function(){define(["./request/default!"],function(b){return b})},"dojo/_base/Color":function(){define(["./kernel","./lang","./array","./config"],function(b,l,e,p){var m=b.Color=function(b){b&&this.setColor(b)};m.named={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,
128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],transparent:p.transparentColor||[0,0,0,0]};l.extend(m,{r:255,g:255,b:255,a:1,_set:function(b,e,k,g){this.r=b;this.g=e;this.b=k;this.a=g},setColor:function(b){l.isString(b)?m.fromString(b,this):l.isArray(b)?m.fromArray(b,this):(this._set(b.r,b.g,b.b,b.a),b instanceof m||this.sanitize());return this},sanitize:function(){return this},toRgb:function(){return[this.r,this.g,this.b]},
toRgba:function(){return[this.r,this.g,this.b,this.a]},toHex:function(){return"#"+e.map(["r","g","b"],function(b){b=this[b].toString(16);return 2>b.length?"0"+b:b},this).join("")},toCss:function(b){var e=this.r+", "+this.g+", "+this.b;return(b?"rgba("+e+", "+this.a:"rgb("+e)+")"},toString:function(){return this.toCss(!0)}});m.blendColors=b.blendColors=function(b,l,k,g){var a=g||new m;e.forEach(["r","g","b","a"],function(f){a[f]=b[f]+(l[f]-b[f])*k;"a"!=f&&(a[f]=Math.round(a[f]))});return a.sanitize()};
m.fromRgb=b.colorFromRgb=function(b,e){var k=b.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/);return k&&m.fromArray(k[1].split(/\s*,\s*/),e)};m.fromHex=b.colorFromHex=function(b,l){var k=l||new m,g=4==b.length?4:8,a=(1<<g)-1;b=Number("0x"+b.substr(1));if(isNaN(b))return null;e.forEach(["b","g","r"],function(f){var d=b&a;b>>=g;k[f]=4==g?17*d:d});k.a=1;return k};m.fromArray=b.colorFromArray=function(b,e){var k=e||new m;k._set(Number(b[0]),Number(b[1]),Number(b[2]),Number(b[3]));isNaN(k.a)&&(k.a=1);
return k.sanitize()};m.fromString=b.colorFromString=function(b,e){var k=m.named[b];return k&&m.fromArray(k,e)||m.fromRgb(b,e)||m.fromHex(b,e)};return m})},"dojo/promise/instrumentation":function(){define(["./tracer","../has","../_base/lang","../_base/array"],function(b,l,e,p){function m(a,b,f){var e="";a&&a.stack&&(e+=a.stack);b&&b.stack&&(e+="\n    ----------------------------------------\n    rejected"+b.stack.split("\n").slice(1).join("\n").replace(/^\s+/," "));f&&f.stack&&(e+="\n    ----------------------------------------\n"+
f.stack);console.error(a,e)}function n(a,b,f,e){b||m(a,f,e)}function q(b,c,e,l){p.some(g,function(a){if(a.error===b)return c&&(a.handled=!0),!0})||g.push({error:b,rejection:e,handled:c,deferred:l,timestamp:(new Date).getTime()});a||(a=setTimeout(k,f))}function k(){var b=(new Date).getTime(),c=b-f;g=p.filter(g,function(a){return a.timestamp<c?(a.handled||m(a.error,a.rejection,a.deferred),!1):!0});a=g.length?setTimeout(k,g[0].timestamp+f-b):!1}l.add("config-useDeferredInstrumentation","report-unhandled-rejections");
var g=[],a=!1,f=1E3;return function(a){var c=l("config-useDeferredInstrumentation");if(c){b.on("resolved",e.hitch(console,"log","resolved"));b.on("rejected",e.hitch(console,"log","rejected"));b.on("progress",e.hitch(console,"log","progress"));var h=[];"string"===typeof c&&(h=c.split(","),c=h.shift());if("report-rejections"===c)a.instrumentRejected=n;else if("report-unhandled-rejections"===c||!0===c||1===c)a.instrumentRejected=q,f=parseInt(h[0],10)||f;else throw Error("Unsupported instrumentation usage \x3c"+
c+"\x3e");}}})},"dojo/selector/_loader":function(){define(["../has","require"],function(b,l){var e=document.createElement("div");b.add("dom-qsa2.1",!!e.querySelectorAll);b.add("dom-qsa3",function(){try{return e.innerHTML="\x3cp class\x3d'TEST'\x3e\x3c/p\x3e",1==e.querySelectorAll(".TEST:empty").length}catch(b){}});var p;return{load:function(e,n,q,k){k=l;e="default"==e?b("config-selectorEngine")||"css3":e;e="css2"==e||"lite"==e?"./lite":"css2.1"==e?b("dom-qsa2.1")?"./lite":"./acme":"css3"==e?b("dom-qsa3")?
"./lite":"./acme":"acme"==e?"./acme":(k=n)&&e;if("?"==e.charAt(e.length-1)){e=e.substring(0,e.length-1);var g=!0}if(g&&(b("dom-compliant-qsa")||p))return q(p);k([e],function(a){"./lite"!=e&&(p=a);q(a)})}}})},"dojo/promise/Promise":function(){define(["../_base/lang"],function(b){function l(){throw new TypeError("abstract");}return b.extend(function(){},{then:function(b,p,m){l()},cancel:function(b,p){l()},isResolved:function(){l()},isRejected:function(){l()},isFulfilled:function(){l()},isCanceled:function(){l()},
always:function(b){return this.then(b,b)},otherwise:function(b){return this.then(null,b)},trace:function(){return this},traceRejected:function(){return this},toString:function(){return"[object Promise]"}})})},"dojo/request/watch":function(){define("./util ../errors/RequestTimeoutError ../errors/CancelError ../_base/array ../_base/window ../has!host-browser?dom-addeventlistener?:../on:".split(" "),function(b,l,e,p,m,n){function q(){for(var b=+new Date,d=0,c;d<a.length&&(c=a[d]);d++){var e=c.response,
m=e.options;if(c.isCanceled&&c.isCanceled()||c.isValid&&!c.isValid(e))a.splice(d--,1),k._onAction&&k._onAction();else if(c.isReady&&c.isReady(e))a.splice(d--,1),c.handleResponse(e),k._onAction&&k._onAction();else if(c.startTime&&c.startTime+(m.timeout||0)<b)a.splice(d--,1),c.cancel(new l("Timeout exceeded",e)),k._onAction&&k._onAction()}k._onInFlight&&k._onInFlight(c);a.length||(clearInterval(g),g=null)}function k(b){b.response.options.timeout&&(b.startTime=+new Date);b.isFulfilled()||(a.push(b),
g||(g=setInterval(q,50)),b.response.options.sync&&q())}var g=null,a=[];k.cancelAll=function(){try{p.forEach(a,function(a){try{a.cancel(new e("All requests canceled."))}catch(b){}})}catch(b){}};m&&(n&&m.doc.attachEvent)&&n(m.global,"unload",function(){k.cancelAll()});return k})},"dojo/on":function(){define(["./has!dom-addeventlistener?:./aspect","./_base/kernel","./sniff"],function(b,l,e){function p(a,b,c,f,l){if(f=b.match(/(.*):(.*)/))return b=f[2],f=f[1],k.selector(f,b).call(l,a,c);e("touch")&&(g.test(b)&&
(c=F(c)),!e("event-orientationchange")&&"orientationchange"==b&&(b="resize",a=window,c=F(c)));h&&(c=h(c));if(a.addEventListener){var m=b in d,n=m?d[b]:b;a.addEventListener(n,c,m);return{remove:function(){a.removeEventListener(n,c,m)}}}if(u&&a.attachEvent)return u(a,"on"+b,c);throw Error("Target must be an event emitter");}function m(){this.cancelable=!1;this.defaultPrevented=!0}function n(){this.bubbles=!1}var q=window.ScriptEngineMajorVersion;e.add("jscript",q&&q()+ScriptEngineMinorVersion()/10);
e.add("event-orientationchange",e("touch")&&!e("android"));e.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation);e.add("event-focusin",function(a,b,c){return"onfocusin"in c});e("touch")&&e.add("touch-can-modify-event-delegate",function(){var a=function(){};a.prototype=document.createEvent("MouseEvents");try{var b=new a;b.target=null;return null===b.target}catch(c){return!1}});var k=function(a,b,c,d){return"function"==typeof a.on&&
"function"!=typeof b&&!a.nodeType?a.on(b,c):k.parse(a,b,c,p,d,this)};k.pausable=function(a,b,c,d){var f;a=k(a,b,function(){if(!f)return c.apply(this,arguments)},d);a.pause=function(){f=!0};a.resume=function(){f=!1};return a};k.once=function(a,b,c,d){var f=k(a,b,function(){f.remove();return c.apply(this,arguments)});return f};k.parse=function(a,b,c,d,f,e){if(b.call)return b.call(e,a,c);if(b instanceof Array)h=b;else if(-1<b.indexOf(","))var h=b.split(/\s*,\s*/);if(h){var g=[];b=0;for(var l;l=h[b++];)g.push(k.parse(a,
l,c,d,f,e));g.remove=function(){for(var a=0;a<g.length;a++)g[a].remove()};return g}return d(a,b,c,f,e)};var g=/^touch/;k.matches=function(a,b,c,d,f){f=f&&f.matches?f:l.query;d=!1!==d;1!=a.nodeType&&(a=a.parentNode);for(;!f.matches(a,b,c);)if(a==c||!1===d||!(a=a.parentNode)||1!=a.nodeType)return!1;return a};k.selector=function(a,b,c){return function(d,f){function e(b){return k.matches(b,a,d,c,h)}var h="function"==typeof a?{matches:a}:this,g=b.bubble;return g?k(d,g(e),f):k(d,b,function(a){var b=e(a.target);
if(b)return f.call(b,a)})}};var a=[].slice,f=k.emit=function(b,c,d){var f=a.call(arguments,2),e="on"+c;if("parentNode"in b){var h=f[0]={},g;for(g in d)h[g]=d[g];h.preventDefault=m;h.stopPropagation=n;h.target=b;h.type=c;d=h}do b[e]&&b[e].apply(b,f);while(d&&d.bubbles&&(b=b.parentNode));return d&&d.cancelable&&d},d=e("event-focusin")?{}:{focusin:"focus",focusout:"blur"};if(!e("event-stopimmediatepropagation"))var c=function(){this.modified=this.immediatelyStopped=!0},h=function(a){return function(b){if(!b.immediatelyStopped)return b.stopImmediatePropagation=
c,a.apply(this,arguments)}};if(e("dom-addeventlistener"))k.emit=function(a,b,c){if(a.dispatchEvent&&document.createEvent){var d=(a.ownerDocument||document).createEvent("HTMLEvents");d.initEvent(b,!!c.bubbles,!!c.cancelable);for(var e in c)e in d||(d[e]=c[e]);return a.dispatchEvent(d)&&d}return f.apply(k,arguments)};else{k._fixEvent=function(a,b){a||(a=(b&&(b.ownerDocument||b.document||b).parentWindow||window).event);if(!a)return a;try{r&&(a.type==r.type&&a.srcElement==r.target)&&(a=r)}catch(c){}if(!a.target)switch(a.target=
a.srcElement,a.currentTarget=b||a.srcElement,"mouseover"==a.type&&(a.relatedTarget=a.fromElement),"mouseout"==a.type&&(a.relatedTarget=a.toElement),a.stopPropagation||(a.stopPropagation=s,a.preventDefault=y),a.type){case "keypress":var d="charCode"in a?a.charCode:a.keyCode;10==d?(d=0,a.keyCode=13):13==d||27==d?d=0:3==d&&(d=99);a.charCode=d;d=a;d.keyChar=d.charCode?String.fromCharCode(d.charCode):"";d.charOrCode=d.keyChar||d.keyCode}return a};var r,t=function(a){this.handle=a};t.prototype.remove=function(){delete _dojoIEListeners_[this.handle]};
var v=function(a){return function(b){b=k._fixEvent(b,this);var c=a.call(this,b);b.modified&&(r||setTimeout(function(){r=null}),r=b);return c}},u=function(a,c,d){d=v(d);if(((a.ownerDocument?a.ownerDocument.parentWindow:a.parentWindow||a.window||window)!=top||5.8>e("jscript"))&&!e("config-_allow_leaks")){"undefined"==typeof _dojoIEListeners_&&(_dojoIEListeners_=[]);var f=a[c];if(!f||!f.listeners){var h=f,f=Function("event","var callee \x3d arguments.callee; for(var i \x3d 0; i\x3ccallee.listeners.length; i++){var listener \x3d _dojoIEListeners_[callee.listeners[i]]; if(listener){listener.call(this,event);}}");
f.listeners=[];a[c]=f;f.global=this;h&&f.listeners.push(_dojoIEListeners_.push(h)-1)}f.listeners.push(a=f.global._dojoIEListeners_.push(d)-1);return new t(a)}return b.after(a,c,d,!0)},s=function(){this.cancelBubble=!0},y=k._preventDefault=function(){this.bubbledKeyCode=this.keyCode;if(this.ctrlKey)try{this.keyCode=0}catch(a){}this.defaultPrevented=!0;this.returnValue=!1;this.modified=!0}}if(e("touch"))var A=function(){},w=window.orientation,F=function(a){return function(b){var c=b.corrected;if(!c){var d=
b.type;try{delete b.type}catch(f){}if(b.type){if(e("touch-can-modify-event-delegate"))A.prototype=b,c=new A;else{var c={},h;for(h in b)c[h]=b[h]}c.preventDefault=function(){b.preventDefault()};c.stopPropagation=function(){b.stopPropagation()}}else c=b,c.type=d;b.corrected=c;if("resize"==d){if(w==window.orientation)return null;w=window.orientation;c.type="orientationchange";return a.call(this,c)}"rotation"in c||(c.rotation=0,c.scale=1);var d=c.changedTouches[0],g;for(g in d)delete c[g],c[g]=d[g]}return a.call(this,
c)}};return k})},"dojo/_base/sniff":function(){define(["./kernel","./lang","../sniff"],function(b,l,e){b._name="browser";l.mixin(b,{isBrowser:!0,isFF:e("ff"),isIE:e("ie"),isKhtml:e("khtml"),isWebKit:e("webkit"),isMozilla:e("mozilla"),isMoz:e("mozilla"),isOpera:e("opera"),isSafari:e("safari"),isChrome:e("chrome"),isMac:e("mac"),isIos:e("ios"),isAndroid:e("android"),isWii:e("wii"),isQuirks:e("quirks"),isAir:e("air")});return e})},"dojo/errors/create":function(){define(["../_base/lang"],function(b){return function(l,
e,p,m){p=p||Error;var n=function(b){if(p===Error){Error.captureStackTrace&&Error.captureStackTrace(this,n);var k=Error.call(this,b),g;for(g in k)k.hasOwnProperty(g)&&(this[g]=k[g]);this.message=b;this.stack=k.stack}else p.apply(this,arguments);e&&e.apply(this,arguments)};n.prototype=b.delegate(p.prototype,m);n.prototype.name=l;return n.prototype.constructor=n}})},"dojo/_base/array":function(){define(["./kernel","../has","./lang"],function(b,l,e){function p(a){return q[a]=new Function("item","index",
"array",a)}function m(a){var b=!a;return function(d,c,e){var g=0,k=d&&d.length||0,l;k&&"string"==typeof d&&(d=d.split(""));"string"==typeof c&&(c=q[c]||p(c));if(e)for(;g<k;++g){if(l=!c.call(e,d[g],g,d),a^l)return!l}else for(;g<k;++g)if(l=!c(d[g],g,d),a^l)return!l;return b}}function n(a){var b=1,d=0,c=0;a||(b=d=c=-1);return function(e,l,m,n){if(n&&0<b)return g.lastIndexOf(e,l,m);n=e&&e.length||0;var p=a?n+c:d;m===k?m=a?d:n+c:0>m?(m=n+m,0>m&&(m=d)):m=m>=n?n+c:m;for(n&&"string"==typeof e&&(e=e.split(""));m!=
p;m+=b)if(e[m]==l)return m;return-1}}var q={},k,g={every:m(!1),some:m(!0),indexOf:n(!0),lastIndexOf:n(!1),forEach:function(a,b,d){var c=0,e=a&&a.length||0;e&&"string"==typeof a&&(a=a.split(""));"string"==typeof b&&(b=q[b]||p(b));if(d)for(;c<e;++c)b.call(d,a[c],c,a);else for(;c<e;++c)b(a[c],c,a)},map:function(a,b,d,c){var e=0,g=a&&a.length||0;c=new (c||Array)(g);g&&"string"==typeof a&&(a=a.split(""));"string"==typeof b&&(b=q[b]||p(b));if(d)for(;e<g;++e)c[e]=b.call(d,a[e],e,a);else for(;e<g;++e)c[e]=
b(a[e],e,a);return c},filter:function(a,b,d){var c=0,e=a&&a.length||0,g=[],k;e&&"string"==typeof a&&(a=a.split(""));"string"==typeof b&&(b=q[b]||p(b));if(d)for(;c<e;++c)k=a[c],b.call(d,k,c,a)&&g.push(k);else for(;c<e;++c)k=a[c],b(k,c,a)&&g.push(k);return g},clearCache:function(){q={}}};e.mixin(b,g);return g})},"dojo/_base/json":function(){define(["./kernel","../json"],function(b,l){b.fromJson=function(b){return eval("("+b+")")};b._escapeString=l.stringify;b.toJsonIndentStr="\t";b.toJson=function(e,
p){return l.stringify(e,function(b,e){if(e){var l=e.__json__||e.json;if("function"==typeof l)return l.call(e)}return e},p&&b.toJsonIndentStr)};return b})},"dojo/_base/window":function(){define(["./kernel","./lang","../sniff"],function(b,l,e){var p={global:b.global,doc:b.global.document||null,body:function(e){e=e||b.doc;return e.body||e.getElementsByTagName("body")[0]},setContext:function(e,l){b.global=p.global=e;b.doc=p.doc=l},withGlobal:function(e,l,q,k){var g=b.global;try{return b.global=p.global=
e,p.withDoc.call(null,e.document,l,q,k)}finally{b.global=p.global=g}},withDoc:function(l,n,q,k){var g=p.doc,a=e("quirks"),f=e("ie"),d,c,h;try{b.doc=p.doc=l;b.isQuirks=e.add("quirks","BackCompat"==b.doc.compatMode,!0,!0);if(e("ie")&&(h=l.parentWindow)&&h.navigator)d=parseFloat(h.navigator.appVersion.split("MSIE ")[1])||void 0,(c=l.documentMode)&&(5!=c&&Math.floor(d)!=c)&&(d=c),b.isIE=e.add("ie",d,!0,!0);q&&"string"==typeof n&&(n=q[n]);return n.apply(q,k||[])}finally{b.doc=p.doc=g,b.isQuirks=e.add("quirks",
a,!0,!0),b.isIE=e.add("ie",f,!0,!0)}}};l.mixin(b,p);return p})},"dojo/dom-class":function(){define(["./_base/lang","./_base/array","./dom"],function(b,l,e){function p(b){if("string"==typeof b||b instanceof String){if(b&&!n.test(b))return q[0]=b,q;b=b.split(n);b.length&&!b[0]&&b.shift();b.length&&!b[b.length-1]&&b.pop();return b}return!b?[]:l.filter(b,function(a){return a})}var m,n=/\s+/,q=[""],k={};return m={contains:function(b,a){return 0<=(" "+e.byId(b).className+" ").indexOf(" "+a+" ")},add:function(b,
a){b=e.byId(b);a=p(a);var f=b.className,d,f=f?" "+f+" ":" ";d=f.length;for(var c=0,h=a.length,k;c<h;++c)(k=a[c])&&0>f.indexOf(" "+k+" ")&&(f+=k+" ");d<f.length&&(b.className=f.substr(1,f.length-2))},remove:function(g,a){g=e.byId(g);var f;if(void 0!==a){a=p(a);f=" "+g.className+" ";for(var d=0,c=a.length;d<c;++d)f=f.replace(" "+a[d]+" "," ");f=b.trim(f)}else f="";g.className!=f&&(g.className=f)},replace:function(b,a,f){b=e.byId(b);k.className=b.className;m.remove(k,f);m.add(k,a);b.className!==k.className&&
(b.className=k.className)},toggle:function(b,a,f){b=e.byId(b);if(void 0===f){a=p(a);for(var d=0,c=a.length,h;d<c;++d)h=a[d],m[m.contains(b,h)?"remove":"add"](b,h)}else m[f?"add":"remove"](b,a);return f}}})},"dojo/_base/config":function(){define(["../has","require"],function(b,l){var e={},p=l.rawConfig,m;for(m in p)e[m]=p[m];if(!e.locale&&"undefined"!=typeof navigator&&(p=navigator.language||navigator.userLanguage))e.locale=p.toLowerCase();return e})},"dojo/main":function(){define("./_base/kernel ./has require ./sniff ./_base/lang ./_base/array ./_base/config ./ready ./_base/declare ./_base/connect ./_base/Deferred ./_base/json ./_base/Color ./has!dojo-firebug?./_firebug/firebug ./_base/browser ./_base/loader".split(" "),
function(b,l,e,p,m,n,q,k){q.isDebug&&e(["./_firebug/firebug"]);var g=q.require;g&&(g=n.map(m.isArray(g)?g:[g],function(a){return a.replace(/\./g,"/")}),b.isAsync?e(g):k(1,function(){e(g)}));return b})},"dojo/_base/event":function(){define(["./kernel","../on","../has","../dom-geometry"],function(b,l,e,p){if(l._fixEvent){var m=l._fixEvent;l._fixEvent=function(b,e){(b=m(b,e))&&p.normalizeEvent(b);return b}}var n={fix:function(b,e){return l._fixEvent?l._fixEvent(b,e):b},stop:function(b){e("dom-addeventlistener")||
b&&b.preventDefault?(b.preventDefault(),b.stopPropagation()):(b=b||window.event,b.cancelBubble=!0,l._preventDefault.call(b))}};b.fixEvent=n.fix;b.stopEvent=n.stop;return n})},"dojo/sniff":function(){define(["./has"],function(b){var l=navigator,e=l.userAgent,l=l.appVersion,p=parseFloat(l);b.add("air",0<=e.indexOf("AdobeAIR"));b.add("msapp",parseFloat(e.split("MSAppHost/")[1])||void 0);b.add("khtml",0<=l.indexOf("Konqueror")?p:void 0);b.add("webkit",parseFloat(e.split("WebKit/")[1])||void 0);b.add("chrome",
parseFloat(e.split("Chrome/")[1])||void 0);b.add("safari",0<=l.indexOf("Safari")&&!b("chrome")?parseFloat(l.split("Version/")[1]):void 0);b.add("mac",0<=l.indexOf("Macintosh"));b.add("quirks","BackCompat"==document.compatMode);if(e.match(/(iPhone|iPod|iPad)/)){var m=RegExp.$1.replace(/P/,"p"),n=e.match(/OS ([\d_]+)/)?RegExp.$1:"1",n=parseFloat(n.replace(/_/,".").replace(/_/g,""));b.add(m,n);b.add("ios",n)}b.add("android",parseFloat(e.split("Android ")[1])||void 0);b.add("bb",(0<=e.indexOf("BlackBerry")||
0<=e.indexOf("BB10"))&&parseFloat(e.split("Version/")[1])||void 0);b.add("trident",parseFloat(l.split("Trident/")[1])||void 0);b.add("svg","undefined"!==typeof SVGAngle);b("webkit")||(0<=e.indexOf("Opera")&&b.add("opera",9.8<=p?parseFloat(e.split("Version/")[1])||p:p),0<=e.indexOf("Gecko")&&(!b("khtml")&&!b("webkit")&&!b("trident"))&&b.add("mozilla",p),b("mozilla")&&b.add("ff",parseFloat(e.split("Firefox/")[1]||e.split("Minefield/")[1])||void 0),document.all&&!b("opera")&&(e=parseFloat(l.split("MSIE ")[1])||
void 0,(l=document.documentMode)&&(5!=l&&Math.floor(e)!=l)&&(e=l),b.add("ie",e)),b.add("wii","undefined"!=typeof opera&&opera.wiiremote));return b})},"dojo/request/handlers":function(){define(["../json","../_base/kernel","../_base/array","../has","../selector/_loader"],function(b,l,e,p){function m(b){var d=a[b.options.handleAs];b.data=d?d(b):b.data||b.text;return b}p.add("activex","undefined"!==typeof ActiveXObject);p.add("dom-parser",function(a){return"DOMParser"in a});var n;if(p("activex")){var q=
["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML.DOMDocument"],k;n=function(a){function b(a){try{var d=new ActiveXObject(a);d.async=!1;d.loadXML(g);c=d;k=a}catch(f){return!1}return!0}var c=a.data,g=a.text;c&&(p("dom-qsa2.1")&&!c.querySelectorAll&&p("dom-parser"))&&(c=(new DOMParser).parseFromString(g,"application/xml"));if(!c||!c.documentElement)(!k||!b(k))&&e.some(q,b);return c}}var g=function(a){return!p("native-xhr2-blob")&&"blob"===a.options.handleAs&&"undefined"!==
typeof Blob?new Blob([a.xhr.response],{type:a.xhr.getResponseHeader("Content-Type")}):a.xhr.response},a={javascript:function(a){return l.eval(a.text||"")},json:function(a){return b.parse(a.text||null)},xml:n,blob:g,arraybuffer:g,document:g};m.register=function(b,d){a[b]=d};return m})},"dojo/aspect":function(){define([],function(){function b(b,e,a,f){var d=b[e],c="around"==e,h;if(c){var l=a(function(){return d.advice(this,arguments)});h={remove:function(){l&&(l=b=a=null)},advice:function(a,b){return l?
l.apply(a,b):d.advice(a,b)}}}else h={remove:function(){if(h.advice){var c=h.previous,d=h.next;!d&&!c?delete b[e]:(c?c.next=d:b[e]=d,d&&(d.previous=c));b=a=h.advice=null}},id:p++,advice:a,receiveArguments:f};if(d&&!c)if("after"==e){for(;d.next&&(d=d.next););d.next=h;h.previous=d}else"before"==e&&(b[e]=h,h.next=d,d.previous=h);else b[e]=h;return h}function l(k){return function(g,a,f,d){var c=g[a],h;if(!c||c.target!=g)g[a]=h=function(){for(var a=p,b=arguments,c=h.before;c;)c.advice&&(b=c.advice.apply(this,
b)||b),c=c.next;if(h.around)var d=h.around.advice(this,b);for(c=h.after;c&&c.id<a;){if(c.advice)if(c.receiveArguments)var f=c.advice.apply(this,b),d=f===e?d:f;else d=c.advice.call(this,d,b);c=c.next}return d},c&&(h.around={advice:function(a,b){return c.apply(a,b)}}),h.target=g;g=b(h||c,k,f,d);f=null;return g}}var e,p=0,m=l("after"),n=l("before"),q=l("around");return{before:n,around:q,after:m}})},"dojo/ready":function(){define(["./_base/kernel","./has","require","./domReady","./_base/lang"],function(b,
l,e,p,m){var n=0,q=[],k=0;l=function(){n=1;b._postLoad=b.config.afterOnLoad=!0;g()};var g=function(){if(!k){for(k=1;n&&(!p||0==p._Q.length)&&(e.idle?e.idle():1)&&q.length;){var a=q.shift();try{a()}catch(b){if(b.info=b.message,e.signal)e.signal("error",b);else throw b;}}k=0}};e.on&&e.on("idle",g);p&&(p._onQEmpty=g);var a=b.ready=b.addOnLoad=function(a,c,e){var f=m._toArray(arguments);"number"!=typeof a?(e=c,c=a,a=1E3):f.shift();e=e?m.hitch.apply(b,f):function(){c()};e.priority=a;for(f=0;f<q.length&&
a>=q[f].priority;f++);q.splice(f,0,e);g()},f=b.config.addOnLoad;if(f)a[m.isArray(f)?"apply":"call"](b,f);b.config.parseOnLoad&&!b.isAsync&&a(99,function(){b.parser||(b.deprecated("Add explicit require(['dojo/parser']);","","2.0"),e(["dojo/parser"]))});p?p(l):l();return a})},"dojo/_base/connect":function(){define("./kernel ../on ../topic ../aspect ./event ../mouse ./sniff ./lang ../keys".split(" "),function(b,l,e,p,m,n,q,k){function g(a,c,d,e,f){e=k.hitch(d,e);if(!a||!a.addEventListener&&!a.attachEvent)return p.after(a||
b.global,c,e,!0);"string"==typeof c&&"on"==c.substring(0,2)&&(c=c.substring(2));a||(a=b.global);if(!f)switch(c){case "keypress":c=h;break;case "mouseenter":c=n.enter;break;case "mouseleave":c=n.leave}return l(a,c,e,f)}function a(a){a.keyChar=a.charCode?String.fromCharCode(a.charCode):"";a.charOrCode=a.keyChar||a.keyCode}q.add("events-keypress-typed",function(){var a={charCode:0};try{a=document.createEvent("KeyboardEvent"),(a.initKeyboardEvent||a.initKeyEvent).call(a,"keypress",!0,!0,null,!1,!1,!1,
!1,9,3)}catch(b){}return 0==a.charCode&&!q("opera")});var f={106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,229:113},d=q("mac")?"metaKey":"ctrlKey",c=function(b,c){var d=k.mixin({},b,c);a(d);d.preventDefault=function(){b.preventDefault()};d.stopPropagation=function(){b.stopPropagation()};return d},h;h=q("events-keypress-typed")?function(a,b){var d=l(a,"keydown",function(a){var d=a.keyCode,e=13!=d&&32!=d&&(27!=d||!q("ie"))&&(48>d||90<d)&&(96>d||111<d)&&(186>
d||192<d)&&(219>d||222<d)&&229!=d;if(e||a.ctrlKey){e=e?0:d;if(a.ctrlKey){if(3==d||13==d)return b.call(a.currentTarget,a);e=95<e&&106>e?e-48:!a.shiftKey&&65<=e&&90>=e?e+32:f[e]||e}d=c(a,{type:"keypress",faux:!0,charCode:e});b.call(a.currentTarget,d);if(q("ie"))try{a.keyCode=d.keyCode}catch(g){}}}),e=l(a,"keypress",function(a){var d=a.charCode;a=c(a,{charCode:32<=d?d:0,faux:!0});return b.call(this,a)});return{remove:function(){d.remove();e.remove()}}}:q("opera")?function(a,b){return l(a,"keypress",
function(a){var d=a.which;3==d&&(d=99);d=32>d&&!a.shiftKey?0:d;a.ctrlKey&&(!a.shiftKey&&65<=d&&90>=d)&&(d+=32);return b.call(this,c(a,{charCode:d}))})}:function(b,c){return l(b,"keypress",function(b){a(b);return c.call(this,b)})};var r={_keypress:h,connect:function(a,b,c,d,e){var f=arguments,h=[],k=0;h.push("string"==typeof f[0]?null:f[k++],f[k++]);var l=f[k+1];h.push("string"==typeof l||"function"==typeof l?f[k++]:null,f[k++]);for(l=f.length;k<l;k++)h.push(f[k]);return g.apply(this,h)},disconnect:function(a){a&&
a.remove()},subscribe:function(a,b,c){return e.subscribe(a,k.hitch(b,c))},publish:function(a,b){return e.publish.apply(e,[a].concat(b))},connectPublisher:function(a,b,c){var d=function(){r.publish(a,arguments)};return c?r.connect(b,c,d):r.connect(b,d)},isCopyKey:function(a){return a[d]}};r.unsubscribe=r.disconnect;k.mixin(b,r);return r})},"dojo/errors/CancelError":function(){define(["./create"],function(b){return b("CancelError",null,null,{dojoType:"cancel"})})},"*noref":1}});
(function(){var b=this.require;b({cache:{}});!b.async&&b(["dojo"]);b.boot&&b.apply(null,b.boot)})();

//>>built
require({cache:{"esri/layers/FeatureEditResult":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(m,q,b,f){m=m(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(b){b&&q.isObject(b)&&(this.objectId=b.objectId,this.success=b.success,b.success||(b=b.error,this.error=Error(),this.error.code=b.code,this.error.message=b.description))}});b("extend-esri")&&q.setObject("layers.FeatureEditResult",m,f);return m})},"esri/layers/TimeReference":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(m,q,b,f){m=m(null,{declaredClass:"esri.layers.TimeReference",constructor:function(b){b&&q.mixin(this,b)}});b("extend-esri")&&q.setObject("layers.TimeReference",m,f);return m})},"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang","dojo/_base/declare","dojo/_base/lang","dojo/has"],function(m,q,b,f,n){b=b(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(b){f.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",
authNamespace:"/",forceLogin:!1,showSocialLogins:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,location,resizable,scrollbars,status"},b)},_oAuthCred:null,toJson:function(){return q.fixJson({appId:this.appId,expiration:this.expiration,locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,showSocialLogins:this.showSocialLogins,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,
popupWindowFeatures:this.popupWindowFeatures})}});n("extend-esri")&&f.setObject("arcgis.OAuthInfo",b,m);return b})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),function(m,q,b,f,n,h,r,k,d,c,a){k=m("dijit.form.TextBox"+(r("dojo-bidi")?"_NoBidi":""),[k,d],{templateString:c,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',
_buttonInputDisabled:r("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>r("ie")&&this.defer(function(){try{var a=b.getComputedStyle(this.domNode);if(a){var c=a.fontFamily;
if(c){var d=this.domNode.getElementsByTagName("INPUT");if(d)for(a=0;a<d.length;a++)d[a].style.fontFamily=c}}}catch(t){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||(this._attachPoints.push("_phspan"),this._phspan=q.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after"),this.own(h(this._phspan,"mousedown",function(a){a.preventDefault()}),h(this._phspan,"touchend, pointerup, MSPointerUp",n.hitch(this,function(){this.focus()}))));this._phspan.innerHTML=
"";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},_setValueAttr:function(a,b,c){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){f.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.",
"","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){f.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),this._updatePlaceHolder(),r("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){!this.disabled&&!this.readOnly&&(this.inherited(arguments),this._updatePlaceHolder())}});
9>r("ie")&&(k.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},a._setSelectionRange=d._setSelectionRange=function(a,b,c){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveStart("character",-99999),a.moveStart("character",b),a.moveEnd("character",c-b),a.select())});r("dojo-bidi")&&(k=m("dijit.form.TextBox",k,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));
return k})},"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),function(m,q,b,f,n,h,r,k,d,c,a,e,l){m=m(e,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},
constructor:function(a,b){this._handler=q.hitch(this,this._handler);this._relationshipQueryHandler=q.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=q.hitch(this,this._executeForIdsHandler);this._countHandler=q.hitch(this,this._countHandler);this._extentHandler=q.hitch(this,this._extentHandler);this.source=b&&b.source;this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],
e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},onExecuteForExtentComplete:function(){},execute:function(a,b,c,g,d){var e=d.assembly;a=this._encode(q.mixin({},this._url.query,{f:"json"},a.toJson(e&&e[0])));var l=this._handler,h=this._errorHandler;this.source&&(e={source:this.source.toJson()},
a.layer=n.toJson(e));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return k({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,g){l(a,g,b,c,d.dfd)},error:function(a){h(a,c,d.dfd)},callbackSuffix:g},this.requestOptions)},executeRelationshipQuery:function(a,b,c){a=this._encode(q.mixin({},this._url.query,{f:"json"},a.toJson()));var g=this._relationshipQueryHandler,e=this._errorHandler;this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var l=new f(d._dfdCanceller);l._pendingDfd=
k({url:this._url.path+"/queryRelatedRecords",content:a,callbackParamName:"callback",load:function(a,d){g(a,d,b,c,l)},error:function(a){e(a,c,l)}},this.requestOptions);return l},executeForIds:function(a,b,c,g){var d=g.assembly;a=this._encode(q.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},a.toJson(d&&d[0])));var e=this._executeForIdsHandler,l=this._errorHandler;this.source&&(d={source:this.source.toJson()},a.layer=n.toJson(d));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return k({url:this._url.path+
"/query",content:a,callbackParamName:"callback",load:function(a,d){e(a,d,b,c,g.dfd)},error:function(a){l(a,c,g.dfd)}},this.requestOptions)},executeForCount:function(a,b,c,g){var d=g.assembly;a=this._encode(q.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJson(d&&d[0])));var e=this._countHandler,l=this._errorHandler;this.source&&(d={source:this.source.toJson()},a.layer=n.toJson(d));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return k({url:this._url.path+"/query",content:a,
callbackParamName:"callback",load:function(a,d){e(a,d,b,c,g.dfd)},error:function(a){l(a,c,g.dfd)}},this.requestOptions)},executeForExtent:function(a,b,c,g){var d=g.assembly;a=this._encode(q.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJson(d&&d[0])));var e=this._extentHandler,l=this._errorHandler;this.source&&(d={source:this.source.toJson()},a.layer=n.toJson(d));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return k({url:this._url.path+"/query",content:a,callbackParamName:"callback",
load:function(a,d){e(a,d,b,c,g.dfd)},error:function(a){l(a,c,g.dfd)}},this.requestOptions)},_handler:function(a,b,c,g,d){try{var e=new l(a);this._successHandler([e],"onComplete",c,d)}catch(w){this._errorHandler(w,g,d)}},_relationshipQueryHandler:function(a,c,d,g,e){try{var v=a.geometryType,w=a.spatialReference,k={};b.forEach(a.relatedRecordGroups,function(a){var b={};b.geometryType=v;b.spatialReference=w;b.features=a.relatedRecords;b=new l(b);if(null!=a.objectId)k[a.objectId]=b;else for(var c in a)a.hasOwnProperty(c)&&
"relatedRecords"!==c&&(k[a[c]]=b)});this._successHandler([k],"onExecuteRelationshipQueryComplete",d,e)}catch(h){this._errorHandler(h,g,e)}},_executeForIdsHandler:function(a,b,c,g,d){try{this._successHandler([a.objectIds],"onExecuteForIdsComplete",c,d)}catch(e){this._errorHandler(e,g,d)}},_countHandler:function(a,b,c,g,d){try{var e,l=a.features,k=a.objectIds;if(k)e=k.length;else{if(l)throw Error("Unable to perform query. Please check your parameters.");e=a.count}this._successHandler([e],"onExecuteForCountComplete",
c,d)}catch(h){this._errorHandler(h,g,d)}},_extentHandler:function(a,b,d,g,e){try{a.extent&&(a.extent=new c(a.extent)),this._successHandler([a],"onExecuteForExtentComplete",d,e)}catch(l){this._errorHandler(l,g,e)}}});a._createWrappers(m);h("extend-esri")&&q.setObject("tasks.QueryTask",m,r);return m})},"esri/symbols/Font":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang".split(" "),function(m,q,b,f,n,h){m=m(null,{declaredClass:"esri.symbol.Font",constructor:function(h,
k,d,c,a){h?q.isObject(h)?q.mixin(this,h):(this.size=h,parseFloat(this.size)==this.size&&(this.size+="px"),void 0!==k&&(this.style=k),void 0!==d&&(this.variant=d),void 0!==c&&(this.weight=c),void 0!==a&&(this.family=a)):q.mixin(this,f.defaultFont);parseFloat(this.size)==this.size&&(this.size+="pt");9>b("ie")&&(this.size&&q.isString(this.size)&&-1<this.size.indexOf("em"))&&(this.size=f.pt2px(12*parseFloat(this.size))+"px");this.size=this._convert2PxSize(this.size)},setSize:function(b){this.size=this._convert2PxSize(b);
return this},_convert2PxSize:function(b){var k;parseFloat(b)==b?k=b:q.isString(b)&&(-1<b.indexOf("pt")?k=f.pt2px(parseFloat(b)):-1<b.indexOf("px")?k=parseFloat(b):-1<b.indexOf("em")?k=f.pt2px(12*parseFloat(b)):-1<b.indexOf("%")&&(k=f.pt2px(0.12*parseFloat(b))));return k},setStyle:function(b){this.style=b;return this},setVariant:function(b){this.variant=b;return this},setWeight:function(b){this.weight=b;return this},setFamily:function(b){this.family=b;return this},setDecoration:function(b){this.decoration=
b;return this},toJson:function(){return h.fixJson({size:f.px2pt(this.size),style:this.style,variant:this.variant,decoration:this.decoration,weight:this.weight,family:this.family})}});q.mixin(m,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"});b("extend-esri")&&q.setObject("symbol.Font",m,n);return m})},"esri/sniff":function(){define(["dojo/_base/sniff",
"./kernel"],function(m,q){var b=m("ff"),f=m("ie"),n=void 0===f&&7<=m("trident"),h=m("webkit"),r=m("opera"),k=m("chrome"),d=m("safari"),c=navigator.userAgent,a;(a=c.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i))&&m.add("esri-iphone",parseFloat(a[2].replace("_",".")));(a=c.match(/Android\s+(\d+\.\d+)/i))&&m.add("esri-android",parseFloat(a[1]));(a=c.match(/Fennec\/(\d+\.\d+)/i))&&m.add("esri-fennec",parseFloat(a[1]));0<=c.indexOf("BlackBerry")&&0<=c.indexOf("WebKit")&&m.add("esri-blackberry",1);m.add("esri-touch",
m("esri-iphone")||m("esri-android")||m("esri-blackberry")||6<=m("esri-fennec")||(b||h)&&document.createTouch?!0:!1);(a=c.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i))&&m.add("esri-mobile",a);m.add("esri-pointer",navigator.pointerEnabled||navigator.msPointerEnabled);q._getDOMAccessor=function(a){var c="";b?c="Moz":h?c="Webkit":f?c="ms":r&&(c="O");return c+a.charAt(0).toUpperCase()+a.substr(1)};m.add("esri-phonegap",!!window.cordova);m.add("esri-cors",m("esri-phonegap")||
window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest);m.add("esri-file-upload",window.FormData&&window.FileList?!0:!1);m.add("esri-workers",window.Worker?!0:!1);m.add("esri-transforms",n||9<=f||3.5<=b||4<=k||3.1<=d||10.5<=r||3.2<=m("esri-iphone")||2.1<=m("esri-android"));m.add("esri-transitions",n||10<=f||4<=b||4<=k||3.1<=d||10.5<=r||3.2<=m("esri-iphone")||2.1<=m("esri-android"));m.add("esri-transforms3d",n||10<=b||12<=k||4<=d||3.2<=m("esri-iphone")||3<=m("esri-android"));m.add("esri-url-encodes-apostrophe",
function(){var a=window.document.createElement("a");a.href="?'";return-1<a.href.indexOf("?%27")});3>m("esri-android")&&(m.add("esri-transforms",!1,!1,!0),m.add("esri-transitions",!1,!1,!0),m.add("esri-transforms3d",!1,!1,!0));q._css=function(a){var c=m("esri-transforms3d");if(void 0!==a&&null!==a)c=a;else if(c&&(k||d&&!m("esri-iphone")))c=!1;var u=c?"translate3d(":"translate(",t=c?k?",-1px)":",0px)":")",p=c?"scale3d(":"scale(",g=c?",1)":")",s=c?"rotate3d(0,0,1,":"rotate(",v=c?"matrix3d(":"matrix(",
w=c?",0,0,":",",n=c?",0,0,0,0,1,0,":",",A=c?",0,1)":")";return{names:{transition:h&&"-webkit-transition"||b&&"MozTransition"||r&&"OTransition"||f&&"msTransition"||"transition",transform:h&&"-webkit-transform"||b&&"MozTransform"||r&&"OTransform"||f&&"msTransform"||"transform",transformName:h&&"-webkit-transform"||b&&"-moz-transform"||r&&"-o-transform"||f&&"-ms-transform"||"transform",origin:h&&"-webkit-transform-origin"||b&&"MozTransformOrigin"||r&&"OTransformOrigin"||f&&"msTransformOrigin"||"transformOrigin",
endEvent:h&&"webkitTransitionEnd"||b&&"transitionend"||r&&"oTransitionEnd"||f&&"MSTransitionEnd"||"transitionend"},translate:function(a,b){return u+a+"px,"+b+"px"+t},scale:function(a){return p+a+","+a+g},rotate:function(a){return s+a+"deg)"},matrix:function(a){return v+a.xx+","+a.xy+w+a.yx+","+a.yy+n+a.dx.toFixed(10)+(b?"px,":",")+a.dy.toFixed(10)+(b?"px":"")+A},getScaleFromMatrix:function(a){if(!a)return 1;a=a.toLowerCase();var b=-1<a.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(a.substring(b.length,
a.indexOf(",")))}}};m("extend-esri")&&(q.isiPhone=m("esri-iphone"),q.isAndroid=m("esri-android"),q.isFennec=m("esri-fennec"),q.isBlackBerry=m("esri-blackberry"),q.isTouchEnabled=m("esri-touch"),q.isPointerEnabled=m("esri-pointer"),q._hasCors=m("esri-cors"),q._hasFileUpload=m("esri-file-upload"),q._hasTransforms=m("esri-transforms"),q._hasTransitions=m("esri-transitions"),q._has3DTransforms=m("esri-transforms3d"));return m})},"dijit/_base/scroll":function(){define(["dojo/window","../main"],function(m,
q){q.scrollIntoView=function(b,f){m.scrollIntoView(b,f)}})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(m,q,b,f,n,h,r,k){var d=q("dijit._TemplatedMixin",k,{templateString:null,templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(b){var a=this.declaredClass,d=this;return r.substitute(b,this,function(b,c){"!"==c.charAt(0)&&(b=f.getObject(c.substr(1),
!1,d));if("undefined"==typeof b)throw Error(a+" template:"+c);return null==b?"":"!"==c.charAt(0)?b:this._escapeValue(""+b)},this)},_escapeValue:function(b){return b.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||(this.templateString=m(this.templatePath,{sanitize:!0}));var c=d.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),
a;if(f.isString(c)){if(a=b.toDom(this._stringRepl(c),this.ownerDocument),1!=a.nodeType)throw Error("Invalid template: "+c);}else a=c.cloneNode(!0);this.domNode=a}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(b){var a=this.containerNode;if(b&&a)for(;b.hasChildNodes();)a.appendChild(b.firstChild)}});d._templateCache={};d.getCachedTemplate=function(c,a,e){var l=d._templateCache,k=c,t=l[k];if(t){try{if(!t.ownerDocument||t.ownerDocument==
(e||document))return t}catch(p){}b.destroy(t)}c=r.trim(c);if(a||c.match(/\$\{([^\}]+)\}/g))return l[k]=c;a=b.toDom(c,e);if(1!=a.nodeType)throw Error("Invalid template: "+c);return l[k]=a};h("ie")&&n(window,"unload",function(){var c=d._templateCache,a;for(a in c){var e=c[a];"object"==typeof e&&b.destroy(e);delete c[a]}});return d})},"esri/dijit/Attribution":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-geometry ../kernel ../lang ../SpatialReference ../geometry/webMercatorUtils ../geometry/Extent".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e,l,u,t,p,g,s){m=m(null,{declaredClass:"esri.dijit.Attribution",itemDelimiter:" | ",listClass:"esriAttributionList",itemClass:"esriAttributionItem",lastItemClass:"esriAttributionLastItem",delimiterClass:"esriAttributionDelim",constructor:function(a,b){try{q.mixin(this,a);this._attributions={};this._pendingDfds={};this._activeLayers=[];this._sharedLayers=[];var c=this.domNode=k.byId(b),g=this.map,p="\x3cspan class\x3d'"+this.listClass+"'\x3e\x3c/span\x3e";c&&(d.set(c,
"innerHTML",p),this.listNode=n.query(".esriAttributionList",c)[0],this.itemNodes={});this._eventConnections=[f.connect(g,"onLayerAdd",this,this._onLayerAdd),f.connect(g,"onLayerRemove",this,this._onLayerRemove),f.connect(g,"onLayerSuspend",this,this._onLayerSuspend),f.connect(g,"onLayerResume",this,this._onLayerResume),f.connect(g,"onExtentChange",this,this._onExtentChange)];if(g.loaded){var e=g.layerIds.concat(g.graphicsLayerIds),l,s,t=e.length;for(s=0;s<t;s++)l=g.getLayer(e[s]),l.loaded&&this._onLayerAdd(l)}}catch(h){}},
startup:function(){},destroy:function(){b.forEach(this._eventConnections,f.disconnect);c.destroy(this.listNode);this.map=this.domNode=this._eventConnections=this.listNode=this._attributions=this._pendingDfds=this.itemNodes=this._activeLayers=this._lastItem=this._sharedLayers=null},_onLayerAdd:function(a){try{var b=this._attributions,c=a.id;if(!t.isDefined(b[c])&&a.showAttribution)if(a.hasAttributionData){var g=a.getAttributionData();this._pendingDfds[c]=1;b[c]=g;g.addBoth(q.partial(this._onAttributionLoad,
this,a))}else b[c]=a.copyright||a.copyrightText||"",b[c]?(a.suspended||this._activeLayers.push(c),this._createNode(c)):this._onLayerRemove(a)}catch(d){}},_onAttributionLoad:function(a,b,c){var g=a._attributions,d=a._pendingDfds,p=b.id;if(d&&d[p]){delete d[p];if(!c||c instanceof Error)c="";g[p]=c?a._createIndexByLevel(c,-1!==b.declaredClass.toLowerCase().indexOf("vetiledlayer")):b.copyright||b.copyrightText||"";g[p]?(b.suspended||a._activeLayers.push(p),a._createNode(p)):a._onLayerRemove(b)}},_onLayerRemove:function(a){try{var g=
a.id,d=this.itemNodes,p,e=-1;this._onLayerSuspend(a);delete this._attributions[g];delete this._pendingDfds[g];p=this._getGroupIndex(g);-1!==p&&(e=b.indexOf(this._sharedLayers[p],g),-1!==e&&(this._sharedLayers[p].splice(e,1),1>=this._sharedLayers[p].length&&this._sharedLayers.splice(p,1)));d[g]&&-1===e&&c.destroy(d[g]);delete d[g];this._updateLastItem()}catch(l){}},_onLayerSuspend:function(a){try{var c=a.id;if(this._attributions[c]){var g=b.indexOf(this._activeLayers,c),d=this.itemNodes[c];-1!==g&&
this._activeLayers.splice(g,1);d&&this._toggleItem(d,!1,this._getGroupIndex(c))}}catch(p){}},_onLayerResume:function(a){try{var c=a.id,g=this._attributions[c],p=this.itemNodes[c];if(g&&(-1===b.indexOf(this._activeLayers,c)&&this._activeLayers.push(c),p)){var e=q.isString(g)?g:this._getContributorsList(g,this.map.extent,this.map.getLevel());q.isString(g)||d.set(p,"innerHTML",e?e+this._getDelimiter():"");e&&this._toggleItem(p,!0,this._getGroupIndex(c))}}catch(l){}},_onExtentChange:function(a,b,c,g){try{var p=
this._activeLayers,e=this._attributions,l=this.itemNodes,s,t,k,h,u=p.length||0;for(h=0;h<u;h++)if(t=p[h],k=e[t],(s=l[t])&&!q.isString(k)){var f=this._getContributorsList(k,a,g?g.level:-1);d.set(s,"innerHTML",f?f+this._getDelimiter():"");this._toggleItem(s,!!f,-1)}}catch(r){}this._adjustCursorStyle()},_createNode:function(a){if(this.domNode){var b=this._checkShareInfo(a),g=b&&b.sharedWith,g=g&&this.itemNodes[g],d=this.map,p=this._attributions[a],p=q.isString(p)?p:this._getContributorsList(p,d.extent,
d.getLevel()),d=!!p&&!d.getLayer(a).suspended;g?(this.itemNodes[a]=g,this._toggleItem(g,d,b.index)):(a=this.itemNodes[a]=c.create("span",{"class":this.itemClass,innerHTML:p?p+this._getDelimiter():"",style:{display:d?"inline":"none"}},this.listNode),d&&this._setLastItem(a));this._adjustCursorStyle()}},_checkShareInfo:function(a){var c=this._attributions,g,d,p=-1,e=c[a],l;if(e&&q.isString(e)){for(d in c)if(g=c[d],d!==a&&g&&q.isString(g)&&g.length===e.length&&g.toLowerCase()===e.toLowerCase()){l=d;break}c=
this._sharedLayers;g=c.length;if(l){for(d=0;d<g;d++)if(e=c[d],-1!==b.indexOf(e,l)){p=d;e.push(a);break}-1===p&&(p=c.push([l,a])-1)}}return-1<p?{index:p,sharedWith:l}:null},_getGroupIndex:function(a){var c=this._sharedLayers,g,d=c.length,p=-1;for(g=0;g<d;g++)if(-1!==b.indexOf(c[g],a)){p=g;break}return p},_getDelimiter:function(){var a=this.itemDelimiter;return a?"\x3cspan class\x3d'"+this.delimiterClass+"'\x3e"+a+"\x3c/span\x3e":""},_toggleItem:function(c,g,d){if(-1<d&&!g){d=this._sharedLayers[d];
var p,e=d.length,l=this._activeLayers;for(p=0;p<e;p++)if(-1!==b.indexOf(l,d[p]))return}a.set(c,"display",g?"inline":"none");this._updateLastItem()},_updateLastItem:function(){var b=this.listNode.childNodes,c;c=b.length;var g;if(c)for(c-=1;0<=c;c--)if(g=b[c],"none"!==a.get(g,"display")){this._setLastItem(g);break}this._adjustCursorStyle()},_setLastItem:function(a){var b=this.itemClass,c=this.lastItemClass;this._lastItem&&e.replace(this._lastItem,b,c);a&&(e.replace(a,c,b),this._lastItem=a)},_createIndexByLevel:function(a,
b){var c=a.contributors,d,e,l,k,h=c?c.length:0,u,f,r=new p(4326),n={},q;for(k=0;k<h;k++){d=c[k];f=(e=d.coverageAreas)?e.length:0;for(u=0;u<f;u++){l=e[u];q=l.bbox;q={extent:g.geographicToWebMercator(new s(q[1],q[0],q[3],q[2],r)),attribution:d.attribution||"",zoomMin:l.zoomMin-(b&&l.zoomMin?1:0),zoomMax:l.zoomMax-(b&&l.zoomMax?1:0),score:t.isDefined(l.score)?l.score:100,objectId:k};for(l=q.zoomMin;l<=q.zoomMax;l++)n[l]=n[l]||[],n[l].push(q)}}return n},_getContributorsList:function(a,b,c){var g="";if(b&&
t.isDefined(c)&&-1<c){a=a[c];c=b.getCenter().normalize();for(var d=a?a.length:0,p=[],e={},g=0;g<d;g++)b=a[g],!e[b.objectId]&&b.extent.contains(c)&&(e[b.objectId]=1,p.push(b));p.sort(function(a,b){return b.score-a.score||a.objectId-b.objectId});d=p.length;for(g=0;g<d;g++)p[g]=p[g].attribution;g=p.join(", ")}return g},_adjustCursorStyle:function(){var b=l.position(this.listNode.parentNode,!0).h;e.contains(this.listNode.parentNode,"esriAttributionOpen")?(e.remove(this.listNode.parentNode,"esriAttributionOpen"),
b>l.position(this.listNode.parentNode,!0).h?(a.set(this.listNode.parentNode,"cursor","pointer"),e.add(this.listNode.parentNode,"esriAttributionOpen")):a.set(this.listNode.parentNode,"cursor","default")):(e.add(this.listNode.parentNode,"esriAttributionOpen"),b<l.position(this.listNode.parentNode,!0).h?a.set(this.listNode.parentNode,"cursor","pointer"):a.set(this.listNode.parentNode,"cursor","default"),e.remove(this.listNode.parentNode,"esriAttributionOpen"))}});h("extend-esri")&&q.setObject("dijit.Attribution",
m,u);return m})},"esri/layers/HeatmapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/_base/array require ../kernel ../sniff ../geometry/Point ../geometry/webMercatorUtils ./MapImage ../renderers/HeatmapRenderer ../tasks/query dojo/_base/fx".split(" "),function(m,q,b,f,n,h,r,k,d,c,a,e,l){function u(){}function t(a){var b=a.layer;return{geometry:a.geometry,attributes:a.attributes,getLayer:function(){return b}}}m=m(null,{declaredClass:"esri.layers.HeatmapManager",heatmapRenderer:null,
sourceLayer:null,imageLayer:null,useTiles:!0,useWorker:!1,map:null,constructor:function(a){this.sourceLayer=a;this._hndls=[]},initialize:function(b){this.map=b;var c=this.sourceLayer,d=c.renderer;c.setDrawMode(!1);this.imageLayer=b._getMapImageLyr();var e=this;this.heatmapRenderer=d instanceof a?d:(d.getRendererInfoByZoom(b.getZoom())||d.getRendererInfoByScale(b.getScale())).renderer;this._setupDraw=this._setupDraw.bind(this);this.recalculateHeatmap=this.recalculateHeatmap.bind(this);this._removeRenderer=
this._removeRenderer.bind(this);this._handleRendererChange=this._handleRendererChange.bind(this);this._rendererChangeHandle=this.sourceLayer.on("renderer-change",this._handleRendererChange);this._handleOpacityChange=this._handleOpacityChange.bind(this);this._reprojectFeature=this._reprojectFeature.bind(this);n(["../workers/heatmapCalculator"],function(a){e._calculator=new a(q.mixin({width:e.map.width,height:e.map.height},e._getOptions()));e._setupRenderer();e.heatmapRenderer.getStats=a.calculateStats;
e.heatmapRenderer.getHistogramData=a.getHistogramData})},destroy:function(){this._removeHandlers();this._rendererChangeHandle&&this._rendererChangeHandle.remove();this._rendererChangeHandle=this.sourceLayer=this.imageLayer=this.map=this.heatmapRenderer=this._hndls=null},_handleRendererChange:function(b){var c=b.renderer,d=c instanceof a;this.heatmapRenderer?d?this.heatmapRenderer=c:this._removeRenderer(b):d&&(this.heatmapRenderer=c,this.sourceLayer&&this.map&&this._setupRenderer())},_handleOpacityChange:function(a){a=
a.opacity;var b=this._getImageBySourceId(this.sourceLayer.id);b&&b.setOpacity(a)},_setupRenderer:function(){var a=this._hndls,c=this.sourceLayer,d=this.map,e=this;c._originalDraw=c._draw;c._draw=u;c._div.clear();clearTimeout(this._resetTimer);this._resetTimer=setTimeout(this._resetGraphics.bind(this),250);a.push(c.on("update-end",this._setupDraw));a.push(c.on("suspend",function(a){(a=e._getImageBySourceId(e.sourceLayer.id))&&a.hide()}));a.push(c.on("resume",function(a){(a=e._getImageBySourceId(e.sourceLayer.id))&&
a.show()}));a.push(b.after(c,"redraw",this._setupDraw));a.push(d.on("layer-remove",function(a){a.layer==c&&((a=e._getImageBySourceId(e.sourceLayer.id))&&e.imageLayer.removeImage(a),e._removeRenderer({target:c}))}));c._collection&&a.push(c.on("graphic-add",function(a){e._reprojectFeature(a.graphic);e._setupDraw()}));1!==c.mode&&(a.push(d.on("resize, pan-end",this._setupDraw)),a.push(d.on("zoom-end",this._setupDraw)));a.push(c.on("opacity-change",this._handleOpacityChange));this.imageLayer.suspended&&
this.imageLayer.resume();c.graphics&&c.graphics.length&&(c.graphics[0].geometry&&!d.spatialReference.equals(c.graphics[0].geometry.spatialReference)&&f.forEach(c.graphics,function(a){this._reprojectFeature(a)}.bind(this)),this._setupDraw())},_setupDraw:function(){if(!this._drawTimer){var b=this;this._drawTimer=setTimeout(function(){clearTimeout(b._drawTimer);b._drawTimer=null;b.sourceLayer._getRenderer().isInstanceOf(a)&&b.recalculateHeatmap()},16)}},_removeRenderer:function(a){var b=a.target;b._draw=
b._originalDraw;delete b._originalDraw;b.setDrawMode(!0);this._removeHandlers();this._hndls=[];var c=this._getImageBySourceId(this.sourceLayer.id);c&&this.imageLayer.removeImage(c);clearTimeout(this._drawTimer);clearTimeout(this._resetTimer);this._drawTimer=this._resetTimer=null;b.renderer!=a.renderer&&b.renderer.getRendererInfo?this.heatmapRenderer=null:(b.redraw(),this.destroy())},recalculateHeatmap:function(){this._calculator?this._doMainCalculation():this._calculatorClient&&this._doWorkerCalculation()},
_reprojectFeature:function(a){if(a&&a.geometry){var b=a.geometry,c=this.map.spatialReference;c.equals(b.spatialReference)||(b=d.project(b,c),null==b?console.log("Unable to reproject features to map's spatial reference. Please convert feature geometry before adding to layer"):a.geometry=b)}},_doWorkerCalculation:function(){},_doMainCalculation:function(){var a=this.sourceLayer,b=this.map,d=this.heatmapRenderer,l=this.map.extent,w=this.map.width,k=this.map.height,h=this._calculator,u=this,f=function(e){e=
u._getScreenPoints(e.features,b,a);e=h.calculateImageData(q.mixin({screenPoints:e,mapinfo:{extent:[l.xmin,l.ymin,l.xmax,l.ymax],resolution:b.getResolution()},width:w,height:k},u._getOptions()));e=d.getSymbol(t({geometry:b.extent,attributes:{size:[w,k],imageData:e},layer:a}));e=new c({extent:b.extent,href:e.url,opacity:0,sourceId:a.id});u._swapMapImages(e,u._getImageBySourceId(a.id));a.suspended&&e.hide()},r={geometry:b.extent,timeExtent:a.useMapTime?b.timeExtent:void 0,spatialRelationship:e.SPATIAL_REL_INTERSECTS};
null!=a._canDoClientSideQuery(r)?a.queryFeatures(r,f):f({features:a.graphics})},_getScreenPoints:function(a,b,c){var d=[],e=a.length,l=0,t=0,h,u=new k(b.extent.xmin,b.extent.ymax,b.spatialReference),r=b.toScreen(u),n=r.x,r=r.y,q=b.getResolution(),m;for((t=b.extent.getCacheValue("_parts"))&&(m=f.map(t,function(a){return c._intersects(b,a.extent)[0]}));e--;)t=a[e],t.geometry&&(h={x:Math.ceil((t.geometry.x-u.x)/q+n),y:Math.floor((u.y-t.geometry.y)/q-r),attributes:t.attributes},m&&(t=1<m.length&&h.x<
-m[0]?m[1]:m[0],h.x+=t),d[l++]=h);return d},_getImageBySourceId:function(a){var b=this.imageLayer.getImages(),b=f.filter(b,function(b){return b.sourceId==a});if(b.length)return b[b.length-1]},_swapMapImages:function(a,b){function c(){d.removeImage(b)}var d=this.imageLayer,e=this.sourceLayer.opacity||1;d.addImage(a);l.anim(a._node,{opacity:e},null,null,function(){a.opacity=e});null!=b&&l.anim(b._node,{opacity:0},null,null,c)},_removeHandlers:function(){if(null!=this._hndls)for(var a=this._hndls.length;a--;)this._hndls[a].remove()},
_getOptions:function(){var a=this.heatmapRenderer;return{blurRadius:a.blurRadius,gradient:a.gradient,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity,field:a.field,fieldOffset:a.fieldOffset}},_resetGraphics:function(){clearTimeout(this._resetTimer);this._resetTimer=null;for(var a=this.sourceLayer.graphics,b=a.length,c;b--;)c=a[b],c._shape=c._offsets=void 0}});r("extend-esri")&&q.setObject("layers.HeatmapManager",m,h);return m})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),
function(m,q,b,f,n,h,r){h.extend(m,{waiRole:"",waiState:""});return n("dijit._Templated",[q,b],{widgetsInTemplate:!1,constructor:function(){r.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0")},_processNode:function(b,d){var c=this.inherited(arguments),a=d(b,"waiRole");a&&b.setAttribute("role",a);(a=d(b,"waiState"))&&f.forEach(a.split(/\s*,\s*/),function(a){-1!=a.indexOf("-")&&(a=a.split("-"),b.setAttribute("aria-"+
a[0],a[1]))});return c}})})},"esri/ImageSpatialReference":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./lang ./SpatialReference".split(" "),function(m,q,b,f,n,h){m=m(h,{declaredClass:"esri.ImageSpatialReference",constructor:function(b){b&&(q.isObject(b)&&q.mixin(this,b),this.url||console.error("ImageSpatialReference: must provide image service URL."))},icsid:null,ics:null,_isWebMercator:function(){return!1},_isWrappable:function(){return!1},equals:function(b){var k=!1;
b&&(this.icsid&&b.icsid?k=this.icsid===b.icsid:this.ics&&b.ics&&(k=this.ics===b.ics));return k},toJson:function(b){var k=null,d=n.isDefined;b=d(b)?b:!0;d(this.icsid)?k={icsid:this.icsid}:d(this.ics)&&(k={ics:this.ics});d(this.url)&&(d(k)&&b)&&(k.url=this.url);return k}});b("extend-esri")&&(f.ImageSpatialReference=m);return m})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e){q=q("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);m.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,h.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(c){b=b.concat(m.map(b,function(a){return a+c}),"dijit"+c)}var b=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var c="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(c);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var c=this.stateNode||this.domNode,d={};m.forEach(c.className.split(" "),function(a){d[a]=!0});"_stateClasses"in this&&m.forEach(this._stateClasses,function(a){delete d[a]});m.forEach(b,
function(a){d[a]=!0});var g=[],e;for(e in d)g.push(e);c.className=g.join(" ");this._stateClasses=b},_subnodeCssMouseEvent:function(a,b,c){function d(c){f.toggle(a,b+"Active",c)}if(!this.disabled&&!this.readOnly)switch(c.type){case "mouseover":case "MSPointerOver":case "pointerover":f.toggle(a,b+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":f.toggle(a,b+"Hover",!1);d(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":d(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":d(!1);break;case "focus":case "focusin":f.toggle(a,b+"Focused",!0);break;case "blur":case "focusout":f.toggle(a,b+"Focused",!1)}},_trackMouseState:function(a,b){a._cssState=b}});k(function(){function l(a,c,d){if(!d||!b.isDescendant(d,c))for(;c&&c!=d;c=c.parentNode)if(c._cssState){var l=e.getEnclosingWidget(c);l&&(c==l.domNode?l._cssMouseEvent(a):l._subnodeCssMouseEvent(c,c._cssState,a))}}var k=c.body(),t;r(k,
d.over,function(a){l(a,a.target,a.relatedTarget)});r(k,d.out,function(a){l(a,a.target,a.relatedTarget)});r(k,a.press,function(a){t=a.target;l(a,t)});r(k,a.release,function(a){l(a,t);t=null});r(k,"focusin, focusout",function(a){var b=a.target;if(b._cssState&&!b.getAttribute("widgetId")){var c=e.getEnclosingWidget(b);c&&c._subnodeCssMouseEvent(b,b._cssState,a)}})});return q})},"esri/layers/agscommon":function(){define("./ArcGISMapServiceLayer ./LayerInfo ./TimeInfo ./LayerTimeOptions ./TimeReference ./Field ./Domain ./RangeDomain ./CodedValueDomain ./InheritedDomain ./LayerSource ./LayerMapSource ./LayerDataSource ./DataSource ./TableDataSource ./QueryDataSource ./JoinDataSource ./RasterDataSource ./DynamicLayerInfo ./LayerDrawingOptions ../geometry ../utils".split(" "),
function(){return{}})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),function(m,q,b,f,n,h,r,k,d,c,a,e){var l=m("dijit.DialogUnderlay",[k,d],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"",
"class":"",_modalConnects:[],_setDialogIdAttr:function(a){f.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.own(h(this.domNode,"keydown",q.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,b=this.domNode.style;b.display="none";var c=r.getBox(this.ownerDocument);b.top=c.t+"px";
b.left=c.l+"px";a.width=c.w+"px";a.height=c.h+"px";b.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new c(this.domNode);var b=r.get(this.ownerDocument);this._modalConnects=[a.on("resize",q.hitch(this,"layout")),h(b,"scroll",q.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();
this.inherited(arguments)},_onKeyDown:function(){}});l.show=function(a,b){var c=l._singleton;!c||c._destroyed?c=e._underlay=l._singleton=new l(a):a&&c.set(a);n.set(c.domNode,"zIndex",b);c.open||c.show()};l.hide=function(){var a=l._singleton;a&&!a._destroyed&&a.hide()};return l})},"esri/layers/gfxSniff":function(){define(["dojo/has","dojox/gfx"],function(m,q){m.add("esri-svg",function(){return-1!==q.renderer.toLowerCase().indexOf("svg")});return m})},"esri/TimeExtent":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","./kernel"],function(m,q,b,f){var n=m(null,{declaredClass:"esri.TimeExtent",constructor:function(b){if(1<arguments.length)this._create(arguments[0],arguments[1]);else if(b)if(q.isArray(b)){var f=b[0],k=b[1];this.startTime=null===f||"null"===f?null:new Date(f);this.endTime=null===k||"null"===k?null:new Date(k)}else b instanceof Date&&this._create(b,null)},offset:function(b,f){var k=new n,d=this.startTime,c=this.endTime;d&&(k.startTime=this._getOffsettedDate(d,b,f));c&&
(k.endTime=this._getOffsettedDate(c,b,f));return k},intersection:function(b){return this._intersection(this,b)},toJson:function(){var b=[],f=this.startTime;b.push(f?f.getTime():"null");f=this.endTime;b.push(f?f.getTime():"null");return b},_create:function(b,f){this.startTime=b?new Date(b.getTime()):null;this.endTime=f?new Date(f.getTime()):null},_refData:{esriTimeUnitsMilliseconds:{getter:"getUTCMilliseconds",setter:"setUTCMilliseconds",multiplier:1},esriTimeUnitsSeconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",
multiplier:1},esriTimeUnitsMinutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},esriTimeUnitsHours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},esriTimeUnitsDays:{getter:"getUTCDate",setter:"setUTCDate",multiplier:1},esriTimeUnitsWeeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},esriTimeUnitsMonths:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},esriTimeUnitsYears:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},esriTimeUnitsDecades:{getter:"getUTCFullYear",
setter:"setUTCFullYear",multiplier:10},esriTimeUnitsCenturies:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:100}},_intersection:function(b,f){if(b&&f){var k=b.startTime,d=b.endTime,c=f.startTime,a=f.endTime,k=k?k.getTime():-Infinity,c=c?c.getTime():-Infinity,d=d?d.getTime():Infinity,a=a?a.getTime():Infinity,e,l;c>=k&&c<=d?e=c:k>=c&&k<=a&&(e=k);d>=c&&d<=a?l=d:a>=k&&a<=d&&(l=a);if(!isNaN(e)&&!isNaN(l))return k=new n,k.startTime=-Infinity===e?null:new Date(e),k.endTime=Infinity===l?null:
new Date(l),k}return null},_getOffsettedDate:function(b,f,k){var d=this._refData;b=new Date(b.getTime());f&&k&&(d=d[k],b[d.setter](b[d.getter]()+f*d.multiplier));return b}});b("extend-esri")&&(f.TimeExtent=n);return n})},"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!esri/nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e,l,u){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(b,d,g,e){var l=this._oAuthDfd=new k;l.resUrl_=b;l.sinfo_=d;l.oinfo_=g;var w=!e||!1!==e.oAuthPopupConfirmation;if(!g.popup||!w)return this._doOAuthSignIn(b,d,g),l;this._nls||(this._nls=a.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());b=this.oAuthDialog;d=e&&e.error;e=e&&e.token;q.hide(b.errMsg_);d&&(403==d.code&&e)&&(c.set(b.errMsg_,"innerHTML",this._nls.forbidden),q.show(b.errMsg_));b.show();
return l},setOAuthResponseHash:function(a){var b=this._oAuthDfd;this._oAuthDfd=null;if(b&&a)if(clearInterval(this._oAuthIntervalId),"#"===a.charAt(0)&&(a=a.substring(1)),a=e.queryToObject(a),a.error)a=Error("access_denied"===a.error?"ABORTED":"OAuth: "+a.error+" - "+a.error_description),a.code="IdentityManagerBase.2",a.log=r.isDebug,b.errback(a);else{var c=b.oinfo_._oAuthCred,d=new m({userId:a.username,server:b.sinfo_.server,token:a.access_token,expires:(new Date).getTime()+1E3*Number(a.expires_in),
ssl:"true"===a.ssl,_oAuthCred:c});c.storage=a.persist?window.localStorage:window.sessionStorage;c.token=d.token;c.expires=d.expires;c.userId=d.userId;c.ssl=d.ssl;c.save();b.callback(d)}},_createOAuthDialog:function(){var a=this._nls,c=b.substitute(a,this._oAuthDialogContent),g=new n({title:a.title,content:c,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=g.esriIdMgr_._oAuthDfd;g.hide_();g.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=
g.esriIdMgr_._oAuthDfd;g.esriIdMgr_._oAuthDfd=null;g.hide_();var b=Error("ABORTED");b.code="IdentityManager.2";b.log=r.isDebug;a.errback(b)},hide_:function(){q.hide(g.errMsg_);g.hide();n._DialogLevelManager.hide(g)}}),a=g.domNode;g.btnSubmit_=h.byNode(d.query(".esriIdSubmit",a)[0]);g.btnCancel_=h.byNode(d.query(".esriIdCancel",a)[0]);g.errMsg_=d.query(".esriErrorMsg",a)[0];g.connect(g.btnSubmit_,"onClick",g.execute_);g.connect(g.btnCancel_,"onClick",g.onCancel);g.connect(g,"onCancel",g.cancel_);return g},
_doOAuthSignIn:function(a,b,c){var d=this,v={client_id:c.appId,response_type:"token",state:u.stringify({portalUrl:c.portalUrl}),expiration:c.expiration,locale:c.locale,redirect_uri:c.popup?f.getAbsoluteUrl(c.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};c.forceLogin&&(v.force_login=!0);c.showSocialLogins&&(v.showSocialLogins=!0);var w=c.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",k=w+"?"+e.objectToQuery(v);if(c.popup){var h;7===l("ie")?(h=window.open(c.popupCallbackUrl,
"esriJSAPIOAuth",c.popupWindowFeatures),h.location=k):h=window.open(k,"esriJSAPIOAuth",c.popupWindowFeatures);h?(h.focus(),this._oAuthDfd.oAuthWin_=h,this._oAuthIntervalId=setInterval(function(){if(h.closed){clearInterval(d._oAuthIntervalId);var a=d._oAuthDfd;if(a){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=r.isDebug;a.errback(b)}}},500)):(a=Error("ABORTED"),a.code="IdentityManager.2",a.log=r.isDebug,this._oAuthDfd.errback(a))}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:v,
authorizeUrl:w,resourceUrl:a,serverInfo:b,oAuthInfo:c}):window.location=k}}})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(m,q,b,f){m=m(f.Credential,{});q("extend-esri")&&(b.Credential=m);return m})},"esri/symbols/FillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./Symbol ./SimpleLineSymbol".split(" "),function(m,q,b,f,n,h){m=m(n,{declaredClass:"esri.symbol.FillSymbol",constructor:function(b){b&&
(q.isObject(b)&&b.outline)&&(this.outline=new h(b.outline))},setOutline:function(b){this.outline=b;return this},toJson:function(){var b=this.inherited("toJson",arguments);this.outline&&(b.outline=this.outline.toJson());return b}});b("extend-esri")&&q.setObject("symbol.FillSymbol",m,f);return m})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),function(m,q,b,f,n,h,r){function k(c,a,d,l){var k=h.getEffectiveBox(c.ownerDocument);
(!c.parentNode||"body"!=String(c.parentNode.tagName).toLowerCase())&&n.body(c.ownerDocument).appendChild(c);var t=null;m.some(a,function(a){var b=a.corner,g=a.pos,p=0,f={w:{L:k.l+k.w-g.x,R:g.x-k.l,M:k.w}[b.charAt(1)],h:{T:k.t+k.h-g.y,B:g.y-k.t,M:k.h}[b.charAt(0)]},h=c.style;h.left=h.right="auto";d&&(p=d(c,a.aroundCorner,b,f,l),p="undefined"==typeof p?0:p);var n=c.style,r=n.display,m=n.visibility;"none"==n.display&&(n.visibility="hidden",n.display="");h=q.position(c);n.display=r;n.visibility=m;r={L:g.x,
R:g.x-h.w,M:Math.max(k.l,Math.min(k.l+k.w,g.x+(h.w>>1))-h.w)}[b.charAt(1)];m={T:g.y,B:g.y-h.h,M:Math.max(k.t,Math.min(k.t+k.h,g.y+(h.h>>1))-h.h)}[b.charAt(0)];g=Math.max(k.l,r);n=Math.max(k.t,m);r=Math.min(k.l+k.w,r+h.w);m=Math.min(k.t+k.h,m+h.h);r-=g;m-=n;p+=h.w-r+(h.h-m);if(null==t||p<t.overflow)t={corner:b,aroundCorner:a.aroundCorner,x:g,y:n,w:r,h:m,overflow:p,spaceAvailable:f};return!p});t.overflow&&d&&d(c,t.aroundCorner,t.corner,t.spaceAvailable,l);a=t.y;var p=t.x,g=n.body(c.ownerDocument);/relative|absolute/.test(b.get(g,
"position"))&&(a-=b.get(g,"marginTop"),p-=b.get(g,"marginLeft"));g=c.style;g.top=a+"px";g.left=p+"px";g.right="auto";return t}var d={TL:"BR",TR:"BL",BL:"TR",BR:"TL"};return r.place={at:function(b,a,e,l,h){e=m.map(e,function(b){var c={corner:b,aroundCorner:d[b],pos:{x:a.x,y:a.y}};l&&(c.pos.x+="L"==b.charAt(1)?l.x:-l.x,c.pos.y+="T"==b.charAt(0)?l.y:-l.y);return c});return k(b,e,h)},around:function(c,a,d,l,h){function t(a,b){E.push({aroundCorner:a,corner:b,pos:{x:{L:r,R:r+D,M:r+(D>>1)}[a.charAt(1)],
y:{T:x,B:x+K,M:x+(K>>1)}[a.charAt(0)]}})}var p;if("string"==typeof a||"offsetWidth"in a||"ownerSVGElement"in a){if(p=q.position(a,!0),/^(above|below)/.test(d[0])){var g=q.getBorderExtents(a),s=a.firstChild?q.getBorderExtents(a.firstChild):{t:0,l:0,b:0,r:0},v=q.getBorderExtents(c),w=c.firstChild?q.getBorderExtents(c.firstChild):{t:0,l:0,b:0,r:0};p.y+=Math.min(g.t+s.t,v.t+w.t);p.h-=Math.min(g.t+s.t,v.t+w.t)+Math.min(g.b+s.b,v.b+w.b)}}else p=a;if(a.parentNode){g="absolute"==b.getComputedStyle(a).position;
for(a=a.parentNode;a&&1==a.nodeType&&"BODY"!=a.nodeName;){s=q.position(a,!0);v=b.getComputedStyle(a);/relative|absolute/.test(v.position)&&(g=!1);if(!g&&/hidden|auto|scroll/.test(v.overflow)){var w=Math.min(p.y+p.h,s.y+s.h),n=Math.min(p.x+p.w,s.x+s.w);p.x=Math.max(p.x,s.x);p.y=Math.max(p.y,s.y);p.h=w-p.y;p.w=n-p.x}"absolute"==v.position&&(g=!0);a=a.parentNode}}var r=p.x,x=p.y,D="w"in p?p.w:p.w=p.width,K="h"in p?p.h:(f.deprecated("place.around: dijit/place.__Rectangle: { x:"+r+", y:"+x+", height:"+
p.height+", width:"+D+" } has been deprecated.  Please use { x:"+r+", y:"+x+", h:"+p.height+", w:"+D+" }","","2.0"),p.h=p.height),E=[];m.forEach(d,function(a){var b=l;switch(a){case "above-centered":t("TM","BM");break;case "below-centered":t("BM","TM");break;case "after-centered":b=!b;case "before-centered":t(b?"ML":"MR",b?"MR":"ML");break;case "after":b=!b;case "before":t(b?"TL":"TR",b?"TR":"TL");t(b?"BL":"BR",b?"BR":"BL");break;case "below-alt":b=!b;case "below":t(b?"BL":"BR",b?"TL":"TR");t(b?"BR":
"BL",b?"TR":"TL");break;case "above-alt":b=!b;case "above":t(b?"TL":"TR",b?"BL":"BR");t(b?"TR":"TL",b?"BR":"BL");break;default:t(a.aroundCorner,a.corner)}});c=k(c,E,h,{w:D,h:K});c.aroundNodePos=p;return c}}})},"esri/_coremap":function(){define("require module dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/event dojo/_base/unload dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/sniff dijit/registry dojox/gfx/matrix ./kernel ./config ./basemaps ./lang ./Evented ./fx ./deferredUtils ./tileUtils ./urlUtils ./PluginTarget ./geometry/Point ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils ./layers/GraphicsLayer ./layers/TileInfo ./layers/LOD ./layers/ArcGISTiledMapServiceLayer ./layers/MapImageLayer ./layers/OpenStreetMapLayer ./layers/VectorTileLayer ./dijit/Popup ./plugins/popupManager dojo/uacss".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e,l,u,t,p,g,s,v,w,y,A,x,D,K,E,C,H,G,J,F,O,N,I,B,R,S,U,V,P,fa,X,sa,da,aa){function ja(a,b){var c=a.lods;c.sort(function(a,b){return a.scale>b.scale?-1:a.scale<b.scale?1:0});var g=[],c=k.filter(c,function(a){if(-1===oa(g,a.scale))return g.push(a.scale),!0}),d=b.lods=[],e;k.forEach(c,function(a,b){e=d[b]=new P(a);e.level=b});b.tileInfo=new V(xa(a,{lods:d}))}var ua,ma=R.toMapPoint,pa=R.toScreenPoint,qa=n.connect,ra=n.disconnect,ca=r.hitch,za=p.set,oa=k.indexOf,xa=r.mixin,
Ca=0,wa=y.defaults.map,va=wa.layerNamePrefix,ya=wa.graphicsLayerNamePrefix,Ba=RegExp("^"+va+"(\\d+)$"),Va=RegExp("^"+ya+"(\\d+)$"),Na=function(){};f=f([D,G],{declaredClass:"esri._CoreMap",resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:'Unable to find basemap definition for: "${basemapName}". Try one of these: ${list}',invalidBasemap:'Unable to add basemap: "${basemapName}".',
unknownLayerType:'Unknown basemap layer type: "${type}" found in basemap definition for: "${basemapName}".',visible:!0,_eventMap:{"basemap-change":!0,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":!0,"layers-reordered":["layerIds"],load:["map"],pan:["extent","delta"],"pan-end":["extent",
"delta"],"pan-start":["extent","screenPoint"],reposition:["x","y"],resize:["extent","width","height"],scale:["matrix","immediate"],"time-extent-change":["timeExtent"],"before-unload":["map"],unload:["map"],"update-end":["error"],"update-start":!0,zoom:["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],click:!0,"dbl-click":!0,"key-down":!0,"key-up":!0,"mouse-down":!0,"mouse-drag":!0,"mouse-drag-end":!0,"mouse-drag-start":!0,
"mouse-move":!0,"mouse-out":!0,"mouse-over":!0,"mouse-up":!0,"mouse-wheel":!0,"basic-tap":!0,"double-tap":!0,"pinch-end":!0,"pinch-move":!0,"pinch-start":!0,"processed-double-tap":!0,"processed-tap":!0,"swipe-end":!0,"swipe-move":!0,"swipe-start":!0,tap:!0,"two-finger-tap":!0},constructor:function(b,g){var d=this;this.registerConnectEvents();xa(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_layerSize:0,_connects:[],_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,
_cursor:null,_ratioW:1,_ratioH:1,_params:null,cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,_labels:null,loaded:!1,__panning:!1,__zooming:!1,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null,_rids:[]});var p=this.container=a.byId(b),w=this.id=e.get(p,"id")||s.getUniqueId(this.declaredClass);l.add(p,"map");var k=t.getContentBox(p),v=l.add,h=u.create;this.position=new F(0,0);this._reposition();var f=this.width=0<k.w?k.w:wa.width,n=this.height=0<
k.h?k.h:wa.height,r=this.root=h("div",{id:w+"_root",style:{width:f+"px",height:n+"px",direction:"ltr"}});v(r,"esriMapContainer");k=this.__container=h("div",{id:w+"_container"},r);za(k,"position","absolute");v(k,"esriMapContainer");p.appendChild(r);p=this._params=xa({slider:!0,nav:!1,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:!0,displayGraphicsOnPan:!0,wrapAround180:!0,fitExtent:!1,optimizePanAnimation:!0},g||{});this.wrapAround180=p.wrapAround180;this.optimizePanAnimation=
p.optimizePanAnimation;x.isDefined(p.resizeDelay)&&(this.resizeDelay=p.resizeDelay);p.lods&&(ja({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,y:90},spatialReference:{wkid:4326},lods:p.lods},p),this.__tileInfo=p.tileInfo);this.extent=p.extent;this._extentUtil({mapCenter:p.center,targetLevel:p.zoom,targetScale:p.scale});this.__visibleRect=new N(0,0,f,n);this.__visibleDelta=new N(0,0,f,n);w=this._layersDiv=h("div",{id:w+"_layers"});v(w,"esriMapLayers");k.appendChild(w);
this._zoomAnimDiv=h("div",{style:{position:"absolute"}});p.infoWindow?this.infoWindow=p.infoWindow:(v=this.infoWindow=new aa(p.popupOptions,h("div")),v.startup(),v._ootb=!0,za(v.domNode,"zIndex",40));p.showLabels&&(m(["./layers/LabelLayer"],function(a){ua=a;d._createLabelLayer()}),this.on("load",function(){d._createLabelLayer()}));this.addPlugin(this._getAbsMid("./plugins/popupManager"),{enabled:p.showInfoWindowOnClick});this._zoomStartHandler=ca(this,this._zoomStartHandler);this._zoomingHandler=
ca(this,this._zoomingHandler);this._zoomEndHandler=ca(this,this._zoomEndHandler);this._panningHandler=ca(this,this._panningHandler);this._panEndHandler=ca(this,this._panEndHandler);this._endTranslate=ca(this,this._endTranslate);this._timedResize=ca(this,this._timedResize);this._execResize=ca(this,this._execResize);this.resize=ca(this,this.resize);c.addOnWindowUnload(this,this.destroy)},_getAbsMid:function(a){return m.toAbsMid?m.toAbsMid(a):q.id.replace(/\/[^\/]*$/ig,"/")+a},_cleanUp:function(){var a=
this.infoWindow;a&&(a._ootb&&a.destroy?a.destroy():a.unsetMap(this),delete this.infoWindow);ra(this._tsTimeExtentChange_connect);this.removePlugin("./plugins/popupManager");u.destroy(this.root);this.root=null},_addLayer:function(a,b,c){if(a.id){var g=a.id.match(a instanceof U?Va:Ba);g&&g[1]&&(g=Number(g[1]),Ca<=g&&(Ca=g+1))}var d=a.id||(a instanceof U?ya:va)+Ca++;a.id=d;this._layers[d]=a;var e,p;if(b===this.layerIds||b===this.graphicsLayerIds)e=this._layerSize,this._layerSize++;a._isRefLayer="top"===
c;c=!x.isDefined(c)||0>c||c>b.length||"top"===c?b.length:c;0===e&&(this._firstLayerId=d);if(!a._isRefLayer)for(;(p=this.getLayer(b[c-1]))&&p._isRefLayer;)c--;b.splice(c,0,d);var l=ca(this,this._addLayerHandler),s=this;c=this._connects;g=function(){a.loaded?s._onLoadFix?(s._onLoadFix=!1,setTimeout(function(){l(a)},0)):l(a):(s["_"+d+"_addtoken_load"]=qa(a,"onLoad",s,"_addLayerHandler"),s["_"+d+"_addtoken_err"]=qa(a,"onError",s,function(c){l(a,c,b)}))};this.loaded||0===e||a.loaded&&-1===oa(this.graphicsLayerIds,
d)?g():c.push(qa(this,"onLoad",g));return a},_addLayerHandler:function(a,b,c){var g=this.id,d=a.id,e=oa(a instanceof U?this.graphicsLayerIds:this.layerIds,d),p=e,l=!1,s=this._params;ra(this["_"+d+"_addtoken_load"]);ra(this["_"+d+"_addtoken_err"]);if(b)delete this._layers[d],-1!==e&&(c.splice(e,1),this.onLayerAddResult(a,b));else{-1===e&&(e=oa(this._internalLayerIds,d),p=20+e,l=!0);if(d===this._firstLayerId){b=a.spatialReference;if((c=this.extent&&this.extent.spatialReference)&&!c.equals(b)&&(a.tileInfo||
!a.url))c=null;c=this.spatialReference=c||b;this.wrapAround180=this.wrapAround180&&c&&c._isWrappable()?!0:!1;a.tileInfo&&(this.__tileInfo?(b=this.__tileInfo.lods,this.__tileInfo=xa({},a.tileInfo),this.__tileInfo.lods=b):(ja(xa({},a.tileInfo),s),this.__tileInfo=s.tileInfo));if(this.wrapAround180){b=this.__tileInfo;c=c._getInfo();if(!b||Math.abs(c.origin[0]-b.origin.x)>c.dx)this.wrapAround180=!1;this.wrapAround180&&b&&C._addFrameInfo(b,c)}s.units=a.units;if((b=this.__tileInfo&&this.__tileInfo.lods)&&
b.length){c=s.minScale;var e=s.maxScale,t=-1,w=-1,k=!1,v=!1,h;for(h=0;h<b.length;h++)0<c&&(!k&&c>=b[h].scale)&&(t=b[h].level,k=!0),0<e&&(!v&&e>=b[h].scale)&&(w=0<h?b[h-1].level:-1,v=!0);-1===s.minZoom&&(s.minZoom=0===c?b[0].level:t);-1===s.maxZoom&&(s.maxZoom=0===e?b[b.length-1].level:w);for(h=0;h<b.length;h++)s.minZoom===b[h].level&&(s.minScale=b[h].scale),s.maxZoom===b[h].level&&(s.maxScale=b[h].scale)}else s.minZoom=s.maxZoom=s.zoom=-1}a instanceof U?(this._gc||(this._gc=new U._GraphicsContainer,
this._gc._setMap(this,this._layersDiv).id=g+"_gc"),p=a._setMap(this,this._gc._surface),p.id=g+"_"+d,this._layerDivs[d]=p,this._reorderLayers(this.graphicsLayerIds)):(p=a._setMap(this,this._layersDiv,p,this.__LOD),p.id=g+"_"+d,this._layerDivs[d]=p,this._reorderLayers(this.layerIds),!l&&-1!==a.declaredClass.indexOf("VETiledLayer")&&this._onBingLayerAdd(a));d===this._firstLayerId&&(this.graphics=new U({id:g+"_graphics",displayOnPan:s.displayGraphicsOnPan}),this._addLayer(this.graphics,this._internalLayerIds,
20));if(a===this.graphics){c=this._layers[this._firstLayerId];g=s.zoom;p=s.scale;b=s.center;c=c.initialExtent||c.fullExtent;this._firstLayerId=null;this.extent&&(this.extent=this._convertGeometry(this,this.extent));!this.extent&&c&&(b&&(b=this._convertGeometry(c,b)),b&&(c=c.centerAt(b)));if(b=this.extent||c&&new O(c.toJson()))-1<g?b=this.__getExtentForLevel(g,null,b).extent:0<p&&(b=B.getExtentForScale(this,p,b));if(!b){console.log("Map: "+this.invalidExtent);return}s=this._fixExtent(b,s.fitExtent);
this.extent=s.extent;this.__LOD=s.lod;this.__setExtent(this.extent);this.loaded=!0;this.attr("data-loaded","");this.infoWindow.setMap(this);this.onLoad(this)}l||(this.onLayerAdd(a),this.onLayerAddResult(a));ra(this[d+"_addLayerHandler_connect"])}},_convertGeometry:function(a,b){var c=a&&a.spatialReference,g=b&&b.spatialReference;c&&(g&&!c.equals(g))&&(c._canProject(g)?c.isWebMercator()?b=S.geographicToWebMercator(b):4326===c.wkid&&(b=S.webMercatorToGeographic(b,!0)):(console.log("Map: "+x.substitute({geometry:g.wkid||
g.wkt,map:c.wkid||c.wkt},this.invalidGeometry)),b=null));return b},_reorderLayers:function(a){var b=this.onLayerReorder,c=u.place,d=this._layerDivs,e=this._layers,p=this._gc?this._gc._surface.getEventSource():null;if(a===this.graphicsLayerIds)k.forEach(a,function(a,g){var l=d[a];l&&(c(l.getEventSource(),p,g),b(e[a],g))});else{var l=this.graphics,s=l?l.id:null,t=this._layersDiv,w;k.forEach(a,function(a,g){w=d[a];a!==s&&w&&(c(w,t,g),b(e[a],g))});this._mapImageLyr&&this._placeMapImageLyr();p&&(p=9>g("ie")?
p.parentNode:p,c(p,p.parentNode,a.length))}this.onLayersReordered([].concat(a))},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,this._zoomAnimDiv.anchor)},_zoomingHandler:function(a){var b=parseFloat(a.left),c=parseFloat(a.top);a=new O(b,c-parseFloat(a.height),b+parseFloat(a.width),c,this.spatialReference);b=this.extent.getWidth()/a.getWidth();this.__zoom(a,b,this._zoomAnimDiv.anchor)},_zoomEndHandler:function(){var a=this._zoomAnimDiv,b=a.extent,c=this.extent.getWidth()/
b.getWidth(),g=a.anchor,d=a.newLod,e=a.levelChange;a.extent=a.anchor=a.levelChange=a.startingExtent=a.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(b,c,g,d,e)},_panningHandler:function(a){if(isNaN(parseFloat(a.left))||isNaN(parseFloat(a.top))){var b=Math.round,c=this._panAnim.node;a.left=-1*(this._delta.x-b(this.width/2))+"px";a.top=-1*(this._delta.y-b(this.height/2))+"px";p.set(c,"left",a.left);p.set(c,"top",a.top)}a=new F(parseFloat(a.left),parseFloat(a.top));b=this.toMap(a);this.onPan(this.extent.offset(this.extent.xmin-
b.x,this.extent.ymax-b.y),a)},_panEndHandler:function(a){this.__panning=!1;var b=Math.round;a=new F(-b(parseFloat(a.style.left)),-b(parseFloat(a.style.top)));var b=a.x,c=a.y,g=this.__visibleRect,d=this.__visibleDelta;g.x+=-b;g.y+=-c;d.x+=-b;d.y+=-c;za(this._zoomAnimDiv,{left:"0px",top:"0px"});var g=this.extent,d=this._ratioW,e=this._ratioH,g=new O(g.xmin+b/d,g.ymin-c/e,g.xmax+b/d,g.ymax-c/e,this.spatialReference);a.setX(-a.x);a.setY(-a.y);this._delta=this._panAnim=null;this._updateExtent(g);this.onPanEnd(g,
a);this._fireExtChg([g,a,!1,this.__LOD])},_fixExtent:function(a,b){for(var c=this._reshapeExtent(a),g=1.25;!0===b&&(c.extent.getWidth()<a.getWidth()||c.extent.getHeight()<a.getHeight())&&0<c.lod.level&&3>=g;)c=this._reshapeExtent(a.expand(g)),g+=0.25;return c},_getFrameWidth:function(){var a=-1,b=this.spatialReference._getInfo();this.__LOD?(b=this.__LOD._frameInfo)&&(a=b[3]):b&&(a=Math.round(2*b.valid[1]/(this.extent.getWidth()/this.width)));return a},_fixAspectRatio:function(a){var b=a.getWidth(),
c=a.getHeight(),g=b/c,d=this.width/this.height,e=0,p=0;this.width>this.height?b>c?d>g?e=c*d-b:p=b/d-c:e=c*d-b:this.width<this.height?b<c?d>g?e=c*d-b:p=b/d-c:p=b/d-c:b<c?e=c-b:b>c&&(p=b/d-c);e&&(a.xmin-=e/2,a.xmax+=e/2);p&&(a.ymin-=p/2,a.ymax+=p/2);return a},_reshapeExtent:function(a){a=this._fixAspectRatio(a);return this._getAdjustedExtent(a)},_getAdjustedExtent:function(a){if(this.__tileInfo)return C.getCandidateTileInfo(this,this.__tileInfo,a);var b=B.getScale(this,a),c=this.getMinScale(),g=this.getMaxScale(),
d=!g||b>=g;c&&!(b<=c)?a=B.getExtentForScale(this,c,a):d||(a=B.getExtentForScale(this,g,a));return{extent:a}},_onBingLayerAdd:function(a){this["__"+a.id+"_vis_connect"]=n.connect(a,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(a.visible)},_onBingLayerRemove:function(a){n.disconnect(this["__"+a.id+"_vis_connect"]);delete this["__"+a.id+"_vis_connect"];var b=k.some(this.layerIds,function(b){return(a=this._layers[b])&&a.visible&&-1!==a.declaredClass.indexOf("VETiledLayer")},this);
this._toggleBingLogo(b)},_toggleBingLogo:function(a){a&&!this._bingLogo?(a={left:this._mapParams&&this._mapParams.nav?"25px":""},6===g("ie")&&(a.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+m.toUrl("./images/map/bing-logo-lg.png")+"')"),a=this._bingLogo=u.create("div",{style:a},this.root),l.add(a,"bingLogo-lg")):!a&&this._bingLogo&&(u.destroy(this._bingLogo),delete this._bingLogo)},__panStart:function(a,b){var c=this._zoomAnim,g=this._panAnim;
if(c&&c._active)c.stop(),c._fire("onEnd",[c.node]);else if(g&&g._active){g.stop();this._panAnim=null;var g=g.curve.getValue(g._getStep()),c=Math.round(parseFloat(g.left)),g=Math.round(parseFloat(g.top)),d=this.navigationManager._dragOrigin;this.__pan(c,g);d&&(d.x-=c,d.y-=g);return}this.__panning=!0;this.onPanStart(this.extent,new F(a,b))},__pan:function(a,b){var c=this.extent,g=this._ratioW,d=this._ratioH;this.onPan(new O(c.xmin-a/g,c.ymin+b/d,c.xmax-a/g,c.ymax+b/d,this.spatialReference),new F(a,
b))},__panEnd:function(a,b){var c=this.__visibleRect,g=this.__visibleDelta;c.x+=a;c.y+=b;g.x+=a;g.y+=b;var c=new F(a,b),g=this.extent,d=this._ratioW,e=this._ratioH,g=new O(g.xmin-a/d,g.ymin+b/e,g.xmax-a/d,g.ymax+b/e,this.spatialReference);this.__panning=!1;this._updateExtent(g);this.onPanEnd(g,c);this._fireExtChg([g,c,!1,this.__LOD])},__zoomStart:function(a,b){this.__zooming=!0;this.onZoomStart(a,1,b,this.__LOD?this.__LOD.level:null)},__zoom:function(a,b,c){this.onZoom(a,b,c)},__zoomEnd:function(a,
b,c,g,d){za(this._layersDiv,{left:"0px",top:"0px"});this._delta=new F(0,0);this.__visibleRect.x=this.__visibleRect.y=0;a=new O(a);this.__LOD=g;this._ratioW=this.width/a.getWidth();this._ratioH=this.height/a.getHeight();var e=this._delta;this._delta=null;this.__zooming=!1;this._updateExtent(a,d);this.onZoomEnd(a,b,c,g?g.level:null);this._fireExtChg([a,e,d,g])},_extentUtil:function(a,b,c,g,d){var e=new h,p,l,s,t,w,k,v,f,n,u,q=this.width,m=this.height,A,y,C;a&&(p=a.numLevels,l=a.targetLevel,A=x.isDefined(l),
s=a.factor,t=a.mapAnchor,w=a.screenAnchor,k=a.mapCenter,y=a.levelOrFactor,v=a.targetScale,f=x.isDefined(v)&&0<v);b&&(n=b.dx,u=b.dy,k=b.mapCenter);r.isArray(k)&&(k=new J(k));var H=this._panAnim;b=(a=this._stopAnim())?a.divExtent:this.extent;var G=this.__tileInfo,D=this._params;if(!this.loaded){if(c)b&&(c=this._convertGeometry(b,c)),c&&(this.extent=c,D.zoom=D.scale=-1,D.center=null);else if(k||A||f){if(k)if(b){if(k=this._convertGeometry(b,k))this.extent=b.centerAt(k),D.center=null}else D.center=k;A&&
-1<l?(D.zoom=l,D.scale=-1):f&&(D.scale=v,D.zoom=-1)}e.resolve();return e}if(k&&(k=this._convertGeometry(this,k),!k)||t&&(t=this._convertGeometry(this,t),!t)||c&&(c=this._convertGeometry(this,c),!c))return e.reject(),e;H&&(t&&w)&&(t=ma(this.extent,q,m,w));a&&(t&&w)&&(t=ma(a.divExtent,q,m,w));A&&(G?(p=this.getMinZoom(),A=this.getMaxZoom(),l<p?l=p:l>A&&(l=A),p=l-(a?a.level:this.getLevel())):(p=0<l?-1:1,C=y?l:null));if(!c)if(x.isDefined(p))G?(q=a?a.level:this.getLevel(),m=this.__getExtentForLevel(q+p,
k,b).extent):(m=(a?a.end:this.extent).expand(C||(0<p?0.5*p:2*-p)),C&&k&&(m=m.centerAt(k))),m&&(k?c=m:(q=t||b.getCenter(),n=b.ymax-(m.getHeight()-b.getHeight())*(q.y-b.ymax)/b.getHeight(),q=b.xmin-(m.getWidth()-b.getWidth())*(q.x-b.xmin)/b.getWidth(),c=new O(q,n-m.getHeight(),q+m.getWidth(),n,this.spatialReference)));else if(f)c=B.getExtentForScale(this,v,b);else if(x.isDefined(s))c=b.expand(s);else if(n||u)a?(c=a.end,t=c.getCenter(),C=pa(c,q,m,t),C.x+=n,C.y+=u,C=ma(c,q,m,C),c=c.offset(C.x-t.x,C.y-
t.y)):(n=new F(q/2+n,m/2+u),u=ma(b,q,m,n),m=b.getWidth(),n=b.getHeight(),q=u.x-m/2,u=u.y-n/2,c=new O(q,u,q+m,u+n,this.spatialReference));c||(k?(b=a?a.end:b,m=b.getWidth(),n=b.getHeight(),q=k.x-m/2,u=k.y-n/2,c=new O(q,u,q+m,u+n,this.spatialReference)):a&&(c=a.end));c?(this._extentDfd&&-1===this._extentDfd.fired&&(this._extentDfd.then(null,Na),this._extentDfd.reject()),this._extentDfd=e,this.__setExtent(c,null,w,g,a,d)):e.reject();return e},__setExtent:function(a,b,c,d,e,p){try{if(this._firstLayerId)this.extent=
a;else{var l=!0,s=this.spatialReference,t=e?e.divExtent:this.extent,k=this._fixExtent(a,d||!1);a=k.extent;var w=a.getWidth(),v=a.getHeight(),h=Math.round;if(t)var f=h(1E6*t.getWidth()),n=h(1E6*w),u=h(1E6*t.getHeight()),r=h(1E6*v),l=f!==n||u!==r;var q,m,x=e&&e.rect,A=e&&e.divExtent;if(wa.zoomDuration&&l&&t){A=A||new O(t);x=x||{left:t.xmin,top:t.ymax,width:t.getWidth(),height:t.getHeight()};m={left:a.xmin,top:a.ymax,width:w,height:v};var C=new J(a.xmin,a.ymax,s),y=new J(a.xmin,a.ymin,s),H=new J(this.extent.xmin,
this.extent.ymax,s),G=new J(this.extent.xmin,this.extent.ymin,s);q=I.getLineIntersection(H,C,G,y,s);!q&&!e&&(l=!1)}this._ratioW=this.width/w;this._ratioH=this.height/v;var D=this._zoomAnimDiv;if(l)if(za(this._layersDiv,{left:"0px",top:"0px"}),b=new F(0,0),this.__visibleRect.x=this.__visibleRect.y=0,x&&m){this._delta=b;D.id="_zAD";D.startingExtent=A;D.extent=a;D.levelChange=l;D.newLod=k.lod;D.anchor=c?c:!q&&e?e.anchor:pa(this.extent,this.width,this.height,q);var E=this.extent.getWidth()/a.getWidth();
g("chrome")&&1024<(1>E?1/E:E)?(this.__zoomStart(A,D.anchor),this.__zoom(A,1,D.anchor),this._fireOnScale(1,D.anchor,!0),this.__zoomEnd(a,E,D.anchor,k.lod,l)):(this._zoomAnim=K.resize({node:D,start:x,end:m,duration:wa.zoomDuration,rate:wa.zoomRate,beforeBegin:!e?this._zoomStartHandler:null,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play(),this._fireOnScale(E,D.anchor,p))}else this._updateExtent(a,l),this._fireExtChg([this.extent,b,l,this.__LOD=k.lod]);else if(!this.__panning)if(!1===
this.loaded||p)this._updateExtent(a,l),this._fireExtChg([this.extent,b,l,this.__LOD=k.lod]);else{this.__panning=!0;x=(new N(0,0,this.width,this.height,this.spatialReference)).getCenter();x.x=h(x.x);x.y=h(x.y);var B=this._delta=this.toScreen(a.getCenter()),U=Math.abs(x.x-B.x),S=Math.abs(x.y-B.y);this.optimizePanAnimation&&(U>2*this.width||S>2*this.height)?(this.__panStart(0,0),this.__pan(0,0),this.__visibleRect.x=this.__visibleRect.y=this.__visibleDelta.x=this.__visibleDelta.y=0,this.__panning=!1,
this._delta=null,this._updateExtent(a,!1),this.onPanEnd(this.extent,new F(0,0)),this._fireExtChg([this.extent,new F(0,0),!0,this.__LOD])):(this.onPanStart(this.extent,new F(0,0)),this._panAnim=K.slideTo({node:D,left:x.x-B.x,top:x.y-B.y,duration:wa.panDuration,rate:wa.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler}),this._panAnim.play())}}}catch(V){console.log(V.stack),console.error(V)}},_fireOnScale:function(a,b,c){if("css-transforms"===this.navigationMode){var g=this.__visibleDelta;
this.onScale(v.scaleAt(a,{x:-1*(this.width/2-(b.x-g.x)),y:-1*(this.height/2-(b.y-g.y))}),c)}},_stopAnim:function(){var a=this._zoomAnim,b=this._panAnim;if(a&&a._active){a.stop();var b=a.curve.getValue(a._getStep()),c=parseFloat(b.left),g=parseFloat(b.top),a=a.node;return{anchor:a.anchor,start:a.startingExtent,end:a.extent,level:a.newLod&&a.newLod.level,rect:b,divExtent:new O(c,g-parseFloat(b.height),c+parseFloat(b.width),g,this.spatialReference)}}b&&b._active&&(b.stop(),b._fire("onEnd",[b.node]))},
__getExtentForLevel:function(a,b,c){var g=this.__tileInfo,g=g&&g.lods;a=x.isDefined(a)?a:0;c=c||this.extent;b=b||c&&c.getCenter();if(g){if(b){c=this.getMinZoom();var d=this.getMaxZoom();a>d&&(a=d);a<c&&(a=c);a=g[a];g=this.width*a.resolution/2;c=this.height*a.resolution/2;return{extent:new O(b.x-g,b.y-c,b.x+g,b.y+c,b.spatialReference),lod:a}}}else if(c)return{extent:c.expand(!a||1>a?1:a).centerAt(b)};console.log("Map: "+this.invalidExtent)},_jobs:0,_incr:function(){1===++this._jobs&&(this.updating=
!0,this.attr("data-updating",""),this.onUpdateStart())},_decr:function(){var a=--this._jobs;a?0>a&&(this._jobs=0):(this.updating=!1,this.attr("data-updating"),this.onUpdateEnd())},_fireEvent:function(a,b){this[a]&&this[a].apply(this,b)},_updateExtent:function(a,b){this.extent=a;b&&this._setClipRect();var c=this.spatialReference;c&&(c.isWebMercator()?this.geographicExtent=S.webMercatorToGeographic(this._getAvailExtent(),!0):4326===c.wkid&&(this.geographicExtent=new O(this._getAvailExtent().toJson())))},
_fireExtChg:function(a){this.attr("data-zoom",this.getZoom());this.attr("data-scale",this.getScale());this._fireEvent("onExtentChange",a);if(a=this._extentDfd)delete this._extentDfd,a.resolve()},attr:function(a,b){var c=this.container;c&&(null==b?c.removeAttribute(a):c.setAttribute(a,b));return this},onUpdateStart:function(){},onUpdateEnd:function(){},onLoad:function(){this._setClipRect()},onBeforeUnload:function(){},onUnload:function(){},onExtentChange:function(a,b,c){},onTimeExtentChange:function(){},
onLayerAdd:function(){},onLayerAddResult:function(){},onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},onScale:function(){},onZoomStart:function(){},onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect()},onReposition:function(){},destroy:function(){this._destroyed||
(this.onBeforeUnload(this),this.removeAllLayers(),this._cleanUp(),clearTimeout(this._resizeT),this._gc&&this._gc._cleanUp(),this._destroyed=!0,this.onUnload(this))},setCursor:function(a){za(this.__container,"cursor",this.cursor=a)},setMapCursor:function(a){this.setCursor(this._cursor=a)},resetMapCursor:function(){this.setCursor(this._cursor)},setInfoWindow:function(a){var b=this.infoWindow;b&&b.unsetMap(this);this.infoWindow=a;this.loaded&&a&&a.setMap(this)},setInfoWindowOnClick:function(a){this._params.showInfoWindowOnClick=
a;this.popupManager&&this.popupManager.set("enabled",a)},getInfoWindowAnchor:function(a){return this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(a)||"upperright"},toScreen:function(a,b){return pa(this.extent,this.width,this.height,a,b)},toMap:function(a){return ma(this.extent,this.width,this.height,a)},addLayer:function(a,b){a&&!this.getLayer(a.id)&&this._addLayer(a,a instanceof U?this.graphicsLayerIds:this.layerIds,b);return a},addLayers:function(a){var b=[],c=a.length,g,d,
e=a.length;g=n.connect(this,"onLayerAddResult",function(d,e){-1!==k.indexOf(a,d)&&(c--,b.push({layer:d,success:!e,error:e}),c||(n.disconnect(g),this.onLayersAddResult(b)))});for(d=0;d<e;d++)this.addLayer(a[d]);return this},removeLayer:function(a,b){var c=a.id,g=a instanceof U?this.graphicsLayerIds:this.layerIds,d=oa(g,c);0<=d&&(g.splice(d,1),a instanceof U?(ra(this["_gl_"+a.id+"_click_connect"]),a.loaded&&a._unsetMap(this,this._gc._surface)):a.loaded&&(a._unsetMap(this,this._layersDiv),-1!==a.declaredClass.indexOf("VETiledLayer")&&
this._onBingLayerRemove(a)),delete this._layers[c],delete this._layerDivs[c],b||this._reorderLayers(g),this.onLayerRemove(a))},removeAllLayers:function(){var a=this.layerIds,b;for(b=a.length-1;0<=b;b--)this.removeLayer(this._layers[a[b]],1);a=this.graphicsLayerIds;for(b=a.length-1;0<=b;b--)this.removeLayer(this._layers[a[b]],1);this.onLayersRemoved()},reorderLayer:function(a,c){r.isString(a)&&(b.deprecated(this.declaredClass+": Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",
null,"v2.0"),a=this.getLayer(a));var g=a.id,d,e=a instanceof U?this.graphicsLayerIds:this.layerIds;0>c?c=0:c>=e.length&&(c=e.length-1);d=oa(e,g);-1===d||d===c||(e.splice(d,1),e.splice(c,0,g),this._reorderLayers(e))},getLayer:function(a){return this._layers[a]},setExtent:function(a,b){a=new O(a.toJson());var c=a.getWidth(),g=a.getHeight();return 0===c&&0===g?this.centerAt(new J({x:a.xmin,y:a.ymin,spatialReference:a.spatialReference&&a.spatialReference.toJson()})):this._extentUtil(null,null,a,b)},centerAt:function(a){return this._extentUtil(null,
{mapCenter:a})},centerAndZoom:function(a,b){return this._extentUtil({targetLevel:b,mapCenter:a,levelOrFactor:!0})},getScale:function(){return this.__LOD?this.__LOD.scale:B.getScale(this)},getResolution:function(){return this.__LOD?this.__LOD.resolution:this.extent?this.extent.getWidth()/this.width:0},getResolutionInMeters:function(){return this.getResolution()*B.getUnitValueForSR(this.spatialReference)},getMinScale:function(){return this._params.minScale},getMaxScale:function(){return this._params.maxScale},
setScale:function(a){return this._extentUtil({targetScale:a})},getLayersVisibleAtScale:function(a){var b=[];(a=a||this.getScale())&&k.forEach(this.layerIds.concat(this.graphicsLayerIds),function(c){c=this.getLayer(c);c.isVisibleAtScale(a)&&b.push(c)},this);return b},getNumLevels:function(){var a=this.getMinZoom(),b=this.getMaxZoom();return a===b&&0>a?0:b-a+1},getLevel:function(){return this.__LOD?this.__LOD.level:-1},setLevel:function(a){if(-1<a)return this._extentUtil({targetLevel:a})},getZoom:function(){return this.getLevel()},
setZoom:function(a){return this.setLevel(a)},getMinZoom:function(){return this._params.minZoom},getMaxZoom:function(){return this._params.maxZoom},setBasemap:function(a){var b;r.isObject(a)?(b=a,a=b.title):b=A&&A[a];if(b){this._basemapDfd&&-1===this._basemapDfd.fired&&this._basemapDfd.cancel();var c=[],g=[],d=0;k.forEach(b.baseMapLayers||b.layers,function(b){var e,p={id:b.id,displayLevels:b.displayLevels,opacity:x.isDefined(b.opacity)?b.opacity:null,visible:x.isDefined(b.visibility)?b.visibility:
null};if(b.type)switch(b.type){case "OpenStreetMap":e=new sa(p);break;case "VectorTile":e=H._ensureProperProtocolForAGOResource(b.url);e=new da(e,p);break;default:console.log("Map.setBasemap: "+x.substitute({basemapName:a,type:b.type},this.unknownLayerType))}else{e=b.url;if("https:"===window.location.protocol&&(-1!==e.search(/^http\:\/\/server\.arcgisonline\.com/i)||-1!==e.search(/^http\:\/\/services\.arcgisonline\.com/i)||-1!==e.search(/^http\:\/\/.+\.arcgis\.com/i)))e=e.replace(/http:/i,"https:");
e=new fa(e,p)}e&&(c.push(e),g.push(b),b.isReference||d++)},this);if(!c.length||!d)console.log("Map.setBasemap: "+x.substitute({basemapName:a},this.invalidBasemap));else{var e={basemapName:a,infos:g,layers:c};if(this.loaded){var p=this,l=new h(E._dfdCanceller),s=function(a){l._pendingLayers--;a=k.indexOf(e.layers,this);if(-1<a&&(a=l._layerEvents[a]))n.disconnect(a[0]),n.disconnect(a[1]);0>=l._pendingLayers&&(delete l._layerEvents,delete p._basemapDfd,0>l.fired&&l.callback(e))};this._basemapDfd=l;l._pendingLayers=
0;l._layerEvents={};k.forEach(c,function(a,b){a&&(l._pendingLayers++,a.loaded?s(a):l._layerEvents[b]=[n.connect(a,"onLoad",a,s),n.connect(a,"onError",a,s)])});l.addCallback(ca(this,this._basemapLoaded))}else this._basemapLoaded(e)}}else{b=[];for(var t in A)b.push(t);console.log("Map.setBasemap: "+x.substitute({basemapName:a,list:b.join(",")},this.unknownBasemap))}},_basemapLoaded:function(a){var b=a.layers,c=a.infos,g=0,d=!0,e;this.loaded&&(k.forEach(b,function(a,b){a.loaded&&(c[b].isReference||g++)}),
d=g);d&&(this.basemapLayerIds&&(e={basemapName:this._basemap,infos:A&&A[this._basemap]&&A[this._basemap].baseMapLayers},e.basemapName||(k.forEach(this.basemapLayerIds,function(a){if(this.getLayer(a)instanceof sa)return e.basemapName="osm",e.infos=A&&A.osm&&A.osm.baseMapLayers,!1},this),e.basemapName||(e=null))),this._removeBasemap(),this._basemap=a.basemapName,this.basemapLayerIds=this._addBasemap(b,c),this.attr("data-basemap",this.getBasemap()),this.emit("basemap-change",{current:a,previous:e}))},
_addBasemap:function(a,b){var c=[],g=[],d=0;k.forEach(a,function(a,e){b[e].isReference?c.push(a):(this.addLayer(a,d++),g.push(a.id))},this);c.length&&k.forEach(c,function(a){a.attr("data-reference",!0);this.addLayer(a,"top");g.push(a.id)},this);return g},_removeBasemap:function(){var a=this.basemapLayerIds,b;a&&a.length&&k.forEach(a,function(a){(b=this.getLayer(a))&&this.removeLayer(b)},this)},getBasemap:function(){return this._basemap||""},translate:function(a,b){a=a||0;b=b||0;if(!this._txTimer){this._tx=
this._ty=0;var c=this.toScreen(this.extent.getCenter());this.__panStart(c.x,c.y)}this._tx+=a;this._ty+=b;this.__pan(this._tx,this._ty);clearTimeout(this._txTimer);this._txTimer=setTimeout(this._endTranslate,150)},_endTranslate:function(){clearTimeout(this._txTimer);this._txTimer=null;var a=this._tx,b=this._ty;this._tx=this._ty=0;this.__panEnd(a,b)},setTimeExtent:function(a){a=(this.timeExtent=a)?new a.constructor(a.toJson()):null;this.onTimeExtentChange(a)},setTimeSlider:function(a){this.timeSlider&&
(ra(this._tsTimeExtentChange_connect),this.timeSlider=this._tsTimeExtentChange_connect=null);a&&(this.timeSlider=a,this.setTimeExtent(a.getCurrentTimeExtent()),this._tsTimeExtentChange_connect=qa(a,"onTimeExtentChange",this,"setTimeExtent"))},setVisibility:function(a){if(this.visible!==a){this.visible=a;a||(this._display=this.container.style.display);this.container.style.display=a?this._display:"none";if(this.autoResize){var b=a?"resume":"pause";this._rszSignal[b]();this._oriSignal[b]()}a&&this.resize()}return this},
resize:function(a){clearTimeout(this._resizeT);this._destroyed||(!0===a?this._execResize():this._resizeT=setTimeout(this._execResize,this.resizeDelay))},_timedResize:function(){this._resizeT||this._execResize()},_execResize:function(){clearTimeout(this._resizeT);this._resizeT=null;this.reposition();this._resize();this.autoResize&&this._startResizeTimer()},_resize:function(){var a=this.width,b=this.height,c=p.get(this.container,"display"),g=t.getContentBox(this.container);if(!("none"===c||0>=g.w||
0>=g.h||a===g.w&&b===g.h)){if(c=this._zoomAnim||this._panAnim)c.stop(),c._fire("onEnd",[c.node]);za(this.root,{width:(this.width=g.w)+"px",height:(this.height=g.h)+"px"});g=this.width;c=this.height;this.attribution&&this.attribution.domNode&&p.set(this.attribution.domNode,"maxWidth",Math.floor(g*this._mapParams.attributionWidth)+"px");this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,g,c);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,g,c);var d=new N(this.extent),
a=(new N(d.x,d.y,d.width*(g/a),d.height*(c/b),this.spatialReference)).getExtent();this.onResize(a,g,c);this._extentUtil(null,null,a,null,!0)}},reposition:function(){var a=this.position,b=a.x,c=a.y;this._reposition();a=this.position;if(b!==a.x||c!==a.y)this.onReposition(a.x,a.y)},_reposition:function(){var a=t.position(this.container,!0),b=t.getPadBorderExtents(this.container);this.position.update(a.x+b.l,a.y+b.t)},_setClipRect:function(){delete this._clip;var a=7>=g("ie")||void 0===g("ie")&&7<=g("trident")?
"rect(auto,auto,auto,auto)":"auto";if(this.wrapAround180){var b=this.width,c=this.height,d=this._getFrameWidth(),e=b-d;0<e&&(a=e/2,a="rect(0px,"+(a+d)+"px,"+c+"px,"+a+"px)",c=this.extent.getWidth(),b=c*(d/b),this._clip=[(c-b)/2,b])}za(this.__container,"clip",a)},_getAvailExtent:function(){var a=this.extent,b=this._clip;if(b){if(!a._clip){var c=new N(a);c.width=b[1];c.x+=b[0];a._clip=c.getExtent()}return a._clip}return a},_fixedPan:function(a,b){return this._extentUtil(null,{dx:a,dy:b})},panUp:function(){return this._fixedPan(0,
-0.75*this.height)},panUpperRight:function(){return this._fixedPan(0.75*this.width,-0.75*this.height)},panRight:function(){return this._fixedPan(0.75*this.width,0)},panLowerRight:function(){return this._fixedPan(0.75*this.width,0.75*this.height)},panDown:function(){return this._fixedPan(0,0.75*this.height)},panLowerLeft:function(){return this._fixedPan(-0.75*this.width,0.75*this.height)},panLeft:function(){return this._fixedPan(-0.75*this.width,0)},panUpperLeft:function(){return this._fixedPan(-0.75*
this.width,-0.75*this.height)},enableSnapping:function(a){a=a||{};if("esri.SnappingManager"===a.declaredClass)this.snappingManager=a;else{var b=Ca++,c=this;this._rids&&this._rids.push(b);m(["./SnappingManager"],function(g){var d=c._rids?k.indexOf(c._rids,b):-1;-1!==d&&(c._rids.splice(d,1),c.snappingManager=new g(r.mixin({map:c},a)))})}return this.snappingManager},disableSnapping:function(){this.snappingManager&&this.snappingManager.destroy();this.snappingManager=null},_createLabelLayer:function(){function a(){b._labels.removeAllFeatureLayers();
k.forEach(b.graphicsLayerIds,function(a){a=b.getLayer(a);"function"===typeof a.applyEdits&&b._labels.addFeatureLayer(a)})}var b=this;!this._labels&&(ua&&this.loaded)&&(this._labels=new ua({id:"_internal_LabelLayer"}),this._labels._setMap(this,this._gc._surface),a(),this.on("layers-reordered",a))},_getMapImageLyr:function(){this.loaded&&!this._mapImageLyr&&(this._mapImageLyr=new X,this._mapImageLyr._setMap(this,this._layersDiv),this._placeMapImageLyr());return this._mapImageLyr},_placeMapImageLyr:function(){for(var a=
this.layerIds,b=this._layerDivs,c=!1,g,d,e=a.length-1;0<=e;e--)if(g=a[e],d=this.getLayer(g),g=b[g],d&&g&&!d._isReference){u.place(this._mapImageLyr._div,g,"after");c=!0;break}c||u.place(this._mapImageLyr._div,this._layersDiv,"first")}});g("extend-esri")&&(w._CoreMap=f);return f})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e,l,u,t,p){return m("dijit._HasDropDown",p,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(b){!this.disabled&&!this.readOnly&&("MSPointerDown"!=b.type&&"pointerdown"!=b.type&&b.preventDefault(),this.own(a.once(this.ownerDocument,e.release,c.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},
_onDropDownMouseUp:function(a){var b=this.dropDown,c=!1;if(a&&this._opened){var d=h.position(this._buttonNode,!0);if(!(a.pageX>=d.x&&a.pageX<=d.x+d.w)||!(a.pageY>=d.y&&a.pageY<=d.y+d.h)){for(d=a.target;d&&!c;)n.contains(d,"dijitPopup")?c=!0:d=d.parentNode;if(c){d=a.target;if(b.onItemClick){for(var e;d&&!(e=l.byNode(d));)d=d.parentNode;if(e&&e.onClick&&e.getParent)e.getParent().onItemClick(e,a)}return}}}if(this._opened){if(b.focus&&(!1!==b.autoFocus||"mouseup"==a.type&&!this.hovering))this._focusDropDownTimer=
this.defer(function(){b.focus();delete this._focusDropDownTimer})}else this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",
left:"Left",right:"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";n.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},postCreate:function(){this.inherited(arguments);var b=this.focusNode||this.domNode;this.own(a(this._buttonNode,e.press,c.hitch(this,"_onDropDownMouseDown")),a(this._buttonNode,"click",c.hitch(this,"_onDropDownClick")),a(b,"keydown",c.hitch(this,"_onKey")),a(b,"keyup",c.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);
this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),delete this.dropDown);this.inherited(arguments)},_onKey:function(a){if(!this.disabled&&!this.readOnly){var b=this.dropDown,c=a.target;if(b&&(this._opened&&b.handleKey)&&!1===b.handleKey(a))a.stopPropagation(),a.preventDefault();else if(b&&this._opened&&a.keyCode==d.ESCAPE)this.closeDropDown(),a.stopPropagation(),a.preventDefault();else if(!this._opened&&(a.keyCode==d.DOWN_ARROW||(a.keyCode==d.ENTER||a.keyCode==d.SPACE&&(!this._searchTimer||
a.ctrlKey||a.altKey||a.metaKey))&&("input"!==(c.tagName||"").toLowerCase()||c.type&&"text"!==c.type.toLowerCase())))this._toggleOnKeyUp=!0,a.stopPropagation(),a.preventDefault()}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(c.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=
new q,b=c.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});this.isLoaded()?b():this.loadDropDown(b);return a},toggleDropDown:function(){!this.disabled&&!this.readOnly&&(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var a=this.dropDown,b=a.domNode,d=this._aroundNode||this.domNode,e=this,p=t.open({parent:this,popup:a,around:d,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){e.closeDropDown(!0)},onCancel:function(){e.closeDropDown(!0)},
onClose:function(){f.set(e._popupStateNode,"popupActive",!1);n.remove(e._popupStateNode,"dijitHasDropDownOpen");e._set("_opened",!1)}});if(this.forceWidth||this.autoWidth&&d.offsetWidth>a._popupWrapper.offsetWidth){var d=d.offsetWidth-a._popupWrapper.offsetWidth,l={w:a.domNode.offsetWidth+d};c.isFunction(a.resize)?a.resize(l):h.setMarginBox(b,l);"R"==p.corner[1]&&(a._popupWrapper.style.left=a._popupWrapper.style.left.replace("px","")-d+"px")}f.set(this._popupStateNode,"popupActive","true");n.add(this._popupStateNode,
"dijitHasDropDownOpen");this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");this._popupStateNode.setAttribute("aria-owns",a.id);"presentation"!==b.getAttribute("role")&&!b.getAttribute("aria-labelledby")&&b.setAttribute("aria-labelledby",this.id);return p},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),a&&this.focus&&this.focus(),
t.close(this.dropDown),this._opened=!1)}})})},"esri/layers/OnDemandMode":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../tasks/query ./RenderMode ./GridLayout".split(" "),function(m,q,b,f,n,h,r,k,d,c){m=m([d],{declaredClass:"esri.layers._OnDemandMode",constructor:function(a){this.featureLayer=a;this._featureMap={};this._queryErrorHandler=b.hitch(this,this._queryErrorHandler)},initialize:function(a){this.inherited(arguments);
var b=this.featureLayer,d=b._srInfo;this._gridLayer=new c(new r(d?d.valid[0]:a.extent.xmin,d?d.valid[1]:a.extent.ymax,a.spatialReference),{width:b._tileWidth,height:b._tileHeight},{width:a.width,height:a.height},d);this._cellMap={};this._gridLayer.setResolution(a.extent)},startup:function(){this._ioQueue=[];this.featureLayer.suspended||(this._zoomHandler(),this._enableConnectors())},propertyChangeHandler:function(a){this._init&&(2>a?this._zoomHandler():console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id \x3d "+
this.featureLayer.id+", Layer URL \x3d "+this.featureLayer.url))},destroy:function(){this._disableConnectors();this.inherited(arguments)},drawFeature:function(a){var b=this._gridLayer,c=a.geometry,d=[];if(c)for(var d=b.getCellsInExtent("point"===c.type?{xmin:c.x,ymin:c.y,xmax:c.x,ymax:c.y}:c.getExtent(),!1).cells,b=this._cellMap,t,p=a.attributes[this.featureLayer.objectIdField],g,s,k,c=0;c<d.length;c++)t=d[c],g=t.latticeID,s=t.row,k=t.col,g?t=b[g]=b[g]||t:(b[s]=b[s]||{},t=b[s][k]=b[s][k]||t),t.features=
t.features||[],t.features.push(a),this._addFeatureIIf(p,a),this._incRefCount(p)},suspend:function(){this._init&&this._disableConnectors()},resume:function(){this._init&&(this._enableConnectors(),this._zoomHandler())},refresh:function(){this._zoomHandler()},_enableConnectors:function(){var a=this.map;this._zoomConnect=q.connect(a,"onZoomEnd",this,this._zoomHandler);this._panConnect=q.connect(a,"onPanEnd",this,this._panHandler);this._resizeConnect=q.connect(a,"onResize",this,this._panHandler)},_disableConnectors:function(){q.disconnect(this._zoomConnect);
q.disconnect(this._panConnect);q.disconnect(this._resizeConnect)},_zoomHandler:function(){this._processIOQueue(!0);var a=this.featureLayer,b=this.map;a.suspended||(a._fireUpdateStart(),this._clearIIf(),(a=a._trackManager)&&a.clearTracks(),this._cellMap={},this._gridLayer.setResolution(b.extent),this._sendRequest())},_panHandler:function(a){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&a)},_getRequestId:function(a,b){return("_"+a.name+a.layerId+a._ulid+"_"+b.resolution+
"_"+(b.latticeID||b.row+"_"+b.col)).replace(/[^a-zA-Z0-9\_]+/g,"_")},_sendRequest:function(a){this._exceeds=!1;var b=this.featureLayer,c=this.map;a=a||c.extent;c=this._gridLayer.getCellsInExtent(a,b.latticeTiling).cells;if(!b.isEditable())var d=this._cellMap,c=f.filter(c,function(a){if(a.lattice){if(d[a.latticeID])return!1}else if(d[a.row]&&d[a.row][a.col])return!1;return!0});var t=b.getOutFields(),p=b.getDefinitionExpression(),g=b._getOffsettedTE(b._mapTimeExtent),s=b.supportsAdvancedQueries?b.getOrderByFields():
null,v=b._usePatch,w=this._ioQueue,h,n=this,r=this._drawFeatures,q,m,E;this._pending=this._pending||0;for(h=0;h<c.length;h++){q=c[h];m=new k;m.geometry=q.extent||q.lattice;m.outFields=t;m.where=p;b.latticeTiling&&q.extent&&(m.spatialRelationship=k.SPATIAL_REL_CONTAINS);m.returnGeometry=!0;m.timeExtent=g;b._ts&&(m._ts=(new Date).getTime());m.orderByFields=s;m.multipatchOption=b.multipatchOption;m.maxAllowableOffset=b._maxOffset;m.quantizationParameters=b._quantizationParameters;if((E=b.advancedQueryCapabilities)&&
E.supportsQueryWithResultType)m.resultType="tile";E=null;if(v&&(E=this._getRequestId(b,q),this._isPending(E)))continue;this._pending++;w.push(b._task.execute(m,function(){var a=q;return function(b){r.apply(n,[b,a])}}.call(this),this._queryErrorHandler,E))}this._removeOldCells(a);this._endCheck()},_drawFeatures:function(a,b){this._exceeds=this._exceeds||a.exceededTransferLimit;this._finalizeIO();var c=this.map.extent,d=b.extent,t=b.row,p=b.col,g=this.featureLayer.objectIdField,s=a.features,k=this._gridLayer,
w=this._cellMap,h=b.latticeID,f=h?w[h]:w[t]&&w[t][p];if(b.resolution!=k._resolution||(h?h!==k.getLatticeID(c):!k.intersects(d,c)))f&&this._removeCell(t,p,h);else if(f)this._updateCell(f,s);else{b.features=s;h?w[h]=b:(w[t]=w[t]||{},w[t][p]=b);d=s.length;for(c=0;c<d;c++)t=s[c],p=t.attributes[g],this._addFeatureIIf(p,t),this._incRefCount(p)}this._endCheck()},_queryErrorHandler:function(a){this._finalizeIO();this.featureLayer._errorHandler(a);this._endCheck(!0)},_finalizeIO:function(){this._purgeRequests();
this._pending--},_endCheck:function(a){if(0===this._pending){this._processIOQueue();var b=this.featureLayer,c=b._trackManager;c&&(c.clearTracks(),c.addFeatures(b.graphics),b._ager&&f.forEach(b.graphics,function(a){a._shape&&b._repaint(a)}),c.moveLatestToFront(),c.drawTracks());this.featureLayer._fireUpdateEnd(a&&Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:!0}:null);if(this._exceeds)b.onQueryLimitExceeded()}},_processIOQueue:function(a){this._ioQueue=
f.filter(this._ioQueue,function(a){return-1<a.fired?!1:!0});a&&f.forEach(this._ioQueue,this._cancelPendingRequest)},_removeOldCells:function(a){var b=this._cellMap,c=this._gridLayer,d,t;for(d in b)if(b[d]){var p=b[d],g=p.latticeID,s=0,k=0;if(g)s++,g!==c.getLatticeID(a)&&(this._removeCell(null,null,g),k++);else for(t in p)p[t]&&(s++,c.intersects(p[t].extent,a)||(this._removeCell(d,t),k++));k===s&&delete b[d]}},_updateCell:function(a,b){var c=this.featureLayer,d=c.objectIdField,c=c._selectedFeatures,
t,p=b.length;a.features=a.features||[];for(t=0;t<p;t++){var g=b[t],s=g.attributes[d],k=this._addFeatureIIf(s,g);k===g?(this._incRefCount(s),a.features.push(k)):s in c||(k.setGeometry(g.geometry),k.setAttributes(g.attributes))}},_removeCell:function(a,b,c){var d=this._cellMap,t=this.featureLayer,p=t.objectIdField,g=c?d[c]:d[a]&&d[a][b];if(g){c?delete d[c]:delete d[a][b];a=g.features;for(b=0;b<a.length;b++)c=a[b].attributes[p],this._decRefCount(c),c in t._selectedFeatures||this._removeFeatureIIf(c)}}});
n("extend-esri")&&b.setObject("layers._OnDemandMode",m,h);return m})},"esri/layers/SelectionMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./RenderMode"],function(m,q,b,f,n){m=m([n],{declaredClass:"esri.layers._SelectionMode",constructor:function(b){this.featureLayer=b;this._featureMap={}},propertyChangeHandler:function(b){this._init&&0===b&&this._applyTimeFilter()},resume:function(){this.propertyChangeHandler(0)}});b("extend-esri")&&q.setObject("layers._SelectionMode",
m,f);return m})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),function(m,q,b,f,n,h){return m([h,n],{_onMap:function(b){var k=this.constructor._onMap,d;if(!k||!k.FINAL)delete this.constructor._onMap,k=this.registerConnectEvents(),k.FINAL=!0;b=b.toLowerCase();k[b]?d=this[k[b].method]:(b=this._onCamelCase(b),this[b]&&(d=b));return d},on:function(b,k){var d=this._onMap(b),c=b.replace(/\-/g,""),a="on"+c in
this.domNode;return d||!a?this.inherited(arguments):this.own(f(this.domNode,c,k))[0]},emit:function(b,k,d){var c,a,e,l=b.toLowerCase(),h=this.constructor._onMap||this.registerConnectEvents();a=this[this._onMap(l)];k=k||{};k.target||(k.target=this);a&&(h&&h[l])&&(this._onObj2Arr(function(){c=Array.prototype.slice.call(arguments)},h[l].argKeys)(k),e=q.mixin({},arguments),e[2]=c,e[0]=h[l].name.replace(/^on/,""));return this.inherited(e||arguments)}})})},"esri/layerUtils":function(){define(["dojo/_base/lang",
"dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(m,q,b,f,n){var h={_serializeLayerDefinitions:function(h){var k=[],d=!1,c=/[:;]/;if(h&&(q.forEach(h,function(a,b){a&&(k.push([b,a]),!d&&c.test(a)&&(d=!0))}),0<k.length)){var a;d?(a={},q.forEach(k,function(b){a[b[0]]=b[1]}),a=b.toJson(a)):(a=[],q.forEach(k,function(b){a.push(b[0]+":"+b[1])}),a=a.join(";"));return a}return null},_serializeTimeOptions:function(h,k){if(h){var d=[];q.forEach(h,function(c,a){if(c){var e=c.toJson();k&&-1!==
q.indexOf(k,a)&&(e.useTime=!1);d.push('"'+a+'":'+b.toJson(e))}});if(d.length)return"{"+d.join(",")+"}"}},_getVisibleLayers:function(b,k){var d=[],c,a,e;if(!b)return d;if(k){d=k.concat();for(e=0;e<b.length;e++)c=b[e],a=q.indexOf(b,c.id),c.subLayerIds&&-1<a&&(d.splice(a,1),d=d.concat(c.subLayerIds))}else d=this._getDefaultVisibleLayers(b);return d},_getDefaultVisibleLayers:function(b){var k=[],d;if(!b)return k;for(d=0;d<b.length;d++)0<=b[d].parentLayerId&&-1===q.indexOf(k,b[d].parentLayerId)&&q.some(b,
function(c){return c.id===b[d].parentLayerId})||b[d].defaultVisibility&&k.push(b[d].id);return k},_getLayersForScale:function(b,k){var d=[];if(0<b&&k){var c;for(c=0;c<k.length;c++)if(!(0<=k[c].parentLayerId&&-1===q.indexOf(d,k[c].parentLayerId)&&q.some(k,function(a){return a.id===k[c].parentLayerId}))&&0<=k[c].id){var a=!0,e=k[c].maxScale,l=k[c].minScale;if(0<e||0<l)0<e&&0<l?a=e<=b&&b<=l:0<e?a=e<=b:0<l&&(a=b<=l);a&&d.push(k[c].id)}}return d}};f("extend-esri")&&m.mixin(n,h);return h})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e,l,u,t,p,g){var s,v,w=new (q([e,r],{curNode:null,activeStack:[],constructor:function(){var a=k.hitch(this,function(a){b.isDescendant(this.curNode,a)&&this.set("curNode",null);b.isDescendant(this.prevNode,a)&&this.set("prevNode",null)});m.before(h,"empty",a);m.before(h,"destroy",a)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(b,c){var g=this,e=b.document&&b.document.body;if(e){var p=a("pointer-events")?"pointerdown":a("MSPointer")?
"MSPointerDown":a("touch-events")?"mousedown, touchstart":"mousedown",l=d(b.document,p,function(a){if(!a||!(a.target&&null==a.target.parentNode))g._onTouchNode(c||a.target,"mouse")}),s=d(e,"focusin",function(a){if(a.target.tagName){var b=a.target.tagName.toLowerCase();"#document"==b||"body"==b||(t.isFocusable(a.target)?g._onFocusNode(c||a.target):g._onTouchNode(c||a.target))}}),k=d(e,"focusout",function(a){g._onBlurNode(c||a.target)});return{remove:function(){l.remove();s.remove();k.remove();e=l=
s=k=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<s+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(k.hitch(this,function(){this.set("prevNode",this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<v+100||(this._clearActiveWidgetsTimer=setTimeout(k.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,b){v=(new Date).getTime();
this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);n.contains(a,"dijitPopup")&&(a=a.firstChild);var c=[];try{for(;a;){var g=f.get(a,"dijitPopupParent");if(g)a=p.byId(g).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===l.body())break;a=u.get(a.ownerDocument).frameElement}else{var d=a.getAttribute&&a.getAttribute("widgetId"),e=d&&p.byId(d);e&&!("mouse"==b&&e.get("disabled"))&&c.unshift(d);a=a.parentNode}}}catch(s){}this._setStack(c,
b)},_onFocusNode:function(a){a&&9!=a.nodeType&&(s=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),this._onTouchNode(a),a!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,b){var c=this.activeStack,g=c.length-1,d=a.length-1;if(a[d]!=c[g]){this.set("activeStack",a);var e;for(e=g;0<=e&&c[e]!=a[e];e--)if(g=p.byId(c[e]))g._hasBeenBlurred=!0,g.set("focused",!1),g._focusManager==this&&g._onBlur(b),
this.emit("widget-blur",g,b);for(e++;e<=d;e++)if(g=p.byId(a[e]))g.set("focused",!0),g._focusManager==this&&g._onFocus(b),this.emit("widget-focus",g,b)}},focus:function(a){if(a)try{a.focus()}catch(b){}}}));c(function(){var b=w.registerWin(u.get(document));a("ie")&&d(window,"unload",function(){b&&(b.remove(),b=null)})});g.focus=function(a){w.focus(a)};for(var y in w)/^_/.test(y)||(g.focus[y]="function"==typeof w[y]?k.hitch(w,y):w[y]);w.watch(function(a,b,c){g.focus[a]=c});return w})},"dijit/hccss":function(){define(["dojo/dom-class",
"dojo/hccss","dojo/domReady","dojo/_base/window"],function(m,q,b,f){b(function(){q("highcontrast")&&m.add(f.body(),"dijit_a11y")});return q})},"esri/arcgis/utils":function(){define("require dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/on dojo/DeferredList dojo/dom-construct dojo/sniff ../kernel ../config ../lang ../request ../SpatialReference ../map ../urlUtils ../geometry/ScreenPoint ../geometry/Extent ../geometry/webMercatorUtils ../symbols/jsonUtils ../renderers/jsonUtils ../dijit/PopupTemplate ../dijit/Popup ../tasks/query ../tasks/GeometryService ../layers/ArcGISTiledMapServiceLayer ../layers/FeatureLayer dojo/i18n!../nls/jsapi".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e,l,u,t,p,g,s,v,w,y,A,x,D,K,E,C,H,G,J){function F(a){return t({url:M.arcgisUrl+"/"+a.itemId+"/data",content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:!0,_preLookup:!0})}function O(a,b){var c={f:"json"};b&&(c.token=b);return t({url:a,content:c,callbackParamName:"callback"},{disableIdentityLookup:!0})}function N(a){a.itemProperties.layerDefinition&&(a.layerDefinition?(a.layerDefinition.drawingInfo||(a.layerDefinition.drawingInfo=a.itemProperties.layerDefinition.drawingInfo),
u.isDefined(a.layerDefinition.definitionExpression)||(a.layerDefinition.definitionExpression=a.itemProperties.layerDefinition.definitionExpression),u.isDefined(a.layerDefinition.minScale)||(a.layerDefinition.minScale=a.itemProperties.layerDefinition.minScale),u.isDefined(a.layerDefinition.maxScale)||(a.layerDefinition.maxScale=a.itemProperties.layerDefinition.maxScale)):a.layerDefinition=a.itemProperties.layerDefinition);a.itemProperties.popupInfo&&(!a.popupInfo&&!a.disablePopup)&&(a.popupInfo=a.itemProperties.popupInfo);
u.isDefined(a.itemProperties.showLabels)&&!u.isDefined(a.showLabels)&&(a.showLabels=a.itemProperties.showLabels);u.isDefined(a.itemProperties.showLegend)&&!u.isDefined(a.showLegend)&&(a.showLegend=a.itemProperties.showLegend);u.isDefined(a.itemProperties.refreshInterval)&&!u.isDefined(a.refreshInterval)&&(a.refreshInterval=a.itemProperties.refreshInterval)}function I(a){N(a);a.itemProperties.layerDefinition&&a.layerDefinition&&(!u.isDefined(a.layerDefinition.maximumTrackPoints)&&u.isDefined(a.itemProperties.layerDefinition.maximumTrackPoints)&&
(a.layerDefinition.maximumTrackPoints=a.itemProperties.layerDefinition.maximumTrackPoints),!a.layerDefinition.definitionGeometry&&a.itemProperties.layerDefinition.definitionGeometry&&(a.layerDefinition.definitionGeometry=a.itemProperties.layerDefinition.definitionGeometry));a.itemProperties.purgeOptions&&!a.purgeOptions&&(a.purgeOptions=a.itemProperties.purgeOptions)}function B(a,c){var g=new n,e=a.itemData,p=[],l=[];b.forEach(e.operationalLayers,function(a){if(a.itemId&&!a.type){var b=a.url.toLowerCase();
-1<b.indexOf("/featureserver")||-1<b.indexOf("/mapserver/")?(l.push(a),p.push(F(a))):-1<b.indexOf("/mapserver")&&-1===b.indexOf("/mapserver/")&&(!a.layers||!u.isDefined(a.minScale)&&!u.isDefined(a.maxScale))?(l.push(a),p.push(F(a))):-1<b.indexOf("/imageserver")&&!u.isDefined(a.minScale)&&!u.isDefined(a.maxScale)?(l.push(a),p.push(F(a))):-1<b.indexOf("/streamserver")&&(l.push(a),p.push(F(a)))}});e.baseMap&&e.baseMap.baseMapLayers&&b.forEach(e.baseMap.baseMapLayers,function(a){a.itemId&&"VectorTileLayer"!==
a.layerType&&(l.push(a),p.push(F(a)))});if(0<p.length){var s={};(new d(p)).addCallback(function(c){b.forEach(l,function(a,g){var d=c[g][1];if(d&&!(d instanceof Error)&&(s[a.itemId]=d,!a.type)){var e=a.url.toLowerCase();if((-1<e.indexOf("/featureserver")||-1<e.indexOf("/mapserver/"))&&d.layers)b.forEach(d.layers,function(b){if(e.match("/featureserver/"+b.id+"$")=="/featureserver/"+b.id||e.match("/mapserver/"+b.id+"$")=="/mapserver/"+b.id)a.itemProperties=b,N(a)});else if(-1<e.indexOf("/streamserver"))a.itemProperties=
d,I(a);else if(-1<e.indexOf("/mapserver"))d.layers&&!a.layers&&(a.layers=d.layers),u.isDefined(d.minScale)&&!u.isDefined(a.minScale)&&(a.minScale=d.minScale),u.isDefined(d.maxScale)&&!u.isDefined(a.maxScale)&&(a.maxScale=d.maxScale),u.isDefined(d.refreshInterval)&&!u.isDefined(a.refreshInterval)&&(a.refreshInterval=d.refreshInterval),d.visibleLayers&&!a.visibleLayers&&(a.visibleLayers=d.visibleLayers);else if(-1<e.indexOf("/imageserver")&&(u.isDefined(d.minScale)&&!u.isDefined(a.minScale)&&(a.minScale=
d.minScale),u.isDefined(d.maxScale)&&!u.isDefined(a.maxScale)&&(a.maxScale=d.maxScale),u.isDefined(d.refreshInterval)&&!u.isDefined(a.refreshInterval)&&(a.refreshInterval=d.refreshInterval),d.popupInfo&&(!a.popupInfo&&!a.disablePopup)&&(a.popupInfo=d.popupInfo),d.renderingRule&&!a.renderingRule&&(a.renderingRule=d.renderingRule,d.renderingRule.functionName&&(a.renderingRule.rasterFunction=d.renderingRule.functionName)),d.bandIds&&!a.bandIds&&(a.bandIds=d.bandIds),d.mosaicRule&&!a.mosaicRule&&(a.mosaicRule=
d.mosaicRule),d.format&&!a.format&&(a.format=d.format),u.isDefined(d.compressionQuality)&&!u.isDefined(a.compressionQuality)&&(a.compressionQuality=d.compressionQuality),d.layerDefinition&&d.layerDefinition.definitionExpression&&(!u.isDefined(a.layerDefinition)||!u.isDefined(a.layerDefinition.definitionExpression))))a.layerDefinition=a.layerDefinition||{},a.layerDefinition.definitionExpression=d.layerDefinition.definitionExpression}});a.relatedItemsData=s;g.callback(a)})}else g.callback(a);return g}
function R(a,b){var c=new n,g=a.itemData,d=g.baseMap.baseMapLayers[0];if("BingMapsAerial"===d.type||"BingMapsRoad"===d.type||"BingMapsHybrid"===d.type)if(d.portalUrl&&e.id)delete b.bingMapsKey,e.id.checkSignInStatus(s.urlToObject(M.arcgisUrl).path).then(q.hitch(null,function(a,b,c,g,e){O(d.portalUrl,e.token).then(q.hitch(null,U,a,b,c,g),q.hitch(null,V,a,b,c,g))},a,b,g,c),q.hitch(null,function(a,b,c,g,e){O(d.portalUrl).then(q.hitch(null,U,a,b,c,g),q.hitch(null,V,a,b,c,g))},a,b,g,c));else if(b.bingMapsKey){var p=
new Pa({bingMapsKey:b.bingMapsKey,mapStyle:Pa.MAP_STYLE_AERIAL});f.connect(p,"onLoad",q.hitch(this,function(){c.callback([a,b])}));f.connect(p,"onError",function(e){delete b.bingMapsKey;a.itemData=P(g);d=a.itemData.baseMap.baseMapLayers[0];d.errors=[];d.errors.push({message:"The owner of the application has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});c.callback([a,b])})}else a.itemData=P(g),d=a.itemData.baseMap.baseMapLayers[0],d.errors=[],d.errors.push({message:"The owner of the application has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."}),
c.callback([a,b]);else c.callback([a,b]);return c}function S(b){var c=new n,g,d;b=b.itemData;var e=b.baseMap&&b.baseMap.baseMapLayers;if(a("ie")||ib&&!ib.supported())for(b=0;b<e.length;b++){var p=e[b];if(!p.isReference){"VectorTileLayer"===p.layerType&&(g=p.itemId,d=b);break}}g?Oa(g,!1).addBoth(function(a){var b=/^https?:\/\/basemaps(dev)?\.arcgis\.com\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;a&&(a.item&&b.test(a.item.url))&&(e[d]={id:"FB_"+p.id,layerType:"ArcGISTiledMapServiceLayer",
opacity:"opacity"in p?p.opacity:1,visibility:"visibility"in p?p.visibility:!0,url:"http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer"});c.resolve()}):c.resolve();return c}function U(a,b,c,g,d){d.bingKey?(b.bingMapsKey=d.bingKey,d=new Pa({bingMapsKey:b.bingMapsKey,mapStyle:Pa.MAP_STYLE_AERIAL}),f.connect(d,"onLoad",q.hitch(this,function(){g.callback([a,b])})),f.connect(d,"onError",function(d){delete b.bingMapsKey;a.itemData=P(c);d=a.itemData.baseMap.baseMapLayers[0];
d.errors=[];d.errors.push({message:"The owner of the map has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});g.callback([a,b])})):V(a,b,c,g)}function V(a,b,c,g){delete b.bingMapsKey;a.itemData=P(c);c=a.itemData.baseMap.baseMapLayers[0];c.errors=[];c.errors.push({message:"The owner of the map has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."});g.callback([a,b])}function P(a){a.baseMap="BingMapsAerial"===a.baseMap.baseMapLayers[0].type?
{title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:"BingMapsRoad"===a.baseMap.baseMapLayers[0].type?{title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:{title:"Imagery with Labels",baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},
{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]};return a}function fa(a,c,g,d){var e=a.dynamicLayerInfos||a.layerInfos,p=c.layers;if(p&&e)if(d.usePopupManager){var l;b.forEach(e,function(a){var b=a.id;if(!a.subLayerIds)for(a=0;a<p.length;a++){var c=p[a];if(c.id===b&&c.popupInfo){l||(l={});l[b]={infoTemplate:new g(c.popupInfo),layerUrl:c.layerUrl};break}}});l&&
a.setInfoTemplates(l)}else{var s=[],t=[],k=[],w=[],h=[],v=[];b.forEach(e,function(c){var g=c.id;if(!c.subLayerIds&&-1!==b.indexOf(a.visibleLayers,g))for(c=0;c<p.length;c++){var d=p[c];if(d.id===g){t.push(g);s.push(d.popupInfo);k.push(d.layerUrl||"");d.layerDefinition&&d.layerDefinition.definitionExpression?w.push(d.layerDefinition.definitionExpression):w.push("");h.push(u.isDefined(d.minScale)?d.minScale:null);v.push(u.isDefined(d.maxScale)?d.maxScale:null);break}}});s.length&&(a.__popups=s,a.__popupIds=
t,a.__popupUrls=k,a.__popupWhereClauses=w,a.__popupMinScales=h,a.__popupMaxScales=v,a.__resourceInfo=c.resourceInfo)}}function X(a){if(!a)return!1;var b=(new r(M.arcgisUrl)).authority;return-1!==a.indexOf(".arcgis.com/")||-1!==a.indexOf(b)}function sa(a){return!a?!1:-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/")}function da(a){if("https:"===location.protocol&&(X(a)||sa(a)))a=a.replace("http:","https:");return a}function aa(a,c,g){var d=[],e;a.displayLevels||
(d=b.map(a.resourceInfo.tileInfo.lods,function(a){return a.level}));a.exclusionAreas&&(e=q.clone(a.exclusionAreas),e=b.map(e,function(a){a.geometry=new w(a.geometry);return a}));d=new H(da(a.url),{resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,displayLevels:a.displayLevels||d,id:a.id,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval,exclusionAreas:e});g.ignorePopups||fa(d,a,c,g);return d}function ja(a,b){if(!a||!b||0===b.length)return[];var c=","+b+",",
g=[],d,e=",";for(d=0;d<a.length;d++)if(null!==a[d].subLayerIds){if(-1===c.indexOf(","+a[d].id+",")||-1<e.indexOf(","+a[d].id+","))e+=a[d].subLayerIds.toString()+","}else-1<c.indexOf(","+a[d].id+",")&&-1===e.indexOf(","+a[d].id+",")&&g.push(a[d].id);return g}function ua(a,c,g){var d=new L;d.format="png24";a.resourceInfo&&(a.resourceInfo.supportedImageFormatTypes&&-1<a.resourceInfo.supportedImageFormatTypes.indexOf("PNG32"))&&(d.format="png32");var d=new ha(da(a.url),{resourceInfo:a.resourceInfo,opacity:a.opacity,
visible:a.visibility,id:a.id,imageParameters:d,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval}),e=a.visibleLayers;if(!a.visibleLayers){var p="";b.forEach(d.layerInfos,function(a){a.defaultVisibility&&(p+=(0<p.length?",":"")+a.id)});e=p}if(a.layers&&0<a.layers.length){var l=[],s=[],t,k=[],w,h;b.forEach(a.layers,function(c){c.layerDefinition&&c.layerDefinition.definitionExpression&&(l[c.id]=c.layerDefinition.definitionExpression);if(c.layerDefinition&&c.layerDefinition.source){t=
null;h=c.layerDefinition.source;if("mapLayer"===h.type){var g=b.filter(a.resourceInfo.layers,function(a){return a.id===h.mapLayerId});g.length&&(t=q.mixin(g[0],c))}else t=q.mixin({},c);t&&(t.source=h,delete t.popupInfo,t=new W(t),a.visibleLayers&&(g="string"==typeof a.visibleLayers?a.visibleLayers.split(","):a.visibleLayers,-1<b.indexOf(g,c.id)?t.defaultVisibility=!0:t.defaultVisibility=!1),s.push(t))}c.layerDefinition&&(c.layerDefinition.source&&c.layerDefinition.drawingInfo)&&(w=new Db(c.layerDefinition.drawingInfo),
k[c.id]=w)},this);0<l.length&&d.setLayerDefinitions(l);0<s.length?(d.setDynamicLayerInfos(s,!0),0<k.length&&d.setLayerDrawingOptions(k,!0)):(e=ja(d.layerInfos,e),d.setVisibleLayers(e))}else e=ja(d.layerInfos,e),d.setVisibleLayers(e);g.ignorePopups||fa(d,a,c,g);return d}function ma(a,b,c){var g=new Ab;g.bandIds=a.bandIds;null!=a.format&&(g.format=a.format,null!=a.compressionQuality&&(g.compressionQuality=a.compressionQuality));if(a.renderingRule&&a.renderingRule.rasterFunction){var d=new ub(a.renderingRule);
g.renderingRule=d}a.mosaicRule&&(d=new mb(a.mosaicRule),g.mosaicRule=d);u.isDefined(a.noData)&&(g.noData=a.noData);u.isDefined(a.noDataInterpretation)&&(g.noDataInterpretation=a.noDataInterpretation);u.isDefined(a.interpolation)&&(g.interpolation=a.interpolation);d=a.layerType?"ArcGISImageServiceVectorLayer"===a.layerType:!1;u.isDefined(a.layerType)||(d=a.resourceInfo.hasMultidimensions&&("esriImageServiceDataTypeVector-UV"===a.resourceInfo.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===
a.resourceInfo.serviceDataType));g={resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id,imageServiceParameters:g,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval};g=d?new $(da(a.url),g):new z(da(a.url),g);a.layerDefinition&&(a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(d=x.fromJson(a.layerDefinition.drawingInfo.renderer),g.setRenderer(d)),a.layerDefinition.definitionExpression&&g.setDefinitionExpression(a.layerDefinition.definitionExpression,
!0));!c.ignorePopups&&a.popupInfo&&g.setInfoTemplate(new b(a.popupInfo));return g}function pa(a,c,g){var d=[102113,102100,3857],e=g||new p(c[0].layerObject.fullExtent.spatialReference),l=new p(a.resourceInfo.fullExtent.spatialReference);return e.wkt==l.wkt&&(e.wkid==l.wkid||u.isDefined(e.latestWkid)&&e.latestWkid==l.wkid||u.isDefined(l.latestWkid)&&e.wkid==l.latestWkid||u.isDefined(e.latestWkid)&&e.latestWkid==l.latestWkid)||e.wkid&&l.wkid&&b.some(d,function(a){return a===l.wkid})&&b.some(d,function(a){return a===
e.wkid})?!0:!1}function qa(a,b,c){if(!b[0].layerObject.tileInfo)return!1;a=a.resourceInfo.tileInfo;b=b[0].layerObject.tileInfo;c=c.width>c.height?c.width:c.height;for(var g=!1,d=!1,e=0;e<a.lods.length;e++){for(var p=a.lods[e].scale/a.dpi,l=0;l<b.lods.length;l++){var s=b.lods[l].scale/b.dpi;if(Math.abs(s-p)/s<1/c)if(g){d=!0;break}else g=!0}if(d)break}return d||g&&(1===a.lods.length||1===b.lods.length)?!0:!1}function ra(a,c,g,d,l,t){var v,n=g._clazz;if("OpenStreetMap"===a.type)v=new Bb({id:a.id,opacity:a.opacity,
visible:null!==a.visibility&&void 0!==a.visibility?a.visibility:!0});else if("WMS"===a.type){var r=[],m=[];b.forEach(a.layers,function(a){m.push(new $a({name:a.name,title:a.title,legendURL:a.legendURL}));r.push(a.name)},this);a.visibleLayers&&(r=a.visibleLayers);d={extent:new w(a.extent[0][0],a.extent[0][1],a.extent[1][0],a.extent[1][1],new p({wkid:4326})),layerInfos:m,version:a.version,maxWidth:a.maxWidth,maxHeight:a.maxHeight,getMapURL:a.mapUrl,spatialReferences:a.spatialReferences,title:a.title,
copyright:a.copyright,minScale:a.minScale||0,maxScale:a.maxScale||0,format:a.format};v=new vb(a.url,{id:a.id,visibleLayers:r,format:"png",transparent:a.firstLayer?!1:!0,opacity:a.opacity,visible:null!==a.visibility?a.visibility:!0,resourceInfo:d,refreshInterval:a.refreshInterval});v.spatialReference.wkid=d.spatialReferences[0]}else if("KML"===a.type){g=a.url;if(e.id&&(n=e.id.findCredential(s.urlToObject(M.arcgisUrl).path))){var C=M.arcgisUrl.substring(M.arcgisUrl.indexOf("//")+2,M.arcgisUrl.indexOf("/",
M.arcgisUrl.indexOf("//")+3)),y=C.split("."),y=y[y.length-2]+"."+y[y.length-1];c=g.indexOf(y);-1<c&&(g="https://"+C+g.substring(c+y.length),g+="?token\x3d"+n.token)}v=new Ra(g,{id:a.id,visible:null!==a.visibility?a.visibility:!0,outSR:d,refreshInterval:a.refreshInterval});f.connect(v,"onLoad",function(){(a.opacity||0===a.opacity)&&v.setOpacity(a.opacity);u.isDefined(a.minScale)&&u.isDefined(a.maxScale)&&v.setScaleRange(a.minScale,a.maxScale);a.visibleFolders&&b.forEach(v.folders,function(c){-1<b.indexOf(a.visibleFolders,
c.id)?v.setFolderVisibility(c,!0):v.setFolderVisibility(c,!1)},this)})}else"WebTiledLayer"===a.type?(v=new nb(a.templateUrl,{id:a.id,visible:null!==a.visibility?a.visibility:!0,opacity:a.opacity,copyright:a.copyright,fullExtent:a.fullExtent&&new w(a.fullExtent),initialExtent:a.fullExtent&&new w(a.fullExtent),subDomains:a.subDomains,tileInfo:a.tileInfo?new Xa(a.tileInfo):null,refreshInterval:a.refreshInterval}),f.connect(v,"onLoad",function(){(u.isDefined(a.minScale)||u.isDefined(a.maxScale))&&v.setScaleRange(a.minScale,
a.maxScale)})):"GeoRSS"===a.type?(v=new Y(a.url,{id:a.id,opacity:a.opacity,outSpatialReference:d,refreshInterval:a.refreshInterval}),f.connect(v,"onLoad",function(){!1===a.visibility&&v.hide();u.isDefined(a.minScale)&&u.isDefined(a.maxScale)&&v.setScaleRange(a.minScale,a.maxScale);var c=v.getFeatureLayers();b.forEach(c,function(b){a.pointSymbol&&"esriGeometryPoint"===b.geometryType?(b.renderer.symbol=A.fromJson(a.pointSymbol),1===c.length&&(v.pointSymbol=A.fromJson(a.pointSymbol))):a.lineSymbol&&
"esriGeometryPolyline"===b.geometryType?(b.renderer.symbol=A.fromJson(a.lineSymbol),1===c.length&&(v.polylineSymbol=A.fromJson(a.lineSymbol))):a.polygonSymbol&&"esriGeometryPolygon"===b.geometryType&&(b.renderer.symbol=A.fromJson(a.polygonSymbol),1===c.length&&(v.polygonSymbol=A.fromJson(a.polygonSymbol)))})})):"CSV"==a.type&&a.url?(d={layerDefinition:a.layerDefinition,columnDelimiter:a.columnDelimiter,id:a.id?a.id:null,visible:null!==a.visibility?a.visibility:!0,opacity:a.opacity,refreshInterval:a.refreshInterval},
a.locationInfo&&(d.latitudeFieldName=a.locationInfo.latitudeFieldName,d.longitudeFieldName=a.locationInfo.longitudeFieldName),g.ignorePopups||(d.infoTemplate=new D(a.popupInfo?a.popupInfo:ea.generateDefaultPopupInfo(a))),v=new ka(a.url,d)):"VectorTileLayer"===a.layerType&&a.styleUrl?v=new jb(a.styleUrl,{id:a.id,minScale:a.minScale,maxScale:a.maxScale,opacity:a.opacity,visible:a.visibility}):a.layerDefinition&&!a.url?(d=h.fromJson(h.toJson(a)),delete d.id,delete d.opacity,delete d.visibility,v=new G(d,
{id:a.id,opacity:a.opacity,visible:a.visibility,outFields:["*"],autoGeneralize:!0}),!g.ignorePopups&&d.popupInfo&&v.setInfoTemplate(new n(d.popupInfo)),xa(v)):"BingMapsAerial"===a.type||"BingMapsRoad"===a.type||"BingMapsHybrid"===a.type?g.bingMapsKey?(d=Pa.MAP_STYLE_AERIAL_WITH_LABELS,"BingMapsAerial"===a.type?d=Pa.MAP_STYLE_AERIAL:"BingMapsRoad"===a.type&&(d=Pa.MAP_STYLE_ROAD),v=new Pa({bingMapsKey:g.bingMapsKey,mapStyle:d,opacity:a.opacity,id:a.id}),f.connect(v,"onError",q.hitch(this,function(a){a.errors=
a.errors||[];a.errors.push({message:"This application does not have a valid Bing Key for the Bing layer that is included in this map. [type:"+a.type+"]"})},a))):(a.errors=a.errors||[],a.errors.push({message:"This application does not provide a Bing Key for the Bing layer that is included in this map. [type:"+a.type+"]"})):a.resourceInfo&&a.resourceInfo.mapName?v=!0===a.resourceInfo.singleFusedMapCache&&(a.baseMapLayer||pa(a,c,d)&&qa(a,l,t))?aa(a,n,g):ua(a,n,g):a.resourceInfo&&a.resourceInfo.pixelSizeX?
v=!0===a.resourceInfo.singleFusedMapCache&&(a.baseMapLayer||pa(a,c,d)&&qa(a,l,t))?aa(a,n,g):ma(a,n,g):a.resourceInfo&&"Feature Layer"===a.resourceInfo.type?(a.capabilities&&(a.resourceInfo.capabilities=a.capabilities),v=new G(da(a.url),{resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id,mode:X(a.url)?G.MODE_AUTO:u.isDefined(a.mode)?a.mode:G.MODE_ONDEMAND,editable:!1===g.editable?!1:void 0,outFields:["*"],autoGeneralize:!0,refreshInterval:a.refreshInterval}),!g.ignorePopups&&
a.popupInfo&&v.setInfoTemplate(new n(a.popupInfo)),a.layerDefinition&&(a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(d=x.fromJson(a.layerDefinition.drawingInfo.renderer),d.isMaxInclusive=!0,v.setRenderer(d)),a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.labelingInfo&&(d=b.map(a.layerDefinition.drawingInfo.labelingInfo,function(a){return new Wa(a)}),v.setLabelingInfo(d)),a.layerDefinition.definitionExpression&&v.setDefinitionExpression(a.layerDefinition.definitionExpression),
u.isDefined(a.layerDefinition.minScale)&&v.setMinScale(a.layerDefinition.minScale),u.isDefined(a.layerDefinition.maxScale)&&v.setMaxScale(a.layerDefinition.maxScale)),xa(v)):a.resourceInfo&&a.resourceInfo.streamUrls&&(d={resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id},a.layerDefinition&&(y=a.layerDefinition.drawingInfo,a.layerDefinition.definitionGeometry&&(C=C||{},C.geometry=a.layerDefinition.definitionGeometry),u.isDefined(a.layerDefinition.definitionExpression)&&(C=
C||{},C.where=a.layerDefinition.definitionExpression),u.isDefined(a.layerDefinition.maximumTrackPoints)&&(d.maximumTrackPoints=a.layerDefinition.maximumTrackPoints)),C&&(d.filter=C),a.purgeOptions&&(d.purgeOptions=a.purgeOptions),v=new wb(da(a.url),d),y&&y.renderer&&(d=y.renderer,v.setRenderer(x.fromJson(d))),!g.ignorePopups&&a.popupInfo&&v.setInfoTemplate(new n(a.popupInfo)),a.layerDefinition&&(u.isDefined(a.layerDefinition.minScale)&&v.setMinScale(a.layerDefinition.minScale),u.isDefined(a.layerDefinition.maxScale)&&
v.setMaxScale(a.layerDefinition.maxScale)),k.once(v,"error",function(b){a.errors.push({message:"Error loading stream layer. Check websocket url"})}));v&&(v.arcgisProps={title:a.title},a.baseMapLayer&&(a.isReference?(v.attr("data-reference",!0),v._basemapGalleryLayerType="reference"):v._basemapGalleryLayerType="basemap"));return v}function ca(a,c,g,d,e){b.forEach(a,function(b){b.layerObject=ra(b,a,c,g,d,e)});var p=b.filter(a,function(a){return!a.isReference}),l=b.filter(a,function(a){return!!a.isReference});
return a=p.concat(l)}function za(a){var b=null;a=a[0];a.url&&!a.type?a.resourceInfo.spatialReference&&(b=new p,a.resourceInfo.spatialReference.wkid&&(b.wkid=a.resourceInfo.spatialReference.wkid),a.resourceInfo.spatialReference.wkt&&(b.wkt=a.resourceInfo.spatialReference.wkt)):a.type&&(-1<a.type.indexOf("BingMaps")||"OpenStreetMap"==a.type?b=new p({wkid:102100}):"WMS"==a.type&&(b=new p({wkid:a.spatialReferences[0]})));return b}function oa(a,c,g,d,e,p,l,s){b.forEach(c,function(b){b.url&&!b.type&&(b.resourceInfo=
a[b.deferredsPos][1],delete b.deferredsPos)});p=p||za(c);c=ca(c,g,p,l,s);e.callback(c);return e}function xa(a){!window.CanvasRenderingContext2D&&(a.renderer&&"esri.renderer.HeatmapRenderer"===a.renderer.declaredClass)&&a.setRenderer(x.fromJson({type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:0.75,type:"esriSLS",style:"esriSLSSolid"}}}))}function Ca(a,b){var c=da(a);return t({url:c,content:{f:"json"},
callbackParamName:"callback",error:function(a,g){a.message=a.message?a.message+(" [url:"+c+"]"):"[url:"+c+"]";b.push(a);l.defaults.io.errorHandler(a,g)}})}function wa(a){var b=M.arcgisUrl+"/"+a.itemId+"/data";return t({url:b,content:{f:"json"},callbackParamName:"callback",error:function(c,g){c.message=c.message?c.message+(" [url:"+b+"]"):"[url:"+b+"]";a.errors=a.errors||[];a.errors.push(c);l.defaults.io.errorHandler(c,g)}})}function va(a,c,g){var d=new n;if((!g.featureCollection||!g.featureCollection.layers)&&
!g.layers)return console.log("Invalid Feature Collection item data [item id: "+a.itemId+"]: ",g),a.errors=a.errors||[],a.errors.push({message:"Invalid Feature Collection item data. [item id: "+a.itemId+"]"}),d.errback(),d;g.layers&&(g.featureCollection={layers:g.layers},delete g.layers,u.isDefined(g.showLegend)&&(g.featureCollection.showLegend=g.showLegend,delete g.showLegend));ya(a,g.featureCollection,c).then(function(c){g.featureCollection=c;a.featureCollection&&a.featureCollection.layers?b.forEach(g.featureCollection.layers,
function(b,c){var g=a.featureCollection.layers[c];if(!g.poupInfo&&!g.layerDefinition)g.popupInfo=b.popupInfo,g.layerDefinition=b.layerDefinition;else if(g.layerDefinition){if(u.isDefined(g.layerDefinition.minScale)&&u.isDefined(g.layerDefinition.maxScale)&&(g.layerDefinition.minScale!==b.layerDefinition.minScale||g.layerDefinition.maxScale!==b.layerDefinition.maxScale))delete b.layerDefinition.minscale,delete b.layerDefinition.maxScale;g.layerDefinition.drawingInfo&&h.toJson(g.layerDefinition.drawingInfo)!==
h.toJson(b.layerDefinition.drawingInfo)&&delete b.layerDefinition.drawingInfo;g.layerDefinition.showLegend!==b.layerDefinition.showLegend&&delete b.layerDefinition.showLegend;g.layerDefinition=q.mixin(g.layerDefinition,b.layerDefinition)}else g.layerDefinition=b.layerDefinition;g.featureSet=b.featureSet;g.nextObjectId=b.nextObjectId}):(a.featureCollection=a.featureCollection||{},a.featureCollection=q.mixin(a.featureCollection,g.featureCollection));d.callback(a)});return d}function ya(a,c,g){var e=
new n;m(["./csv"],function(p){var l=[];b.forEach(c.layers,function(a){a.featureSet&&(a.featureSet.features&&a.featureSet.features.length&&a.featureSet.features[0].geometry&&a.featureSet.features[0].geometry.spatialReference)&&(a.deferredsPos=l.length,l.push(p.projectFeatureCollection(a,g,a.featureSet.features[0].geometry.spatialReference)))});(new d(l)).addCallback(function(){b.forEach(c.layers,function(b){u.isDefined(b.deferredsPos)&&(l[b.deferredsPos].results&&l[b.deferredsPos].results.length?b=
l[b.deferredsPos].results[0]:(console.log("Errors projecting feature collection. ["+a.title+" - "+b.layerDefinition.name+"]"),b.errors=b.errors||[],b.errors.push({message:"Errors projecting feature collection. ["+a.title+" - "+b.layerDefinition.name+"]"})),delete b.deferredsPos)});e.callback(c)})});return e}function Ba(a,c,g,e,p){var l=new n,s=new n,t=[],v;b.forEach(a.operationalLayers,function(a){a.itemId&&"Feature Collection"==a.type&&t.push(wa(a).then(q.hitch(null,va,a,g)))});0===t.length?Va(a,
c,g,e,s,p):(v=new d(t),v.addCallback(function(b){Va(a,c,g,e,s,p)}));s.then(function(a){t=[];b.forEach(a,function(a){a=a.layerObject;if(a instanceof G&&!a.loaded&&!a.loadError){var b=new n;k.once(a,"load, error",function(){b.callback(a)});t.push(b)}});if(t.length){var c=new n;v=new d(t);v.addCallback(function(){c.callback(a)});return c.promise}return a}).then(function(a){var c=[];b.forEach(a,function(a){if(a.layerObject instanceof G){var b=a.layerObject;b.loaded&&(b.labelingInfo&&(a.showLabels||b._collection))&&
c.push(b)}});c.length?m(["../layers/LabelLayer"],function(g){var d=new g;b.forEach(c,function(a){d.addFeatureLayer(a)});a.push({layerObject:d});l.callback(a)}):l.callback(a)});return l}function Va(a,c,g,e,p,l){var s=[],t=[],k=[];b.forEach(a.operationalLayers,function(a,c){if(a.featureCollection&&a.featureCollection.layers){var g=a.featureCollection.layers.length;b.forEach(a.featureCollection.layers,function(d,e){var p=!0;a.visibleLayers&&-1==b.indexOf(a.visibleLayers,e)&&(p=!1);d.visibility=a.visibility&&
p;d.opacity=a.opacity;d.id=(a.id||"operational"+c)+"_"+e;a.title&&(d.title=1===g||!d.layerDefinition.name||a.title===d.layerDefinition.name?a.title:a.title+" - "+d.layerDefinition.name);k.push(d)},this)}else k.push(a)});b.forEach(a.baseMap.baseMapLayers,function(a,b){a.baseMapLayer=!0;a.id=a.id||"base"+b;s.push(a)});b.forEach(k,function(a,b){a.id=a.id||"operational"+b;s.push(a)});b.forEach(s,function(a){a.url&&!a.type&&(a.deferredsPos=t.length,a.errors=a.errors||[],t.push(Ca(a.url,a.errors)))});0===
t.length?(g=g||za(s),s=ca(s,c,g,e,l),p.callback(s)):(new d(t)).addCallback(function(a){oa(a,s,c,t,p,g,e,l)});return p}function Na(a,c,g,d){var e=a.minScale,p=a.maxScale;if(10.1>=g.version&&c)for(a=c.length-1;0<=a;a--){if(c[a].id==d)if(0==e&&0<c[a].minScale?e=c[a].minScale:0<e&&0==c[a].minScale?e=g.minScale:0<e&&0<c[a].minScale&&(e=Math.min(e,c[a].minScale)),p=Math.max(g.maxScale||0,c[a].maxScale||0),g.setScaleRange(e,p),-1<c[a].parentLayerId)d=c[a].parentLayerId;else break}else 10.1<g.version&&(b.forEach(a.layerInfos,
function(a){a.id==d&&(0==e&&0<a.minScale?e=a.minScale:0<e&&0==a.minScale||0<e&&0<a.minScale&&(e=Math.min(e,a.minScale)),p=Math.max(p||0,a.maxScale||0))}),g.setScaleRange(e,p))}function ia(a,c,g,d){var e=a.url,p=a.__popupIds,l=a.__popupUrls,s=a.__popupWhereClauses,t=a.__popupMinScales,k=a.__popupMaxScales,v=a.__resourceInfo,w=[];b.forEach(a.__popups,function(d,h){if(d){var n,r=[];b.forEach(d.fieldInfos,function(a){"shape"!==a.fieldName.toLowerCase()&&r.push(a.fieldName)});if(a.dynamicLayerInfos&&0<
a.dynamicLayerInfos.length){var q=b.filter(a.dynamicLayerInfos,function(a){return p[h]==a.id})[0].source;n=new G(e+"/dynamicLayer",{id:a.id+"_"+p[h],source:q,outFields:r,mode:G.MODE_SELECTION,infoTemplate:d&&new g(d),drawMode:!1,visible:a.visible,autoGeneralize:!0});var m=function(b,g){0<s[b].length&&g.setDefinitionExpression(s[b]);if(!u.isDefined(t[b])&&!u.isDefined(k[b]))Na(a,c||v.layers,g,p[b]);else if(u.isDefined(a.minScale)||u.isDefined(a.maxScale)){var d=a.minScale,e=a.maxScale;0==d&&0<t[b]?
d=t[b]:0<d&&0==t[b]||0<d&&0<t[b]&&(d=Math.min(d,t[b]));e=Math.max(e||0,k[b]||0);g.setScaleRange(d,e)}else g.setScaleRange(t[b],k[b])};n.loaded?m(h,n):f.connect(n,"onLoad",function(a){m(h,n)})}else{var x=null,A=e+"/"+p[h];if(l[h].length)A=l[h];else if(c)for(q=0;q<c.length;q++)if(c[q].id===p[h]){x=c[q];break}n=new G(da(A),{id:a.id+"_"+p[h],outFields:r,mode:G.MODE_SELECTION,infoTemplate:d&&new g(d),drawMode:!1,visible:a.visible,resourceInfo:x,autoGeneralize:!0});n.loaded?(0<s[h].length&&n.setDefinitionExpression(s[h]),
Na(a,c||v.layers,n,p[h])):f.connect(n,"onLoad",function(b){0<s[h].length&&n.setDefinitionExpression(s[h]);Na(a,c||v.layers,b,p[h])})}w.push(n)}});0<w.length&&(f.connect(a,"onVisibilityChange",q.hitch(this,function(a,c){b.forEach(a,function(a){c?a.show():a.hide()})},w)),f.connect(d,"onLayerRemove",q.hitch(this,function(a,c,g){a.id===g.id&&b.forEach(c,function(a){d.removeLayer(a)})},a,w)));delete a.__popups;delete a.__popupIds;delete a.__popupUrls;delete a.__popupWhereClauses;delete a.__popupMinScales;
delete a.__popupMaxScales;delete a.__resourceInfo;return w}function Ta(a){return t({url:da(a.url+"/layers"),content:{f:"json"},callbackParamName:"callback",error:function(){}})}function Qa(a,c,g){var e=[];b.forEach(a,function(a){var b=a.__popups;b&&(1<b.length&&10<=a.version)&&(a.__deferredsPos=e.length,e.push(Ta(a)))});var p=[];0<e.length?(new d(e)).addCallback(function(d){b.forEach(a,function(a){a.__popups&&0<a.__popups.length&&(a.__deferredsPos||0===a.__deferredsPos?(p=p.concat(ia(a,d[a.__deferredsPos][1].layers,
g,c)),delete a.__deferredsPos):p=p.concat(ia(a,null,g,c)))});c.addLayers(p)}):(b.forEach(a,function(a){a.__popups&&0<a.__popups.length&&(p=p.concat(ia(a,null,g,c)))}),c.addLayers(p))}function Ua(a){b.forEach(a,function(a){var c=a.layer;c.toJson&&(a=c.toJson(),a.featureSet&&(c.name&&-1<c.name.indexOf("Text"))&&b.forEach(a.featureSet.features,function(a,b){if(a.attributes.TEXT){var g=c.graphics[b];g.symbol.setText(a.attributes.TEXT);a.symbol.horizontalAlignment&&(g.symbol.align=a.symbol.horizontalAlignment);
g.setSymbol(g.symbol);g.setAttributes(a.attributes)}},this))})}function hb(a){var c=6;b.forEach(a,function(a){if(a=a.renderer)"esri.renderer.SimpleRenderer"===a.declaredClass?((a=a.symbol)&&a.xoffset&&(c=Math.max(c,Math.abs(a.xoffset))),a&&a.yoffset&&(c=Math.max(c,Math.abs(a.yoffset)))):("esri.renderer.UniqueValueRenderer"===a.declaredClass||"esri.renderer.ClassBreaksRenderer"===a.declaredClass)&&b.forEach(a.infos,function(a){(a=a.symbol)&&a.xoffset&&(c=Math.max(c,Math.abs(a.xoffset)));a&&a.yoffset&&
(c=Math.max(c,Math.abs(a.yoffset)))})});return c}function Ma(a){var c=this,g=c.infoWindow,d=a.graphic;if(c.loaded){g.hide();g.clearFeatures();var e=[];b.forEach(c.graphicsLayerIds,function(a){if((a=c.getLayer(a))&&a instanceof G&&a.loaded&&a.visible)a.clearSelection(),a.infoTemplate&&!a.suspended&&e.push(a)});b.forEach(c.layerIds,function(a){(a=c.getLayer(a))&&(-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")&&a.loaded&&a.visible&&a.infoTemplate)&&e.push(a)});d=d&&d.getInfoTemplate()?d:null;
if(e.length||d){var p=hb(e),l=a.screenPoint,s=c.toMap(new v(l.x-p,l.y+p)),p=c.toMap(new v(l.x+p,l.y-p)),s=new w(s.x,s.y,p.x,p.y,c.spatialReference),t=new E;t.geometry=s;t.timeExtent=c.timeExtent;var k=!0,s=b.map(e,function(b){var c;-1!==b.declaredClass.indexOf("ArcGISImageServiceLayer")?(t.geometry=a.mapPoint,k=!1,c=b.queryVisibleRasters(t,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),c.addCallback(function(){return b.getVisibleRasters()})):(c=b.selectFeatures(t),c.addCallback(function(){return b.getSelectedFeatures()}));
return c});d&&(p=new n,p.callback([d]),s.splice(0,0,p));if(!b.some(s,function(a){return-1===a.fired})){var h=d?1:0;b.forEach(e,function(a){h=-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")?h+a.getVisibleRasters().length:h+a.getSelectedFeatures().length});if(!h)return}g.setFeatures(s);g.show(a.mapPoint,{closestFirst:k})}}}function Ka(a,b){var d=b.mapOptions||{},e;d.infoWindow||(e=new K({visibleWhenEmpty:!1},c.create("div")),d.infoWindow=e);!u.isDefined(d.showInfoWindowOnClick)&&!b.usePopupManager&&
(d.showInfoWindowOnClick=!1);d=new g(a,d);f.connect(d,"onLayersAddResult",Ua);return d}function Q(a,c,g,d,e,p){var l,s,t,k;d.map?(l=d.map,s=d.clickEventHandle,t=d.clickEventListener,k=d.errors):(l=Ka(d,e),!e.ignorePopups&&(!e.disableClickBehavior&&!e.usePopupManager)&&(s=f.connect(l,"onClick",Ma),t=Ma));l.addLayers(a);!e.ignorePopups&&!e.usePopupManager&&Qa(a,l,e._clazz);var v=k||[];b.forEach(c,function(a){a.errors&&(v=v.concat(a.errors))},this);l.loaded?p.callback({map:l,itemInfo:g,errors:v,clickEventHandle:s,
clickEventListener:t}):f.connect(l,"onLoad",function(){p.callback({map:l,itemInfo:g,errors:v,clickEventHandle:s,clickEventListener:t})})}function na(a,c,g,d,e){var p=[];b.forEach(e,function(a){q.isArray(a.layerObject)?b.forEach(a.layerObject,function(a){p.push(a)}):p.push(a.layerObject)});if("BingMapsAerial"===e[0].type||"BingMapsRoad"===e[0].type||"BingMapsHybrid"===e[0].type)var l=setInterval(function(){if(e[0].layerObject&&e[0].layerObject.loaded)clearInterval(l),Ea(a,c,g,d,e,p);else if(e[0].errors){clearInterval(l);
var b="";e[0].errors&&e[0].errors.length&&(b=" ("+e[0].errors[0].message+")");d.errback(Error(J.arcgis.utils.baseLayerError+b))}},10);else if(!p[0]&&e[0].baseMapLayer){var s="";e[0].errors&&e[0].errors.length&&(s=" ("+e[0].errors[0].message+")");d.errback(Error(J.arcgis.utils.baseLayerError+s))}else Ea(a,c,g,d,e,p)}function Ea(a,c,g,d,e,s){try{var t=g.mapOptions||{};g.mapOptions=t;var k=a.item;s=b.filter(s,u.isDefined);if(k)if(k.extent&&k.extent.length)if(t.extent)Q(s,e,a,c,g,d);else{var v=new w(k.extent[0][0],
k.extent[0][1],k.extent[1][0],k.extent[1][1],new p({wkid:4326})),h=s[0].spatialReference;4326===h.wkid?(t.extent=v,Q(s,e,a,c,g,d)):102100===h.wkid||102113===h.wkid||3857===h.wkid?(v.xmin=Math.max(v.xmin,-180),v.xmax=Math.min(v.xmax,180),v.ymin=Math.max(v.ymin,-89.99),v.ymax=Math.min(v.ymax,89.99),t.extent=y.geographicToWebMercator(v),Q(s,e,a,c,g,d)):g.geometryServiceURL||l.defaults.geometryService?(g.geometryServiceURL?new C(g.geometryServiceURL):l.defaults.geometryService).project([v],h,function(b){b=
b[0];t.extent=t.extent||b;Q(s,e,a,c,g,d)},function(){Q(s,e,a,c,g,d)}):d.errback(Error(J.arcgis.utils.geometryServiceError))}else Q(s,e,a,c,g,d);else Q(s,e,a,c,g,d)}catch(f){d.errback(f)}}function Z(a){var c=[];b.forEach(a.operationalLayers,function(a){a.featureCollection?c.push({featureCollection:a.featureCollection,visibility:a.visibility,title:a.title}):a.layerObject&&c.push({layer:a.layerObject,visibility:a.visibility,title:a.title})});return c}function Fa(a){var c=[];a=a.baseMap.baseMapLayers.concat(a.operationalLayers);
b.forEach(a,function(a){var g={};if(a.featureCollection&&"CSV"!==a.type)!0===a.featureCollection.showLegend&&b.forEach(a.featureCollection.layers,function(b){if(!1!==b.showLegend){var d=b.layerObject.renderer;g={layer:b.layerObject,title:a.title,defaultSymbol:d&&d.defaultSymbol&&d.defaultLabel?!0:!1};1<a.featureCollection.layers.length&&(g.title+=" - "+b.layerDefinition.name);c.push(g)}});else if(a.baseMapLayer&&!0===a.showLegend&&a.layerObject||!a.baseMapLayer&&!1!==a.showLegend&&a.layerObject&&
!(a.layerObject instanceof G&&a.layerObject.mode===G.MODE_SELECTION)){var d=a.layerObject.renderer,e=a.layerObject.declaredClass,d=!d||d&&d.defaultSymbol&&d.defaultLabel?!0:!1;if(10.1>a.layerObject.version&&("esri.layers.ArcGISDynamicMapServiceLayer"===e||"esri.layers.ArcGISTiledMapServiceLayer"===e)||"esri.layers.ArcGISImageServiceLayer"===e)d=!0;g={layer:a.layerObject,title:a.title,defaultSymbol:d};a.layers&&(e=b.map(b.filter(a.layers,function(a){return!1===a.showLegend}),function(a){return a.id}),
e.length&&(g.hideLayers=e));c.push(g)}});return c}function Ha(c,g){function d(a,c){b.forEach(a,function(a,b){switch(a){case ob:ha=c[b];break;case Da:z=c[b];break;case pb:$=c[b];break;case qb:ea=c[b];break;case ab:ka=c[b];break;case ta:W=c[b];break;case rb:Y=c[b];break;case xb:L=c[b];break;case bb:Ab=c[b];break;case kb:Ra=c[b];break;case cb:Wa=c[b];break;case Cb:Db=c[b];break;case db:mb=c[b];break;case yb:Bb=c[b];break;case eb:ub=c[b];break;case Za:wb=c[b];break;case sb:Xa=c[b];break;case tb:ib=c[b];
break;case Ga:jb=c[b];break;case La:Pa=c[b];break;case Ia:nb=c[b];break;case Aa:vb=c[b];break;case Ja:$a=c[b]}})}var e=new n,p=c.itemData,l=[];p.baseMap&&p.baseMap.baseMapLayers&&(l=l.concat(p.baseMap.baseMapLayers));p.operationalLayers&&(l=l.concat(p.operationalLayers));for(var p=b.map(l,function(a){return a&&a.layerType}),s=[],t=[],l=!1,k=0;k<p.length;k++){switch(p[k]){case "ArcGISFeatureLayer":-1===b.indexOf(s,cb)&&s.push(cb);break;case "ArcGISImageServiceLayer":case "ArcGISTiledImageServiceLayer":-1===
b.indexOf(s,Da)&&(s.push(Da),t.push(bb),t.push(db),t.push(eb));break;case "ArcGISImageServiceVectorLayer":-1===b.indexOf(s,pb)&&(s.push(pb),t.push(bb),t.push(db),t.push(eb));break;case "ArcGISMapServiceLayer":case "ArcGISTiledMapServiceLayer":-1===b.indexOf(s,ob)&&(s.push(ob),t.push(ta),t.push(xb),t.push(Cb));break;case "ArcGISStreamLayer":-1===b.indexOf(s,Za)&&s.push(Za);break;case "BingMapsAerial":case "BingMapsHybrid":case "BingMapsRoad":-1===b.indexOf(s,La)&&s.push(La);break;case "CSV":-1===b.indexOf(s,
ab)&&(s.push(ab),t.push(qb));break;case "GeoRSS":-1===b.indexOf(s,rb)&&s.push(rb);break;case "KML":-1===b.indexOf(s,kb)&&s.push(kb);break;case "OpenStreetMap":-1===b.indexOf(s,yb)&&s.push(yb);break;case "VectorTileLayer":-1===b.indexOf(s,Ga)&&(s.push(Ga),a("ie")||t.push(tb));break;case "WebTiledLayer":-1===b.indexOf(s,Ia)&&(s.push(Ia),t.push(sb));break;case "WMS":-1===b.indexOf(s,Aa)&&(s.push(Aa),t.push(Ja));break;default:l=!0}if(l)break}l&&(s=Sa,t=fb);s.length?m(s,function(){d(s,arguments);t.length?
m(t,function(){d(t,arguments);e.resolve()}):e.resolve()}):e.resolve();return e}function ba(a,c,g,d){var e=d.itemData;e.baseMap&&(e.baseMap.baseMapLayers&&e.baseMap.baseMapLayers.length)&&(e.baseMap.baseMapLayers[0].firstLayer=!0);var p=c.layerMixins,l=p&&p.length;if(l){var s=function(a){for(var b=0;b<l;b++){var c=p[b];if(c.mixin)if(c.hasOwnProperty("id")){if(a.id===c.id){q.mixin(a,c.mixin);break}}else if(a.url===c.url){q.mixin(a,c.mixin);break}}};b.forEach(e.baseMap&&e.baseMap.baseMapLayers,s);b.forEach(e.operationalLayers,
s)}Ha(d,c).then(function(){return S(d,c)}).then(function(){return R(d,c)}).then(function(c){var d=c[0],e=c[1];if(!d.itemData.operationalLayers||0===d.itemData.operationalLayers.length)B(d,e).addCallback(function(b){Ba(b.itemData,e).addCallback(q.hitch(null,na,b,a,e,g))});else{var p=new n,l=d.itemData.baseMap.baseMapLayers.slice(),s=b.filter(d.itemData.baseMap.baseMapLayers,function(a){return!a.isReference});c={item:d.item,itemData:{baseMap:{baseMapLayers:s}}};d.itemData.baseMap.baseMapLayers=b.filter(d.itemData.baseMap.baseMapLayers,
function(a){return a.isReference});B(c,e).addCallback(function(b){Ba(b.itemData,e).addCallback(q.hitch(null,na,b,a,e,p))});p.then(function(a){B(d,e).addCallback(function(b){Ba(b.itemData,e,a.map.spatialReference,s,a.map).addCallback(function(c){b.itemData.baseMap.baseMapLayers=l;na(b,a,e,g,c)})})},q.hitch(g,g.errback))}})}function Oa(a,b){"undefined"===typeof b&&(b=!0);M._arcgisUrl&&0<M._arcgisUrl.length&&(M.arcgisUrl=M._arcgisUrl);var c=M.arcgisUrl+"/"+a,g={},d=new n;t({url:c,content:{f:"json"},
callbackParamName:"callback",load:function(a){g.item=a;b?t({url:c+"/data",content:{f:"json"},callbackParamName:"callback",load:function(a){g.itemData=a;d.callback(g)},error:function(a){d.errback(a)}}):d.callback(g)},error:function(a){d.errback(a)}});return d}var M,ha,z,$,ea,ka,W,Y,L,Ab,Ra,Wa,Db,mb,Bb,ub,wb,Xa,ib,jb,Pa,nb,vb,$a,ob="../layers/ArcGISDynamicMapServiceLayer",Da="../layers/ArcGISImageServiceLayer",pb="../layers/ArcGISImageServiceVectorLayer",qb="./csv",ab="../layers/CSVLayer",ta="../layers/DynamicLayerInfo",
rb="../layers/GeoRSSLayer",xb="../layers/ImageParameters",bb="../layers/ImageServiceParameters",kb="../layers/KMLLayer",cb="../layers/LabelClass",Cb="../layers/LayerDrawingOptions",db="../layers/MosaicRule",yb="../layers/OpenStreetMapLayer",eb="../layers/RasterFunction",Za="../layers/StreamLayer",sb="../layers/TileInfo",tb="../layers/vector-tile",Ga="../layers/VectorTileLayer",La="../virtualearth/VETiledLayer",Ia="../layers/WebTiledLayer",Aa="../layers/WMSLayer",Ja="../layers/WMSLayerInfo",Sa=[ob,
Da,pb,ab,rb,kb,cb,yb,Za,Ga,La,Ia,Aa],fb=[qb,ta,xb,bb,Cb,db,eb,sb,tb,Ja];M={arcgisUrl:location.protocol+"//www.arcgis.com/sharing/rest/content/items",getItem:Oa,createMap:function(a,b,c){var g=new n;c=c||{};var d=c.infoTemplateClass;c._clazz=d&&(q.isObject(d)?d:q.getObject(d))||D;q.isString(a)?Oa(a).addCallback(q.hitch(null,ba,b,c,g)).addErrback(q.hitch(g,g.errback)):ba(b,c,g,a);return g},getLayerList:function(a){return a&&a.itemInfo&&a.itemInfo.itemData?Z(a.itemInfo.itemData):[]},getLegendLayers:function(a){return a&&
a.itemInfo&&a.itemInfo.itemData?Fa(a.itemInfo.itemData):[]},_arcgisUrl:null,_getItemProps:B,_getItemData:F,_getBingKey:O,_portalUrlResponse:U,_portalUrlFailure:V,_processFSItemProperties:N,_processSSItemProperties:I,_getLayers:Ba,_preBuildLayerObjects:oa,_buildLayerObjects:ca,_preCreateMap:na,_getMapSR:za,_createMap:Q,_addSelectionLayers:Qa,_createSelectionFeatureLayers:ia,_getServiceInfo:Ca,_getFeatureCollectionItem:wa,_mergeFeatureCollectionItem:va,_projectFeatureCollection:ya,_getLayersInfo:Ta,
_initLayer:ra,_loadAsCached:aa,_loadAsDynamic:ua,_processPopups:fa,_onLayersAddResult:Ua,_sameSpatialReferenceAsBasemap:pa,_sameTilingSchemeAsBasemap:qa,_showPopup:Ma,_calculateClickTolerance:hb,_getVisibleFeatureLayers:ja,_updateLayerScaleInfo:Na,_checkUrl:da,_isHostedService:X,_isAgolService:sa,_getLegendLayers:Fa};q.setObject("arcgis.utils",M,e);return M})},"esri/graphic":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./domUtils ./lang ./InfoTemplate ./geometry/jsonUtils ./symbols/jsonUtils".split(" "),
function(m,q,b,f,n,h,r,k,d){m=m(null,{declaredClass:"esri.Graphic",constructor:function(b,a,e,l){b&&!b.declaredClass?(this.geometry=b.geometry?k.fromJson(b.geometry):null,this.symbol=b.symbol?d.fromJson(b.symbol):null,this.attributes=b.attributes||null,this.infoTemplate=b.infoTemplate?new r(b.infoTemplate):null):(this.geometry=b,this.symbol=a,this.attributes=e,this.infoTemplate=l)},_shape:null,_graphicsLayer:null,_visible:!0,visible:!0,getDojoShape:function(){return this._shape},getShapes:function(){var b=
[];this._shape&&b.push(this._shape);this._bgShape&&b.push(this._bgShape);return b},getNode:function(){var b=this._shape&&this._shape.getNode();return b&&b.nodeType?b:null},getNodes:function(){var b=this.getShapes(),a,d,l=b.length,k=[];for(d=0;d<l;d++)(a=b[d]&&b[d].getNode())&&a.nodeType&&k.push(a);return k},getLayer:function(){return this._layer},draw:function(){var b=this._graphicsLayer;b&&b._draw(this,!0);return this},setGeometry:function(b){this.geometry=b;if(b=this._graphicsLayer)b._updateExtent(this),
b._draw(this,!0);return this},setSymbol:function(b,a){var d=this._graphicsLayer,l=this._shape;this.symbol=b;d&&(a&&l&&d._removeShape(this),d._draw(this,!0));return this},setAttributes:function(b){this.attributes=b;return this},setInfoTemplate:function(b){this.infoTemplate=b;return this},getInfoTemplate:function(){return this._getEffInfoTemplate()},_getEffInfoTemplate:function(){var b=this.getLayer();return this.infoTemplate||b&&b.infoTemplate},getTitle:function(){var b=this.getInfoTemplate(),a=b&&
b.title;if(q.isFunction(a))a=a.call(b,this);else if(q.isString(a))var d=(b=this.getLayer())&&b._getDateOpts,a=h.substitute(this.attributes,a,{first:!0,dateFormat:d&&d.call(b)});return a},getContent:function(){var b=this.getInfoTemplate(),a=b&&b.content;if(q.isFunction(a))a=a.call(b,this);else if(q.isString(a))var d=(b=this.getLayer())&&b._getDateOpts,a=h.substitute(this.attributes,a,{dateFormat:d&&d.call(b)});return a},attr:function(b,a){var d=this.getNodes(),l,k=d.length;for(l=0;l<k;l++)null==a?
d[l].removeAttribute(b):d[l].setAttribute(b,a);return this},show:function(){this.visible=this._visible=!0;var b,a,d;if(this.getShapes().length){b=this.getNodes();d=b.length;this.attr("data-hidden");for(a=0;a<d;a++)n.show(b[a])}else this._graphicsLayer&&this._graphicsLayer._draw(this,!0);return this},hide:function(){this.visible=this._visible=!1;var b=this._graphicsLayer,a,d;if(b)if("canvas-2d"===b.surfaceType)b._removeShape(this);else if(b=this.getNodes(),d=b.length){this.attr("data-hidden","");for(a=
0;a<d;a++)n.hide(b[a])}return this},toJson:function(){var b={};this.geometry&&(b.geometry=this.geometry.toJson());this.attributes&&(b.attributes=q.mixin({},this.attributes));this.symbol&&(b.symbol=this.symbol.toJson());this.infoTemplate&&(b.infoTemplate=this.infoTemplate.toJson());return b}});m.prototype.getShape=m.prototype.getDojoShape;b("extend-esri")&&(f.Graphic=m);return m})},"esri/PluginTarget":function(){define("require dojo/aspect dojo/_base/array dojo/_base/lang dojo/Deferred dojo/when".split(" "),
function(m,q,b,f,n,h){function r(){q.after(this.constructor._meta,"ctor",this._pluginsHandler,!0);this._plugins={}}r.prototype={addPlugin:function(b,d){var c=this,a=this._plugins,e=new n;try{m([b],function(l){b in a?e.resolve({id:a[b].declaredId||b.replace(/\//g,".")}):(a[b]=l,h(l.add(c,d),function(){var a={id:l.declaredId||b.replace(/\//g,".")};c.emit("plugin-add",a);e.resolve(a)},function(a){e.reject(a)}))})}catch(l){e.reject(l)}return e.promise},removePlugin:function(b){if(b in this._plugins){var d=
this._plugins[b];d.remove(this);delete this._plugins[b];this.emit("plugin-remove",{id:d.declaredId||b.replace(/\//g,".")})}},_pluginsHandler:function(){var k=this;b.some(arguments,function(b){if(b&&b.plugins&&b.plugins instanceof Array){b=b.plugins;var c,a,e;for(e=0;e<b.length;e++)c=b[e],a=c instanceof Object?c.id:c,k.addPlugin(a,c.options);return!0}})}};return r})},"esri/layers/GraphicsLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom dojox/gfx dojox/gfx/matrix ./gfxSniff!esri-svg?dojox/gfx/filters ./layer ../kernel ../lang ../sniff ../Color ../domUtils ../symbols/MarkerSymbol ../symbols/SimpleMarkerSymbol ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/mathUtils ../geometry/screenUtils ../PluginTarget ./gfxSniff!esri-svg?dojox/gfx/svgext".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e,l,u,t,p,g,s,v,w,y,A,x,D,K){var E,C=-1!==d.renderer.toLowerCase().indexOf("svg"),H=-1!==d.renderer.toLowerCase().indexOf("canvas"),G=9>t("ie"),J=t("esri-touch");s=m(null,{declaredClass:"esri.layers._GraphicsContainer",_setMap:function(a,b){var c,g=this._connects=[];this._map=a;H?(c=h.create("div",{style:"overflow: visible; position: absolute;"},b),this._surface={getEventSource:function(){return c}},g.push(q.connect(c,"onmousedown",this,this._canvasDownHandler)),g.push(q.connect(c,
"onmouseup",this,this._canvasUpHandler)),g.push(q.connect(c,"onclick",this,this._canvasClickHandler)),E.prototype._canvas=!0):(c=(this._surface=d.createSurface(b,a.width,a.height)).getEventSource(),r.set(c=G?c.parentNode:c,{overflow:"visible",position:"absolute"}));g.push(q.connect(a,"onResize",this,"_onResizeHandler"));return c},_onResizeHandler:function(a,b,c){a=this._surface.getEventSource();var g=this._map,d;G&&r.set(a=a.parentNode,{width:b+"px",height:c+"px",clip:"rect(0px "+b+"px "+c+"px 0px)"});
n.set(a,"width",b);n.set(a,"height",c);this._surface.declaredClass||f.forEach(a.childNodes,function(a){n.set(a,"width",b);n.set(a,"height",c)});g.loaded&&(g.graphics.suspended||(g.graphics._resized=!0),f.forEach(g.graphicsLayerIds,function(a){d=g.getLayer(a);d.suspended||(d._resized=!0);d._updateSVGFilters(null,null,b,c)}))},_cleanUp:function(){f.forEach(this._connects,q.disconnect,q);this._map=this._surface=null},_processEvent:function(a){var b=this._map;a.screenPoint=new y(a.pageX-b.position.x,
a.pageY-b.position.y);a.mapPoint=b.toMap(a.screenPoint)},_canvasDownHandler:function(a){this._processEvent(a);this._downPt=a.screenPoint.x+","+a.screenPoint.y},_canvasUpHandler:function(a){this._processEvent(a);this._upPt=a.screenPoint.x+","+a.screenPoint.y},_tolerance:15,_isPrimaryMatch:function(a,b,c,g){if(!a.visible||!b)return!1;var d=b.getTransformedBoundingBox(),e;return d?(e=new A(d[0].x,d[0].y,d[2].x,d[2].y),delete e.spatialReference,J?e.intersects(c):e.contains(g)):f.some(b.children||[],function(a){d=
a.getTransformedBoundingBox();e=new A(d[0].x,d[0].y,d[2].x,d[2].y);delete e.spatialReference;return J?e.intersects(c):e.contains(g)})},_canvasClickHandler:function(a){if(this._downPt&&this._upPt&&this._downPt===this._upPt){this._processEvent(a);var b=this._map,c=f.map(b.graphicsLayerIds,function(a){return b.getLayer(a)});c.push(b.graphics);c.reverse();var c=f.filter(c,function(a){return a.loaded&&a._mouseEvents&&!a.suspended&&(!u.isDefined(a.opacity)||0<a.opacity)}),g=a.screenPoint,d=this._tolerance,
e=g.x-d,p=g.y+d,l=g.x+d,d=g.y-d,s=new A(e,d,l,p),e=b.toMap(new y(e,p)),l=b.toMap(new y(l,d)),p=e.spatialReference._getInfo(),t=new A(A.prototype._normalizeX(e.x,p).x,e.y,A.prototype._normalizeX(l.x,p).x,l.y,e.spatialReference),k;delete s.spatialReference;f.some(c,function(a){a=f.filter(a.graphics,function(a){return this._isPrimaryMatch(a,a.getDojoShape(),s,g)||!(!a._bgShape||!this._isPrimaryMatch(a,a._bgShape,s,g))},this);a.reverse();if(0<a.length){var b;f.some(a,function(a){return a.geometry&&t.intersects(a.geometry)?
(b=a,!0):!1});if(b)return k=b,!0}return!1},this);if(k&&(c=k.getLayer()))a.graphic=k,c.onClick(a)}}});E=m(e,{declaredClass:"esri.layers._GraphicsLayer",managedSuspension:!0,surfaceType:H?"canvas-2d":d.renderer,_eventMap:{"graphic-add":["graphic"],"graphic-remove":["graphic"],"renderer-change":["renderer"]},constructor:function(a,c){if(a&&(b.isString(a)||b.isObject(a)&&(a.layerDefinition||a.query)))a=c;this._params=b.mixin({displayOnPan:!0,drawMode:!0,styling:!0},a||{});var g=this._params.dataAttributes;
"string"===typeof g&&(g=[g]);this.styling=C?this._params.styling:!0;this.dataAttributes=g;this.infoTemplate=a&&a.infoTemplate;this.graphics=[];this._draw=b.hitch(this,this._draw);this._refresh=b.hitch(this,this._refresh);this.registerConnectEvents()},getNode:function(){return this._div&&this._div.getEventSource()},setDrawMode:function(a){this._params.drawMode=a},renderer:null,_setMap:function(a,c){this.inherited(arguments);this._map=a;this._wrap=a.wrapAround180;this._srInfo=a.spatialReference._getInfo();
this._svgFilters={};this._canvas?(c=d.createSurface(c.getEventSource(),a.width,a.height),r.set(c.rawNode,"position","absolute"),this._div=c.createGroup(),this._renderProto=this._div.constructor.prototype._render,this._div._render=b.hitch(this,this._canvasRender)):this._div=c.createGroup();this._bgGroup=this._div.createGroup();this._div.getEventSource().id=this.id+"_layer";var g=this.opacity;u.isDefined(g)&&1>g&&this.setOpacity(g,!0);return this._div},_unsetMap:function(a,b){f.forEach(this.graphics,
function(a){a._shape=null});this._canvas?(b=this._div.getParent(),b._parent={},h.destroy(b.rawNode),b.destroy()):(this._div.clear(),b.remove(this._div),h.destroy(this._div.getEventSource()));this._map=this._div=this._svgFilters=null;clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_onZoomStartHandler:function(){g.hide(this._div.getEventSource())},_onExtentChangeHandler:function(a,b,c,d){clearTimeout(this._wakeTimer);this._wakeTimer=null;c?
(a=this._map.__visibleRect,b=this._div,this._evalSDRenderer(),this._refresh(!0),this._updateTransform(b,a.x,a.y,!0),this._renderProto&&b.surface.pendingRender?this._dirty=!0:this.suspended||g.show(b.getEventSource())):this._resized&&(this._refresh(!1),this._resized=!1);if(0<this.graphics.length)this.onUpdate()},_canvasRender:function(){var a=this._div;this._dirty&&(delete this._dirty,this.suspended||g.show(a.getEventSource()));return this._renderProto.apply(a,arguments)},_refresh:function(a){var b=
this.graphics,c=b.length,g,d=this._draw;for(g=0;g<c;g++)d(b[g],a)},refresh:function(){this._refresh(!0)},redraw:function(){this._refresh(!0)},_onPanHandler:function(a,b){this._panDx=b.x;this._panDy=b.y;var c=this._map.__visibleRect;this._updateTransform(this._div,c.x+b.x,c.y+b.y)},_onPanEndUpdateHandler:function(a,b){var c=this._map.__visibleRect;!this._params._child&&(b.x!==this._panDx||b.y!==this._panDy)?this._updateTransform(this._div,c.x,c.y,!0):this._updateSVGFilters(-c.x,-c.y);this._refresh(!1);
if(this.graphics.length)this.onUpdate()},_onPanStartHandler:function(){g.hide(this._div.getEventSource())},_onPanEndHandler:function(){var a=this._map.__visibleRect,b=this._div;this._updateTransform(b,a.x,a.y,!0);this._refresh(!1);this._renderProto&&b.surface.pendingRender?this._dirty=!0:g.show(b.getEventSource());if(this.graphics.length)this.onUpdate()},_updateTransform:function(a,b,g,d){a.setTransform(c.translate({x:b,y:g}));d&&this._updateSVGFilters(-b,-g)},onSuspend:function(){this.inherited(arguments);
g.hide(this._div.getEventSource());clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(a){this.inherited(arguments);a.firstOccurrence&&this._evalSDRenderer();this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(b.hitch(this,function(){this.suspended||this._onExtentChangeHandler(null,null,!0)}),0)},_enableDrawConnectors:function(){var a=this._map,b=q.connect;this._disableDrawConnectors();this._params.displayOnPan?(this._params._child||
(this._onPanHandler_connect=b(a,"onPan",this,"_onPanHandler")),this._onPanEndHandler_connect=b(a,"onPanEnd",this,"_onPanEndUpdateHandler")):(this._onPanStartHandler_connect=b(a,"onPanStart",this,"_onPanStartHandler"),this._onPanEndHandler_connect=b(a,"onPanEnd",this,"_onPanEndHandler"));this._onZoomStartHandler_connect=b(a,"onZoomStart",this,"_onZoomStartHandler");this._onExtentChangeHandler_connect=b(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=q.disconnect;
a(this._onExtentChangeHandler_connect);a(this._onZoomStartHandler_connect);a(this._onPanHandler_connect);a(this._onPanStartHandler_connect);a(this._onPanEndHandler_connect);this._onExtentChangeHandler_connect=this._onZoomStartHandler_connect=this._onPanHandler_connect=this._onPanStartHandler_connect=this._onPanEndHandler_connect=null},_updateExtent:function(a){var b=a.geometry;if(b){if(!(a._extent=b.getExtent())){var c,g;if("esri.geometry.Point"===b.declaredClass)c=b.x,g=b.y;else if("esri.geometry.Multipoint"===
b.declaredClass)c=b.points[0][0],g=b.points[0][1];else{a._extent=null;return}a._extent=new A(c,g,c,g,b.spatialReference)}}else a._extent=null},_intersects:function(a,b,c){var g=a.spatialReference,d=b.spatialReference,e=g&&d&&!g.equals(d)&&g._canProject(d)&&4326===d.wkid;if(this._wrap&&!c){c=[];var g=a._getFrameWidth(),p=this._srInfo,l=a._clip?a._getAvailExtent():a.extent,s,t,k,v,h=[];s=b._partwise;e&&(l=a.geographicExtent,p=d._getInfo());a=l._getParts(p);if(s&&s.length){b=[];d=0;for(e=s.length;d<
e;d++)b=b.concat(s[d]._getParts(p))}else b=b._getParts(p);d=0;for(e=b.length;d<e;d++){k=b[d];p=0;for(l=a.length;p<l;p++)if(v=a[p],v.extent.intersects(k.extent)){s=0;for(t=k.frameIds.length;s<t;s++)c.push((v.frameIds[0]-k.frameIds[s])*g)}}d=0;for(e=c.length;d<e;d++)s=c[d],f.indexOf(c,s)===d&&h.push(s);return h.length?h:null}return(e?a.geographicExtent:a.extent).intersects(b)?[0]:null},_defaultMarker:{type:"simplemarkersymbol",style:"square",size:1,xoffset:0,yoffset:0,angle:0},_draw:function(a,b){if(this._params.drawMode&&
this._map&&!this.suspended)try{var c=a._extent,g,d,e=!C||this.styling,p=C&&this.dataAttributes,l=a.getDojoShape(),s;if(a.visible&&c&&(g=this._intersects(this._map,c,a.geometry._originOnly))&&(d=e?this._getSymbol(a):this._defaultMarker)){if(!a._offsets||a._offsets.join(",")!==g.join(",")?a._offsets=g:s=!0,!l||b||!s){var t=a.geometry.type,c={graphic:a},k=a._bgShape,v=e&&!a.symbol?this._getRenderer(a):null,h=v&&v.backgroundFillSymbol;if("point"===t)this._isInvalidShape(d,l)&&this._removeShape(a),a._shape=
this._drawPoint(this._div,a.geometry,d,a.getDojoShape(),g,v,a),e&&this._symbolizePoint(a.getDojoShape(),d,v,a);else if("multipoint"===t)this._drawMarkers(a,d,g,v),e&&this._symbolizeMarkers(a,d,v);else{var w,t=d,f,n;e&&(t=(w="simplemarkersymbol"===d.type||"picturemarkersymbol"===d.type||"textsymbol"===d.type?d:null)?h:d);t&&t===h&&(f=this._bgGroup);k&&!f&&this._removeBgShape(a);t&&(!f&&this._isInvalidShape(t,a._shape)&&this._removeShape(a,!1),n=this._drawShape(a,g,f||this._div,f?k:a.getDojoShape()),
e&&this._symbolizeShape(n,t,v,!!h,a),a[f?"_bgShape":"_shape"]=n);if(w){this._isInvalidShape(w,a._shape)&&this._removeShape(a,!1);var r=a.geometry.getCentroid();(n=r&&this._drawPoint(this._div,r,w,a._shape,g,v,a))&&this._symbolizePoint(n,w,v,a);a._shape=n}}H||(a._bgShape&&this._initNode(a,a._bgShape,a._bgShape!==k,c,p),a._shape&&this._initNode(a,a._shape,a._shape!==l,c,p));c.node=a.getNode();this.onGraphicDraw(c)}}else l&&this._removeShape(a)}catch(u){this._errorHandler(u,a)}},_initNode:function(a,
b,c,g,d){if(b=b&&b.getNode())b.e_graphic=a,this._addDataAttrs(a,d,b),c&&(g.node=b,this.onGraphicNodeAdd(g))},_removeShape:function(a,b){var c=a.getDojoShape(),g=c&&c.getNode();c&&(c.removeShape(),c.destroy());a._shape=a._offsets=null;!1!==b&&this._removeBgShape(a);if(g&&(g.e_graphic=null,!H))this.onGraphicNodeRemove({graphic:a,node:g})},_removeBgShape:function(a){var b=a._bgShape,c=b&&b.getNode();b&&(b.removeShape(),b.destroy(),a._bgShape=null);if(c&&(c.e_graphic=null,!H))this.onGraphicNodeRemove({graphic:a,
node:c})},_addDataAttrs:function(a,b,c){var g=a.attributes,d,e=b?b.length:0,p=this._getRenderer(a);if(c&&g){for(d=0;d<e;d++)(c=b[d])&&a.attr("data-"+c,g[c]);!this.styling&&p&&(p.getBreakIndex?(b=p.getBreakIndex(a),a.attr("data-class-break",-1!==b?b:null)):p.getUniqueValueInfo&&(b=p.getUniqueValueInfo(a),a.attr("data-unique-value",b?b.value:null)))}},_drawShape:function(a,b,c,g){a=a.geometry;var d=a.type,e=this._map,p=e.extent,l=e.width,s=e.height,e=e.__visibleRect,t=[],k,v;k="extent"===d;if("rect"===
d||k)t={x:0,y:0,spatialReference:a.spatialReference},t.x=k?a.xmin:a.x,t.y=k?a.ymax:a.y,d=D.toScreenPoint(p,l,s,t),t.x=k?a.xmax:a.x+a.width,t.y=k?a.ymin:a.y+a.height,a=D.toScreenPoint(p,l,s,t),b={x:d.x-e.x+b[0],y:d.y-e.y,width:Math.abs(a.x-d.x),height:Math.abs(a.y-d.y)},0===b.width&&(b.width=1),0===b.height&&(b.height=1),g=this._drawRect(c,g,b);else if("polyline"===d||"polygon"===d){k=0;for(v=b.length;k<v;k++)t=t.concat(D._toScreenPath(p,l,s,a,-e.x+b[k],-e.y));g=this._drawPath(c,g,t);this._rendererLimits&&
("polyline"===d?this._clipPolyline(g,a):this._clipPolygon(g,a))}return g},_drawRect:function(a,b,c){return b?b.setShape(c):a.createRect(c)},_drawImage:function(a,b,c){return b?b.setShape(c):a.createImage(c)},_drawCircle:function(a,b,c){return b?b.setShape(c):a.createCircle(c)},_drawPath:function(){return G?function(a,b,c,g){c=g?c:c.join(" ");if(b)return b.setShape(c);b=a.createObject(g?d.Path:d.EsriPath,c);a._overrideSize(b.getEventSource());return b}:function(a,b,c,g){c=g?c:c.join(" ");return b?
b.setShape(c):a.createPath(c)}}(),_drawText:function(a,b,c){return b?b.setShape(c):a.createText(c)},_evalSDRenderer:function(a){var b=this._map,c=this.renderer,g,d=this._rndForScale;b&&(b.loaded&&c&&c.getRendererInfo)&&(g="zoom"===c.rangeType?c.getRendererInfoByZoom(b.getZoom()):c.getRendererInfoByScale(b.getScale()));this._rndForScale=g&&g.renderer;!a&&this._rndForScale!=d&&this.emit("renderer-change",{renderer:this._rndForScale})},_getRenderer:function(a){var b=this._rndForScale||this.renderer;
a&&(b&&b.getObservationRenderer)&&(b=b.getObservationRenderer(a));return b},_getSymbol:function(a){var b=this._getRenderer();return a.symbol||b&&b.getSymbol(a)},_getVariable:function(a,b,c){var g;a&&(g=(a=a.getVisualVariablesForType(b,c))&&a[0]);return g},_applyOpacity:function(a,b,c,g){b=b.getOpacity(g,{opacityInfo:c});null!=b&&(a=new p(a),a.a=b);return a},_symbolizeShape:function(a,c,g,d,e){var p=c.getStroke(),l=c.getFill(),s=c.type,t,k,v=this._getVariable(g,"sizeInfo",!1),h=this._getVariable(g,
"colorInfo",!1),w=this._getVariable(g,"opacityInfo",!1),f=-1!==s.indexOf("linesymbol");c=f?"none"!==c.style:c.outline&&"none"!==c.outline.style;var n=f?null:this._getVariable(g,"sizeInfo","outline"),v=(v=d?n:n||v)?g.getSize(e,{sizeInfo:v,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null;d&&(h=w=null);if((h||w)&&"picturefillsymbol"!==s)f?(t=p&&p.color,h&&(t=g.getColor(e,{colorInfo:h})||t),t&&w&&(t=this._applyOpacity(t,g,w,e))):l&&l.toCss&&(k=l,h&&(k=g.getColor(e,{colorInfo:h})||
k),k&&w&&(k=this._applyOpacity(k,g,w,e)));a.setStroke(!c||null==v&&!t?p:b.mixin({},p,null!=v?{width:v}:null,t&&{color:t})).setFill(k||l)},_smsToPath:function(){return G?function(a,b,c,g,d,e,p,l,s){switch(b){case a.STYLE_SQUARE:return["M",d+","+p,"L",e+","+p,e+","+l,d+","+l,"X","E"];case a.STYLE_CROSS:return["M",c+","+p,"L",c+","+l,"M",d+","+g,"L",e+","+g,"E"];case a.STYLE_X:return["M",d+","+p,"L",e+","+l,"M",d+","+l,"L",e+","+p,"E"];case a.STYLE_DIAMOND:return["M",c+","+p,"L",e+","+g,c+","+l,d+","+
g,"X","E"];case a.STYLE_TARGET:return["M",d+","+p,"L",e+","+p,e+","+l,d+","+l,d+","+p,"M",d-s+","+g,"L",d+","+g,"M",c+","+(p-s),"L",c+","+p,"M",e+s+","+g,"L",e+","+g,"M",c+","+(l+s),"L",c+","+l,"E"]}}:function(a,b,c,g,d,e,p,l,s){switch(b){case a.STYLE_SQUARE:return["M",d+","+p,e+","+p,e+","+l,d+","+l,"Z"];case a.STYLE_CROSS:return["M",c+","+p,c+","+l,"M",d+","+g,e+","+g];case a.STYLE_X:return["M",d+","+p,e+","+l,"M",d+","+l,e+","+p];case a.STYLE_DIAMOND:return["M",c+","+p,e+","+g,c+","+l,d+","+g,
"Z"];case a.STYLE_TARGET:return["M",d+","+p,e+","+p,e+","+l,d+","+l,d+","+p,"M",d-s+","+g,d+","+g,"M",c+","+(p-s),c+","+p,"M",e+s+","+g,e+","+g,"M",c+","+(l+s),c+","+l]}}}(),_pathStyles:{square:1,cross:1,x:1,diamond:1,target:1},_typeMaps:{picturemarkersymbol:"image",picturefillsymbol:"path",simplefillsymbol:"path",simplelinesymbol:"path",cartographiclinesymbol:"path",textsymbol:"text"},_isInvalidShape:function(a,b){var c=b&&b.shape&&b.shape.type,g=a&&a.type,d=a&&a.style;"rect"===c&&(c="path");g&&
(d=this._typeMaps[g]||d);this._pathStyles[d]&&(d="path");return"shieldlabelsymbol"===g?!0:!(!c||!(d&&c!==d))},_drawPoint:function(a,b,g,d,e,p,l){var s=g.type,t=this._map,k=t.__visibleRect,h=D.toScreenPoint(t.extent,t.width,t.height,b).offset(-k.x+e[0],-k.y),k=h.x,w=h.y,f;b=[];var n,r=this._getVariable(p,"rotationInfo",!1),r=r?p.getRotationAngle(l,{rotationInfo:r}):null,u=this._getVariable(p,"sizeInfo",!1),t=u?p.getSize(l,{sizeInfo:u,shape:g.style,resolution:t.getResolutionInMeters(),scale:t.getScale()}):
null;r&&b.push(c.rotategAt(r,h));if(0!==g.xoffset||0!==g.yoffset)n=c.translate(g.xoffset,-g.yoffset),b.push(n);0!==g.angle&&b.push(c.rotategAt(g.angle,h));if("simplemarkersymbol"===s)switch(f=g.style,p=Math.round,t=null!=t?t:g.size,f){case v.STYLE_SQUARE:case v.STYLE_CROSS:case v.STYLE_X:case v.STYLE_DIAMOND:g=isNaN(t)?16:t/2;f=this._drawPath(a,d,this._smsToPath(v,f,k,w,p(k-g),p(k+g),p(w-g),p(w+g)));break;case v.STYLE_TARGET:l=g._targetWidth/2;h=g._targetHeight/2;f=this._drawPath(a,d,this._smsToPath(v,
f,k,w,p(k-l),p(k+l),p(w-h),p(w+h),g._spikeSize));break;case v.STYLE_PATH:f=this._drawPath(a,d,g.path,!0);g=f.getBoundingBox();a=this._getScaleMatrix(g,t);(1!==a.xx||1!==a.yy)&&b.push(c.scaleAt(a.xx,a.yy,h));b.push(c.translate(-(g.x+g.width/2)+k,-(g.y+g.height/2)+w));break;default:g=isNaN(t)?16:t/2,f=this._drawCircle(a,d,{cx:k,cy:w,r:g})}else if("shieldlabelsymbol"===s)f=g.width,h=g.height,d=a.createGroup(),f=a.createImage({x:k-f/2,y:w-h/2,width:f,height:h,src:g.url}),d.add(f),null!=g.font&&(w+=0.2*
g.getHeight(),a=a.createText({type:"text",text:g.text,x:k,y:w,align:"middle",decoration:g.decoration,rotated:g.rotated,kerning:g.kerning}),a.setFont(g.font),a.setFill(g.color),d.add(a)),f=d;else if("picturemarkersymbol"===s){if(null==t?(f=g.width,h=g.height):(h=t,f=h*(g.width/g.height),n&&(null!=n.dx&&(n.dx=f*(n.dx/g.width)),null!=n.dy&&(n.dy=h*(n.dy/g.height)))),f=this._drawImage(a,d,{x:k-f/2,y:w-h/2,width:f,height:h,src:g.url}),C&&(a=f.getNode()))g=(g=this._getVariable(p,"opacityInfo",!1))?p.getOpacity(l,
{opacityInfo:g}):null,null!=g?a.setAttribute("opacity",g):a.setAttribute("opacity",1)}else"textsymbol"===s&&(p=g.font,null!=t&&p&&(p=new p.constructor(p.toJson()),p.setSize(t)),f=this._drawText(a,d,{type:"text",text:g.text,x:k,y:w,align:g.getSVGAlign(),decoration:g.decoration||p&&p.decoration,rotated:g.rotated,kerning:g.kerning}),p&&f.setFont(p),C&&(a=f.getNode(),k=g.getSVGBaseline(),w=g.getSVGBaselineShift(),a&&(a.setAttribute("dominant-baseline",k),w&&a.setAttribute("baseline-shift",w),this._applyHalo(f,
g.haloColor,g.haloSize))));f.setTransform(c.multiply(b));f._wrapOffsets=e;return f},_applyHalo:function(a,b,c){var g=b&&c?this._getHaloId(b,c):null;a.setFilter(b&&c?t("webkit")||t("ff")?this._getDilateFilter(b,c,g):this._getOffsetFilter(b,c,g):null)},_getDilateFilter:function(b,c,g){var d=this._getSVGFilter(g);d||(d=this._createSVGFilter({id:g},[a.feMorphology({operator:"dilate",radius:c,result:"dilated"}),a.feFlood({"flood-color":b.toCss(!0)}),a.feComposite({in2:"dilated",operator:"in",result:"composite"}),
a.feMerge("composite","SourceGraphic")]));return d},_getOffsetFilter:function(b,c,g){var d=this._getSVGFilter(g);if(!d){b=b.toCss(!0);var d=this._offsetPrimitives,e,p=d.length,l=[],s=[];for(e=0;e<p;e++){var t=d[e],k="offset"+t.dir,v="composite"+t.dir;s.push(v);l.push(a.feOffset({dx:t.dx*c,dy:t.dy*c,"in":"SourceAlpha",result:k}),a.feFlood({"flood-color":b}),a.feComposite({in2:k,operator:"in",result:v}))}s.push("SourceGraphic");l.push(a.feMerge.apply(a.feMerge,s));d=this._createSVGFilter({id:g},l)}return d},
_offsetPrimitives:[{dir:"L",dx:-1,dy:0},{dir:"TL",dx:-1,dy:-1},{dir:"T",dx:0,dy:-1},{dir:"TR",dx:1,dy:-1},{dir:"R",dx:1,dy:0},{dir:"BR",dx:1,dy:1},{dir:"B",dx:0,dy:1},{dir:"BL",dx:-1,dy:1}],_getHaloId:function(a,b){return"halo_"+this._map.id+"_"+this.id+"_"+a.r+"_"+a.g+"_"+a.b+"_"+a.a+"_"+b},_getSVGFilter:function(a){return this._svgFilters[a]},_createSVGFilter:function(b,c){var g=a.createFilter(b,c),d=this._map,e=d.__visibleRect;g.x=-e.x;g.y=-e.y;g.width=d.width;g.height=d.height;return this._svgFilters[b.id]=
g},_updateSVGFilters:function(a,b,c,g){var d=this._svgFilters,e,p,l;for(p in d)if(e=d[p]){if(l=k.byId(p))null!=a&&l.setAttribute("x",a),null!=b&&l.setAttribute("y",b),null!=c&&l.setAttribute("width",c),null!=g&&l.setAttribute("height",g);null!=a&&(e.x=a);null!=b&&(e.y=b);null!=c&&(e.width=c);null!=g&&(e.height=g)}},_getScaleMatrix:function(a,b){var c=a.width/a.height,g=1,d=1;isNaN(b)||(1<c?(g=b/a.width,d=b/c/a.height):(d=b/a.height,g=b*c/a.width));return{xx:g,yy:d}},_symbolizePoint:function(a,c,g,
d){var e=c.type,p=c.style;if(!("shieldlabelsymbol"===e||"picturemarkersymbol"===e)){var l=c.getStroke();c=c.getFill();var p=p===v.STYLE_X||p===v.STYLE_CROSS,s=l&&l.color,t=p?s:c;if(g){var k=this._getVariable(g,"colorInfo",!1),h=this._getVariable(g,"opacityInfo",!1);k&&(t=g.getColor(d,{colorInfo:k})||t);t&&h&&(t=this._applyOpacity(t,g,h,d));t&&(p?t!==s&&(l=l?b.mixin({},l):{},l.color=t):t!==c&&(c=t))}"textsymbol"===e?a.setFill(c):"simplemarkersymbol"===e&&a.setFill(c).setStroke(l)}},_drawMarkers:function(a,
b,c,g){var d=a.geometry,e=d.points,p=a.getDojoShape()||this._div.createGroup(),l,s,t=e.length,k=[],v=0,h,w=c?c.length:0;p.children[0]&&this._isInvalidShape(b,p.children[0])&&p.clear();for(s=0;s<t;s++){l=e[s];for(h=0;h<w;h++)k[0]=c[h],this._drawPoint(p,{x:l[0],y:l[1],spatialReference:d.spatialReference},b,p.children[v++],k,g,a)}b=p.children.length;if(t*c.length<b)for(s=b-1;s>=t*c.length;s--)p.children[s].removeShape();a._shape=p},_symbolizeMarkers:function(a,b,c){var g=a.getDojoShape().children,d,
e=g.length;for(d=0;d<e;d++)this._symbolizePoint(g[d],b,c,a)},_errorHandler:function(a,b){a.message=b?"Unable to draw graphic (geometry:"+(b.geometry?b.geometry.declaredClass:null)+", symbol:"+(b.symbol?b.symbol.declaredClass:null)+"): "+a.message:"Unable to draw graphic (null): "+a.message;this.inherited(arguments)},_rendererLimits:function(){var a,b,c;t("ff")?(a=16125,b=-32250,c=32250):G?(a=1E5,b=-1E5,c=1E5):t("chrome")&&6>t("chrome")&&(a=8150,b=-1E4,c=1E4);if(a)return{clipLimit:a,rangeMin:b,rangeMax:c,
clipBBox:[-a,-a,a,a],clipSegments:[[[-a,-a],[a,-a]],[[a,-a],[a,a]],[[a,a],[-a,a]],[[-a,a],[-a,-a]]]}}(),_clipPolyline:function(a,b){var c=this._getCorners(a,b),g=c.br,d=this._rendererLimits,e=d.rangeMin,p=d.rangeMax,l=d.clipBBox,s=d.clipSegments,d=this._isPointWithinRange,t=this._isPointWithinBBox,k=this._getClipperIntersection,v=this._getPlaneIndex;if(!d(c.tl,e,p)||!d(g,e,p)){G&&this._createSegments(a);var h=[];f.forEach(a.segments,function(a){a=a.args;var b=a.length,c=[],g;for(g=0;g<b;g+=2){var d=
[a[g],a[g+1]],e=[a[g+2],a[g+3]],p=t(d,l),w=t(e,l);if(p^w){if(w=k([d,e],s))p?(g?c.push(w[1]):c.push(d,w[1]),h.push(c),c=[]):c.push(w[1],e)}else p?g?c.push(e):c.push(d,e):(w=v(d,l),p=v(e,l),-1===w||(-1===p||w===p)||(d=k([d,e],s,!0),0<d.length&&(d[w]||(w=d[w[0]]?w[0]:w[1]),d[p]||(p=d[p[0]]?p[0]:p[1]),e=d[w],d=d[p],e&&c.push(e),d&&(c.push(d),h.push(c),c=[]))))}h.push(c)});a.setShape(this._getPathStringFromPaths(h))}},_clipPolygon:function(a,c){var g=this._getCorners(a,c),d=g.br,e=this._rendererLimits,
p=e.clipLimit,l=e.rangeMin,s=e.rangeMax,t=e.clipBBox,k=e.clipSegments,e=this._isPointWithinRange,v=this._isPointWithinBBox,h=this._getClipperIntersection,w=this._getPlaneIndex,n=x._pointLineDistance;if(!e(g.tl,l,s)||!e(d,l,s))G&&this._createSegments(a),g=f.map(a.segments,function(a){var c=a.args,g=c.length,d=[];a=[];var e;for(e=0;e<g;e+=2){var l=[c[e],c[e+1]],s=[c[e+2],c[e+3]];if(e===g-2){d.push(l);break}var r=v(l,t),u=v(s,t);d.push(l);if(r^u){if(u=h([l,s],k))l=u[1],l[r?"inOut":"outIn"]=!0,d.push(l),
a.push([r?"INOUT":"OUTIN",d.length-1,u[0]])}else if(!r){var r=w(l,t),q=w(s,t);-1===r||(-1===q||r===q)||(u=h([l,s],k,!0),0<u.length?(u[r]||(r=u[r[0]]?r[0]:r[1]),u[q]||(q=u[q[0]]?q[0]:q[1]),l=u[r],s=u[q],l&&(l.outIn=!0,d.push(l),a.push(["OUTIN",d.length-1,r])),s&&(s.inOut=!0,d.push(s),a.push(["INOUT",d.length-1,q]))):b.isArray(r)&&b.isArray(q)&&(u=r.concat(q),u.sort(),"0123"===u.join("")&&(u=[],3===r[0]+r[1]?u.push([p,-p],[-p,p]):u.push([-p,-p],[p,p]),r=n(u[0],[l,s]),l=n(u[1],[l,s]),d.push(r<l?u[0]:
u[1]))))}}var m=t[0],x=t[1],A=t[2],C=t[3];f.forEach(d,function(a){a[0]<m&&(a[1]>=x&&a[1]<=C?a[0]=m:(a[0]=m,a[1]=a[1]<x?x:C))});f.forEach(d,function(a){a[1]<x&&(a[0]>=m&&a[0]<=A?a[1]=x:(a[1]=x,a[0]=a[0]<m?m:A))});f.forEach(d,function(a){a[0]>A&&(a[1]>=x&&a[1]<=C?a[0]=A:(a[0]=A,a[1]=a[1]<x?x:C))});f.forEach(d,function(a){a[1]>C&&(a[0]>=m&&a[0]<=A?a[1]=C:(a[1]=C,a[0]=a[0]<m?m:A))});c=0;g=a.length;if(0<g){do{s=a[c];e=a[(c+1)%g];if(s[2]===e[2]&&"INOUT"===s[0]&&"OUTIN"===e[0])if(l=s[1],e=e[1],l<e)for(l+=
1;l<e;l++)d[l][2]=!0;else if(l>e){for(l+=1;l<d.length;l++)d[l][2]=!0;for(l=0;l<e;l++)d[l][2]=!0}c=(c+1)%g}while(0!==c)}g=d[0];c=d[d.length-1];g[2]&&(c[2]=!0,f.some(a,function(a){return 1===a[1]?(d.splice(d.length-1,0,b.clone(d[1])),!0):!1}));d=f.filter(d,function(a){return a[2]?!1:!0});for(c=0;c<d.length-1;c++)if(g=d[c],(e=d[c+1])&&!(g[0]!==e[0]||g[1]!==e[1]))e.outIn?g.outIn=!0:e.inOut&&(g.inOut=!0),d.splice(c+1,1);g=Math.abs;a=[];for(c=0;c<d.length-1;c++){s=d[c];l=s[0];s=s[1];r=g(l)===p;u=g(s)===
p;e=d[c+1];q=e[0];e=e[1];var y=g(q)===p,H=g(e)===p;r&&H?a.push([c+1,[l,e]]):u&&y&&a.push([c+1,[q,s]])}for(c=a.length-1;0<=c;c--)e=a[c],l=d[e[0]-1],g=d[e[0]],!l.outIn&&(!l.inOut&&!g.outIn&&!g.inOut)&&d.splice(e[0],0,e[1]);g=d[0];c=d[d.length-1];(g[0]!==c[0]||g[1]!==c[1])&&d.push(g);return d}),a.setShape(this._getPathStringFromPaths(g))},_getCorners:function(a,b){if(G){var c=this._map,g=b.getExtent(),d=g.spatialReference,e=c.toScreen(new w(g.xmin,g.ymax,d)),c=c.toScreen(new w(g.xmax,g.ymin,d));return{tl:e,
br:c}}e=a.getTransformedBoundingBox();return{tl:e[0],br:e[2]}},_createSegments:function(a){a.shape.path=a.vmlPath;a.segmented=!1;a._confirmSegmented();var b=a.segments;1<b.length&&(a.segments=f.filter(b,function(a,b,c){b=c[b+1];return"M"===a.action&&b&&"L"===b.action?(a.args=a.args.concat(b.args),!0):!1}))},_getPathStringFromPaths:function(a){G?(a=f.map(a,function(a){return"m "+f.map(a,function(a,b){return(1===b?"l ":"")+a.join(",")}).join(" ")}),a.push("e")):a=f.map(a,function(a){return"M "+f.map(a,
function(a){return a.join(",")}).join(" ")});return a.join(" ")},_isPointWithinBBox:function(a,b){var c=b[1],g=b[2],d=b[3],e=a[0],p=a[1];return e>b[0]&&e<g&&p>c&&p<d?!0:!1},_isPointWithinRange:function(a,b,c){var g=a.x;a=a.y;return g<b||a<b||g>c||a>c?!1:!0},_getClipperIntersection:function(a,b,c){var g,d=x._getLineIntersection2,e=Math.round,p={length:0};for(g=0;4>g;g++){var l=d(a,b[g]);if(l)if(l[0]=e(l[0]),l[1]=e(l[1]),c)p[g]=l,p.length++;else return[g,l]}return c?p:null},_getPlaneIndex:function(a,
b){var c=a[0],g=a[1],d=b[0],e=b[1],p=b[2],l=b[3];return c<=d?g>=e&&g<=l?3:g<e?[0,3]:[2,3]:g<=e?c>=d&&c<=p?0:c<d?[3,0]:[1,0]:c>=p?g>=e&&g<=l?1:g<e?[0,1]:[2,1]:g>=l?c>=d&&c<=p?2:c<d?[3,2]:[1,2]:-1},onGraphicAdd:function(){},onGraphicRemove:function(){},onGraphicNodeAdd:function(){},onGraphicNodeRemove:function(){},onGraphicDraw:function(){},onGraphicsClear:function(){},onRendererChange:function(){},onOpacityChange:function(){},setInfoTemplate:function(a){this.infoTemplate=a},add:function(a,b){if(a._graphicsLayer===
this)return a;b||this.graphics.push(a);a._graphicsLayer=this;a._layer=this;this._updateExtent(a);this._draw(a);if(!b)this.onGraphicAdd(a);return a},remove:function(a,b){if(!b){var c;if(-1===(c=f.indexOf(this.graphics,a)))return null;a=this.graphics.splice(c,1)[0]}a.getDojoShape()&&this._removeShape(a);a._shape=a._graphicsLayer=null;this.onGraphicRemove(a);return a},clear:function(a,b){for(var c=this.graphics;0<c.length;)this.remove(c[0]);if(!b)this.onGraphicsClear()},_setIEOpacity:function(a,b){var c=
a&&a.getNode();if(c){var g=a.strokeStyle,d=c.stroke;g&&d&&(d.opacity=g.color.a*b);g=a.fillStyle;d=c.fill;g&&d&&("tile"===d.type?r.set(c,"opacity",b):d.opacity=g.a*b)}},setOpacity:function(a,b){if(b||this.opacity!=a){var c=this._div;c&&(G?(f.forEach(this.graphics,function(b){this._setIEOpacity(b._shape,a);this._setIEOpacity(b._bgShape,a)},this),c._esriIeOpacity=a,this._bgGroup._esriIeOpacity=a):this._canvas?r.set(c.getEventSource(),"opacity",a):c.getEventSource().setAttribute("opacity",a));this.opacity=
a;if(!b)this.onOpacityChange(a)}},setRenderer:function(a){this.renderer=a;this._evalSDRenderer(!0);this.emit("renderer-change",{renderer:this._rndForScale||a})}});m=m([E,K],{declaredClass:"esri.layers.GraphicsLayer",constructor:function(){this.enableMouseEvents=b.hitch(this,this.enableMouseEvents);this.disableMouseEvents=b.hitch(this,this.disableMouseEvents);this._processEvent=b.hitch(this,this._processEvent);this._initLayer()},_initLayer:function(){this.loaded=!0;this.onLoad(this)},_setMap:function(){var a=
this.inherited("_setMap",arguments);this.enableMouseEvents();return a},_unsetMap:function(){this.disableMouseEvents();this.inherited("_unsetMap",arguments)},_processEvent:function(a){var b=this._map,c=a.target,g;a.screenPoint=new y(a.pageX-b.position.x,a.pageY-b.position.y);for(a.mapPoint=b.toMap(a.screenPoint);c&&!(g=c.e_graphic);)c=c.parentNode;if(g)return a.graphic=g,a},_onMouseOverHandler:function(a){if(this._processEvent(a))this.onMouseOver(a)},_onMouseMoveHandler:function(a){if(this._processEvent(a))this.onMouseMove(a)},
_onMouseDragHandler:function(a){if(this._processEvent(a))this.onMouseDrag(a)},_onMouseOutHandler:function(a){if(this._processEvent(a))this.onMouseOut(a)},_onMouseDownHandler:function(a){this._downGr=this._downPt=null;this._processEvent(a)&&(q.disconnect(this._onmousemove_connect),q.disconnect(this._onmousedrag_connect),this._onmousedrag_connect=q.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseDragHandler"),this._downGr=a.graphic,this._downPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseDown(a))},
_onMouseUpHandler:function(a){this._upGr=this._upPt=null;this._processEvent(a)&&(q.disconnect(this._onmousedrag_connect),q.disconnect(this._onmousemove_connect),this._onmousemove_connect=q.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseMoveHandler"),this._upGr=a.graphic,this._upPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseUp(a))},_onClickHandler:function(a){if(this._processEvent(a)){var b=this._downGr,c=this._upGr;b&&(c&&b===c&&this._downPt===this._upPt)&&(G&&(l._ieGraphic=a.graphic),
this.onClick(a))}},_onDblClickHandler:function(a){if(this._processEvent(a))this.onDblClick(a)},onMouseOver:function(){},onMouseMove:function(){},onMouseDrag:function(){},onMouseOut:function(){},onMouseDown:function(){},onMouseUp:function(){},onClick:function(){},onDblClick:function(){},enableMouseEvents:function(){if(!this._mouseEvents){var a=q.connect,b=this._div.getEventSource();H||(this._onmouseover_connect=a(b,"onmouseover",this,"_onMouseOverHandler"),this._onmousemove_connect=a(b,"onmousemove",
this,"_onMouseMoveHandler"),this._onmouseout_connect=a(b,"onmouseout",this,"_onMouseOutHandler"),this._onmousedown_connect=a(b,"onmousedown",this,"_onMouseDownHandler"),this._onmouseup_connect=a(b,"onmouseup",this,"_onMouseUpHandler"),this._onclick_connect=a(b,"onclick",this,"_onClickHandler"),this._ondblclick_connect=a(b,"ondblclick",this,"_onDblClickHandler"));this._mouseEvents=!0}},disableMouseEvents:function(){if(this._mouseEvents){var a=q.disconnect;a(this._onmouseover_connect);a(this._onmousemove_connect);
a(this._onmousedrag_connect);a(this._onmouseout_connect);a(this._onmousedown_connect);a(this._onmouseup_connect);a(this._onclick_connect);a(this._ondblclick_connect);this._mouseEvents=!1}}});m._GraphicsContainer=s;m._GraphicsLayer=E;t("extend-esri")&&(b.setObject("layers.GraphicsLayer",m,l),b.setObject("layers._GraphicsContainer",s,l),b.setObject("layers._GraphicsLayer",E,l));return m})},"esri/tasks/query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils ./SpatialRelationship dojo/has!extend-esri?./QueryTask dojo/has!extend-esri?./RelationshipQuery dojo/has!extend-esri?./StatisticDefinition".split(" "),
function(m,q,b,f,n,h,r,k){var d=m(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=d.SPATIAL_REL_INTERSECTS},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnDistinctValues:!1,orderByFields:null,outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,distance:null,units:null,resultOffset:null,resultRecordCount:null,resultType:null,quantizationParameters:null,
_units:{meters:"esriSRUnit_Meter",kilometers:"esriSRUnit_Kilometer",feet:"esriSRUnit_Foot",miles:"esriSRUnit_StatuteMile","nautical-miles":"esriSRUnit_NauticalMile","us-nautical-miles":"esriSRUnit_USNauticalMile"},toJson:function(c){var a={text:this.text,where:this.where,returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},e=c&&c.geometry||this.geometry,l=this.objectIds,k=this.outFields,t=this.outSpatialReference,
p=this.groupByFieldsForStatistics,g=this.orderByFields,s=this.outStatistics;c=this.distance;e&&(a.geometry=e,a.geometryType=r.getJsonType(e),a.inSR=e.spatialReference.wkid||f.toJson(e.spatialReference.toJson()));l&&(a.objectIds=l.join(","));k&&(a.outFields=k.join(","));this.returnDistinctValues&&(a.returnDistinctValues=!0);p&&(a.groupByFieldsForStatistics=p.join(","));g&&(a.orderByFields=g.join(","));if(s){var v=[];b.forEach(s,function(a){v.push(a.toJson())});a.outStatistics=f.toJson(v)}t?a.outSR=
t.wkid||f.toJson(t.toJson()):e&&(a.outSR=e.spatialReference.wkid||f.toJson(e.spatialReference.toJson()));e=this.timeExtent;a.time=e?e.toJson().join(","):null;if((e=this.relationParam)&&this.spatialRelationship===d.SPATIAL_REL_RELATION)a.relationParam=e;c&&(a.distance=this.distance,this.hasOwnProperty("units")?a.units=this._units[this.units]||this._units.meters:(console.warn("esri/tasks/query::no distance unit provided, defaulting to meters"),a.units=this._units.meters));this.hasOwnProperty("start")&&
(a.resultOffset=this.start,a.resultRecordCount=10,""===a.where&&(a.where="1\x3d1"));this.hasOwnProperty("num")&&(a.resultRecordCount=this.num);a.resultType=this.resultType;a.pixelSize=this.pixelSize?f.toJson(this.pixelSize.toJson()):null;a.multipatchOption=this.multipatchOption;this.quantizationParameters&&(a.quantizationParameters=f.toJson(this.quantizationParameters));a._ts=this._ts;return a}});q.mixin(d,k);n("extend-esri")&&q.setObject("tasks.Query",d,h);return d})},"esri/layers/ArcGISDynamicMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/sniff dojo/io-query ../kernel ../config ../request ../urlUtils ../layerUtils ../geometry/scaleUtils ./DynamicMapServiceLayer ./ArcGISMapServiceLayer ./TimeInfo ./LayerTimeOptions ./ImageParameters ./DynamicLayerInfo ./LayerMapSource".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e,l,u,t,p,g,s,v){m=m([l,u],{declaredClass:"esri.layers.ArcGISDynamicMapServiceLayer",_eventMap:{"visible-layers-change":["visibleLayers"]},constructor:function(a,b,c){a=b&&b.imageParameters;var d=q.hitch;if(a){var e=a.layerDefinitions;e&&this.setLayerDefinitions(e);a.layerOption===g.LAYER_OPTION_SHOW&&(this.visibleLayers=[].concat(a.layerIds),this.onVisibleLayersChange(this.visibleLayers))}this._setIsPNG32=d(this,this._setIsPNG32);this.dpi=a&&a.dpi||96;this.imageFormat=
a&&a.format||"png8";this.imageTransparency=a&&!1===a.transparent?!1:!0;this._setIsPNG32();this.gdbVersion=b&&b.gdbVersion;this._params.gdbVersion=this.gdbVersion;q.mixin(this._params,this._url.query,{dpi:this.dpi,transparent:this.imageTransparency,format:this.imageFormat},a?a.toJson():{});this.getImageUrl=d(this,this.getImageUrl);this._initLayer=d(this,this._initLayer);this._load=d(this,this._load);this.useMapImage=b?b.useMapImage:!1;this._loadCallback=b&&b.loadCallback;(b=b&&b.resourceInfo)?this._initLayer(b):
(void 0===c||!1===c)&&this._load();this.registerConnectEvents()},disableClientCaching:!1,layerDefinitions:null,_initLayer:function(a,b){this.inherited(arguments);a.timeInfo&&(this.timeInfo=new t(a.timeInfo));this.loaded=!0;this.onLoad(this);var c=this._loadCallback;c&&(delete this._loadCallback,c(this))},getImageUrl:function(a,b,g,e){var p=this._url.path+"/export?",l=this._params,s=a.spatialReference.wkid||f.toJson(a.spatialReference.toJson()),t=this._errorHandler;delete l._ts;q.mixin(l,{bbox:a.xmin+
","+a.ymin+","+a.xmax+","+a.ymax,bboxSR:s,imageSR:s,size:b+","+g},this.disableClientCaching?{_ts:(new Date).getTime()}:{});l.layerDefs&&(a=l.layerDefs,delete l.layerDefs,q.mixin(l,{layerDefs:a}));var v=l.token=this._getToken();a=c.addProxy(p+h.objectToQuery(q.mixin({},l,{f:"image"})));a.length>k.defaults.io.postLength||this.useMapImage?this._jsonRequest=d({url:p,content:q.mixin(l,{f:"json"}),callbackParamName:"callback",load:function(a){a=a.href;v&&(a+=-1===a.indexOf("?")?"?token\x3d"+v:"\x26token\x3d"+
v);e(c.addProxy(a))},error:t}):e(a)},_setIsPNG32:function(){var a=this.imageFormat.toLowerCase(),b=n("ie");this.isPNG32=b&&6===b&&("png32"===a||"png24"===a)&&this.imageTransparency},_setTime:function(c){var g=this.timeInfo;c=this._params.time=c?c.toJson().join(","):null;if(10.02>this.version&&g)if(c)this._params.layerTimeOptions=a._serializeTimeOptions(this.layerTimeOptions);else{var d=this.layerInfos;if(d){var e=this.layerTimeOptions,l=e?e.slice(0):[],s=[];b.forEach(d,function(a){a.subLayerIds||
s.push(a.id)});s.length&&(b.forEach(s,function(a){if(!l[a]){var b=new p;b.useTime=!1;l[a]=b}}),this._params.layerTimeOptions=a._serializeTimeOptions(l,s))}}10.02<=this.version&&g&&(!c&&!g.hasLiveData)&&(this._params.time="null,null")},setDPI:function(a,b){this.dpi=this._params.dpi=a;b||this.refresh(!0)},setImageFormat:function(a,b){this.imageFormat=this._params.format=a;this._setIsPNG32();b||this.refresh(!0)},setImageTransparency:function(a,b){this.imageTransparency=this._params.transparent=a;this._setIsPNG32();
b||this.refresh(!0)},setVisibleLayers:function(a,b){this.visibleLayers=a;this._params.layers=g.LAYER_OPTION_SHOW+":"+(a.length?a.join():"-1");this._updateDynamicLayers();b||this.refresh(!0);this.onVisibleLayersChange(this.visibleLayers)},onVisibleLayersChange:function(){},setDefaultVisibleLayers:function(a){this.visibleLayers=this._defaultVisibleLayers;this._params.layers=null;this._updateDynamicLayers();a||this.refresh(!0);this.onVisibleLayersChange(this.visibleLayers)},setLayerDefinitions:function(b,
c){this.layerDefinitions=b;this._params.layerDefs=a._serializeLayerDefinitions(b);this._updateDynamicLayers();c||this.refresh(!0)},setDefaultLayerDefinitions:function(a){this.layerDefinitions=this._params.layerDefs=null;this._updateDynamicLayers();a||this.refresh(!0)},setDisableClientCaching:function(a){this.disableClientCaching=a},setLayerTimeOptions:function(b,c){this.layerTimeOptions=b;this._params.layerTimeOptions=a._serializeTimeOptions(b);this._updateDynamicLayers();c||this.refresh(!0)},refresh:function(a){if(a)this.inherited(arguments);
else{var b=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=b}},setLayerDrawingOptions:function(a,b){this.layerDrawingOptions=a;this._updateDynamicLayers();b||this.refresh(!0)},setDynamicLayerInfos:function(b,c){b&&0<b.length?(this.dynamicLayerInfos=b,this.visibleLayers=a._getDefaultVisibleLayers(b),this.onVisibleLayersChange(this.visibleLayers)):this.dynamicLayerInfos=this.layerDrawingOptions=null;this._updateDynamicLayers();c||this.refresh(!0)},
createDynamicLayerInfosFromLayerInfos:function(){var a=[],c;b.forEach(this.layerInfos,function(b){c=new s(b.toJson());c.source=new v({mapLayerId:b.id});a.push(c)});return a},_onDynamicLayersChange:function(){},_updateDynamicLayers:function(){if(this.dynamicLayerInfos&&0<this.dynamicLayerInfos.length||this.layerDrawingOptions&&0<this.layerDrawingOptions.length){if(!this.dynamicLayerInfos||0===this.dynamicLayerInfos.length)this.dynamicLayerInfos=this.createDynamicLayerInfosFromLayerInfos();var c;c=
this.dynamicLayerInfos;var g=[],d=this._map&&e.getScale(this._map),p=this.visibleLayers,l=d?a._getLayersForScale(d,c):p;b.forEach(c,function(a){if(!a.subLayerIds){var c,d=a.id;if(-1!==b.indexOf(p,d)&&-1!==b.indexOf(l,d)){c={id:d,name:a.name};c.source=a.source&&a.source.toJson();var e;this.layerDefinitions&&this.layerDefinitions[d]&&(e=this.layerDefinitions[d]);e&&(c.definitionExpression=e);var s;this.layerDrawingOptions&&this.layerDrawingOptions[d]&&(s=this.layerDrawingOptions[d]);s&&(c.drawingInfo=
s.toJson());var t;this.layerTimeOptions&&this.layerTimeOptions[d]&&(t=this.layerTimeOptions[d]);t&&(c.layerTimeOptions=t.toJson());c.minScale=a.minScale||0;c.maxScale=a.maxScale||0;g.push(c)}}},this);c=f.toJson(g);if(!this._params.dynamicLayers||this._params.dynamicLayers.length!==c.length||this._params.dynamicLayers!==c)this._params.dynamicLayers=c,this._onDynamicLayersChange(this._params.dynamicLayers)}else this._params.dynamicLayers?(this._params.dynamicLayers=null,this._onDynamicLayersChange(null)):
this._params.dynamicLayers=null},_onExtentChangeHandler:function(a,b,c){c&&this._updateDynamicLayers();this.inherited(arguments)},_setMap:function(a,b,c){this._map=a;this._updateDynamicLayers();return this.inherited(arguments)},onGDBVersionChange:function(){},setGDBVersion:function(a,b){this.gdbVersion=a;this._params.gdbVersion=a;this.onGDBVersionChange();b||this.refresh(!0)},exportMapImage:function(a,b){var c=k.defaults.map,c=q.mixin({size:c.width+","+c.height},this._params,a?a.toJson(this.normalization):
{},{f:"json"});delete c._ts;if(c.layerDefs){var g=c.layerDefs;delete c.layerDefs;q.mixin(c,{layerDefs:g})}this._exportMapImage(this._url.path+"/export",c,b)}});n("extend-esri")&&q.setObject("layers.ArcGISDynamicMapServiceLayer",m,r);return m})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(m,q,b,f,n,h,r,k,d,c,a,e,l,u,t,
p){function g(a){return eval("("+a+")")}function s(a){var b=a._nameCaseMap,c=a.prototype;if(!b||b._extendCnt<w){var b=a._nameCaseMap={},g;for(g in c)"_"!==g.charAt(0)&&(b[g.toLowerCase()]=g);b._extendCnt=w}return b}function v(a,c){var g=a.join();if(!y[g]){for(var d=[],e=0,p=a.length;e<p;e++){var l=a[e];d[d.length]=y[l]=y[l]||b.getObject(l)||~l.indexOf("/")&&(c?c(l):m(l))}e=d.shift();y[g]=d.length?e.createSubclass?e.createSubclass(d):e.extend.apply(e,d):e}return y[g]}new Date("X");var w=0;d.after(b,
"extend",function(){w++},!0);var y={},A={_clearCache:function(){w++;y={}},_functionFromScript:function(a,b){var c="",g="",d=a.getAttribute(b+"args")||a.getAttribute("args"),e=a.getAttribute("with"),d=(d||"").split(/\s*,\s*/);e&&e.length&&f.forEach(e.split(/\s*,\s*/),function(a){c+="with("+a+"){";g+="}"});return new Function(d,c+a.innerHTML+g)},instantiate:function(a,b,c){b=b||{};c=c||{};var g=(c.scope||q._scopeName)+"Type",d="data-"+(c.scope||q._scopeName)+"-",e=d+"type",p=d+"mixins",l=[];f.forEach(a,
function(a){var c=g in b?b[g]:a.getAttribute(e)||a.getAttribute(g);if(c){var d=a.getAttribute(p),c=d?[c].concat(d.split(/\s*,\s*/)):[c];l.push({node:a,types:c})}});return this._instantiate(l,b,c)},_instantiate:function(a,b,g,d){function e(a){!b._started&&!g.noStart&&f.forEach(a,function(a){"function"===typeof a.startup&&!a._started&&a.startup()});return a}a=f.map(a,function(a){var c=a.ctor||v(a.types,g.contextRequire);if(!c)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(c,
a.node,b,g,a.scripts,a.inherited)},this);return d?c(a).then(e):e(a)},construct:function(c,e,p,v,h,w){function n(a){S&&b.setObject(S,a);for(B=0;B<X.length;B++)d[X[B].advice||"after"](a,X[B].method,b.hitch(a,X[B].func),!0);for(B=0;B<sa.length;B++)sa[B].call(a);for(B=0;B<da.length;B++)a.watch(da[B].prop,da[B].func);for(B=0;B<aa.length;B++)t(a,aa[B].event,aa[B].func);return a}var r=c&&c.prototype;v=v||{};var m={};v.defaults&&b.mixin(m,v.defaults);w&&b.mixin(m,w);var A;l("dom-attributes-explicit")?A=e.attributes:
l("dom-attributes-specified-flag")?A=f.filter(e.attributes,function(a){return a.specified}):(w=(/^input$|^img$/i.test(e.nodeName)?e:e.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),A=f.map(w.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==e.nodeName&&"value"==a||"enctype"==b?e.getAttribute(b):e.getAttributeNode(b).value}}));var y=v.scope||q._scopeName;w="data-"+y+"-";var I={};"dojo"!==y&&(I[w+"props"]=
"data-dojo-props",I[w+"type"]="data-dojo-type",I[w+"mixins"]="data-dojo-mixins",I[y+"type"]="dojoType",I[w+"id"]="data-dojo-id");for(var B=0,R,y=[],S,U;R=A[B++];){var V=R.name,P=V.toLowerCase();R=R.value;switch(I[P]||P){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":U=R;break;case "data-dojo-id":case "jsid":S=R;break;case "data-dojo-attach-point":case "dojoattachpoint":m.dojoAttachPoint=R;break;case "data-dojo-attach-event":case "dojoattachevent":m.dojoAttachEvent=
R;break;case "class":m["class"]=e.className;break;case "style":m.style=e.style&&e.style.cssText;break;default:if(V in r||(V=s(c)[P]||V),V in r)switch(typeof r[V]){case "string":m[V]=R;break;case "number":m[V]=R.length?Number(R):NaN;break;case "boolean":m[V]="false"!=R.toLowerCase();break;case "function":""===R||-1!=R.search(/[^\w\.]+/i)?m[V]=new Function(R):m[V]=b.getObject(R,!1)||new Function(R);y.push(V);break;default:P=r[V],m[V]=P&&"length"in P?R?R.split(/\s*,\s*/):[]:P instanceof Date?""==R?new Date(""):
"now"==R?new Date:a.fromISOString(R):P instanceof k?q.baseUrl+R:g(R)}else m[V]=R}}for(A=0;A<y.length;A++)I=y[A].toLowerCase(),e.removeAttribute(I),e[I]=null;if(U)try{U=g.call(v.propsThis,"{"+U+"}"),b.mixin(m,U)}catch(fa){throw Error(fa.toString()+" in data-dojo-props\x3d'"+U+"'");}b.mixin(m,p);h||(h=c&&(c._noScript||r._noScript)?[]:u("\x3e script[type^\x3d'dojo/']",e));var X=[],sa=[],da=[],aa=[];if(h)for(B=0;B<h.length;B++)I=h[B],e.removeChild(I),p=I.getAttribute(w+"event")||I.getAttribute("event"),
v=I.getAttribute(w+"prop"),U=I.getAttribute(w+"method"),y=I.getAttribute(w+"advice"),A=I.getAttribute("type"),I=this._functionFromScript(I,w),p?"dojo/connect"==A?X.push({method:p,func:I}):"dojo/on"==A?aa.push({event:p,func:I}):m[p]=I:"dojo/aspect"==A?X.push({method:U,advice:y,func:I}):"dojo/watch"==A?da.push({prop:v,func:I}):sa.push(I);c=(h=c.markupFactory||r.markupFactory)?h(m,e,c):new c(m,e);return c.then?c.then(n):n(c)},scan:function(a,b){function c(a){if(!a.inherited){a.inherited={};var b=a.node,
g=c(a.parent),b={dir:b.getAttribute("dir")||g.dir,lang:b.getAttribute("lang")||g.lang,textDir:b.getAttribute(h)||g.textDir},d;for(d in b)b[d]&&(a.inherited[d]=b[d])}return a.inherited}var g=[],d=[],p={},s=(b.scope||q._scopeName)+"Type",t="data-"+(b.scope||q._scopeName)+"-",k=t+"type",h=t+"textdir",t=t+"mixins",w=a.firstChild,n=b.inherited;if(!n){var r=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&r(a.parentNode,b)},n={dir:r(a,"dir"),lang:r(a,"lang"),textDir:r(a,h)},u;for(u in n)n[u]||
delete n[u]}for(var n={inherited:n},A,y;;)if(w)if(1!=w.nodeType)w=w.nextSibling;else if(A&&"script"==w.nodeName.toLowerCase())(V=w.getAttribute("type"))&&/^dojo\/\w/i.test(V)&&A.push(w),w=w.nextSibling;else if(y)w=w.nextSibling;else{var V=w.getAttribute(k)||w.getAttribute(s);u=w.firstChild;if(!V&&(!u||3==u.nodeType&&!u.nextSibling))w=w.nextSibling;else{y=null;if(V){var P=w.getAttribute(t);A=P?[V].concat(P.split(/\s*,\s*/)):[V];try{y=v(A,b.contextRequire)}catch(fa){}y||f.forEach(A,function(a){~a.indexOf("/")&&
!p[a]&&(p[a]=!0,d[d.length]=a)});P=y&&!y.prototype._noScript?[]:null;n={types:A,ctor:y,parent:n,node:w,scripts:P};n.inherited=c(n);g.push(n)}else n={node:w,scripts:A,parent:n};A=P;y=w.stopParser||y&&y.prototype.stopParser&&!b.template;w=u}}else{if(!n||!n.node)break;w=n.node.nextSibling;y=!1;n=n.parent;A=n.scripts}var X=new e;d.length?(l("dojo-debug-messages")&&console.warn("WARNING: Modules being Auto-Required: "+d.join(", ")),(b.contextRequire||m)(d,function(){X.resolve(f.filter(g,function(a){if(!a.ctor)try{a.ctor=
v(a.types,b.contextRequire)}catch(c){}for(var g=a.parent;g&&!g.types;)g=g.parent;var d=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(d&&d.stopParser&&!b.template);a.instantiate=!g||g.instantiate&&g.instantiateChildren;return a.instantiate}))})):X.resolve(g);return X.promise},_require:function(a,c){var d=g("{"+a.innerHTML+"}"),p=[],l=[],s=new e,t=c&&c.contextRequire||m,k;for(k in d)p.push(k),l.push(d[k]);t(l,function(){for(var a=0;a<p.length;a++)b.setObject(p[a],arguments[a]);s.resolve(arguments)});
return s.promise},_scanAmd:function(a,b){var c=new e,g=c.promise;c.resolve(!0);var d=this;u("script[type\x3d'dojo/require']",a).forEach(function(a){g=g.then(function(){return d._require(a,b)});a.parentNode.removeChild(a)});return g},parse:function(a,c){var g;!c&&a&&a.rootNode?(c=a,g=c.rootNode):a&&b.isObject(a)&&!("nodeType"in a)?c=a:g=a;g=g?h.byId(g):r.body();c=c||{};var d=c.template?{template:!0}:{},e=[],p=this,l=this._scanAmd(g,c).then(function(){return p.scan(g,c)}).then(function(a){return p._instantiate(a,
d,c,!0)}).then(function(a){return e=e.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});b.mixin(e,l);return e}};q.parser=A;n.parseOnLoad&&p(100,A,"parse");return A})},"esri/plugins/popupManager":function(){define(["../PopupManager"],function(m){return{add:function(q,b){q.popupManager||(q.popupManager=new m(b),q.popupManager.setMap(q))},remove:function(q){var b=q.popupManager;b&&(b.unsetMap(),q.popupManager=void 0)}}})},"esri/layers/MapImage":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has ../kernel ../domUtils ../geometry/Extent".split(" "),
function(m,q,b,f,n,h,r){m=m(null,{declaredClass:"esri.layers.MapImage",constructor:function(b){q.mixin(this,b);this.extent=new r(this.extent)},visible:!0,opacity:1,getLayer:function(){return this._layer},getNode:function(){return this._node},show:function(){if(!this.visible){this.visible=!0;var b=this._node,d=this._layer,c;if(b){if(c=d&&d._div)d.suspended||d._setPos(b,c._left,c._top),(d._active||c).appendChild(b);h.show(b)}}},hide:function(){if(this.visible){this.visible=!1;var b=this._node;b&&(h.hide(b),
b.parentNode&&b.parentNode.removeChild(b))}},setOpacity:function(k){var d=this._node;this.opacity=k;d&&b.set(d,"opacity",k)}});f("extend-esri")&&q.setObject("layers.MapImage",m,n);return m})},"esri/symbols/Symbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../Color".split(" "),function(m,q,b,f,n,h){m=m(null,{declaredClass:"esri.symbol.Symbol",color:new h([0,0,0,1]),type:null,constructor:function(b){if(b&&q.isObject(b)&&(q.mixin(this,b),this.color&&n.isDefined(this.color[0])&&
(this.color=h.toDojoColor(this.color)),(b=this.type)&&0===b.indexOf("esri")))this.type={esriSMS:"simplemarkersymbol",esriPMS:"picturemarkersymbol",esriSLS:"simplelinesymbol",esriCLS:"cartographiclinesymbol",esriSFS:"simplefillsymbol",esriPFS:"picturefillsymbol",esriTS:"textsymbol",esriSHD:"shieldlabelsymbol"}[b]},setColor:function(b){this.color=b;return this},toJson:function(){return{color:h.toJsonColor(this.color)}}});b("extend-esri")&&q.setObject("symbol.Symbol",m,f);return m})},"esri/symbol":function(){define("./symbols/Symbol ./symbols/MarkerSymbol ./symbols/SimpleMarkerSymbol ./symbols/PictureMarkerSymbol ./symbols/LineSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/FillSymbol ./symbols/SimpleFillSymbol ./symbols/PictureFillSymbol ./symbols/Font ./symbols/TextSymbol ./symbols/jsonUtils".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e,l){return{Symbol:m,MarkerSymbol:q,SimpleMarkerSymbol:b,PictureMarkerSymbol:f,LineSymbol:n,SimpleLineSymbol:h,CartographicLineSymbol:r,FillSymbol:k,SimpleFillSymbol:d,PictureFillSymbol:c,Font:a,TextSymbol:e,jsonUtils:l}})},"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(m,q,b,f){return m("dijit.form.ToggleButton",[b,f],{baseClass:"dijitToggleButton",setChecked:function(b){q.deprecated("setChecked("+
b+") is deprecated. Use set('checked',"+b+") instead.","","2.0");this.set("checked",b)}})})},"esri/arcade/arcadeRuntime":function(){define("require exports ../geometry/Polygon ../graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./FunctionWrapper ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats".split(" "),function(m,q,b,f,n,h,r,k,d,c,a,e,l,u,
t,p,g,s,v){function w(a,b){for(var c=[],g=0;g<b.arguments.length;g++)c.push(x(a,b.arguments[g]));return c}function y(a,b,c){try{return c(a,b,w(a,b))}catch(g){throw g;}}function A(a){return a instanceof U||a instanceof u}function x(b,g){try{switch(g.type){case "EmptyStatement":return V;case "VariableDeclarator":var d=null===g.init?null:x(b,g.init),p=g.id.name.toLowerCase();null!==b.localScope?b.localScope[p]={value:d,valueset:!0,node:g.init}:b.globalScope[p]={value:d,valueset:!0,node:g.init};return V;
case "VariableDeclaration":for(var l=0;l<g.declarations.length;l++)x(b,g.declarations[l]);return V;case "BlockStatement":var s;a:{for(var l=V,t=0;t<g.body.length;t++)if(l=x(b,g.body[t]),l instanceof R||l===P||l===fa){s=l;break a}s=l}return s;case "FunctionDeclaration":var k=g.id.name.toLowerCase();b.globalScope[k]={valueset:!0,node:null,value:new u(g,b)};return V;case "ReturnStatement":var v;if(null===g.argument)v=new R(V);else{var h=x(b,g.argument);v=new R(h)}return v;case "IfStatement":var w;if("AssignmentExpression"===
g.test.type||"UpdateExpression"===g.test.type)throw Error(a.nodeErrorMessage(g.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var f=x(b,g.test);if(!0===f)w=x(b,g.consequent);else if(!1===f)w=null!==g.alternate?x(b,g.alternate):V;else throw Error(a.nodeErrorMessage(g,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));return w;case "ExpressionStatement":var n;if("AssignmentExpression"===g.expression.type||"UpdateExpression"===g.expression.type)n=x(b,g.expression);else{var r=x(b,g.expression);n=
r===V?V:new S(r)}return n;case "AssignmentExpression":var q;var m,y=g.left.name.toLowerCase();m=x(b,g.right);if(null!==b.localScope&&void 0!==b.localScope[y])b.localScope[y]={value:K(m,g.operator,b.localScope[y].value,g),valueset:!0,node:g.right},q=V;else if(void 0!==b.globalScope[y])b.globalScope[y]={value:K(m,g.operator,b.globalScope[y].value,g),valueset:!0,node:g.right},q=V;else throw Error("Variable not recognised");return q;case "UpdateExpression":var G;var J,F=g.argument.name.toLowerCase();
if(null!==b.localScope&&void 0!==b.localScope[F])J=b.localScope[F].value,b.localScope[F]={value:"++"===g.operator?J+1:J-1,valueset:!0,node:g},G=!1===g.prefix?J:"++"===g.operator?J+1:J-1;else if(void 0!==b.globalScope[F])J=b.globalScope[F].value,b.globalScope[F]={value:"++"===g.operator?J+1:J-1,valueset:!0,node:g},G=!1===g.prefix?J:"++"===g.operator?J+1:J-1;else throw Error("Variable not recognised");return G;case "BreakStatement":return P;case "ContinueStatement":return fa;case "ForStatement":null!==
g.init&&x(b,g.init);s={testResult:!0,lastAction:V};do b:{var t=b,B=g,d=s;if(null!==B.test&&(d.testResult=x(t,B.test),!1===d.testResult))break b;d.lastAction=x(t,B.body);d.lastAction===P?d.testResult=!1:d.lastAction instanceof R?d.testResult=!1:null!==B.update&&x(t,B.update)}while(!0===s.testResult);l=s.lastAction instanceof R?s.lastAction:V;return l;case "ForInStatement":return D(b,g);case "Identifier":var U;var O;try{var I=g.name.toLowerCase();if(null!==b.localScope&&void 0!==b.localScope[I])O=b.localScope[I],
!0!==O.valueset&&(O.value=x(b,O.node),O.valueset=!0),U=O.value;else if(void 0!==b.globalScope[I])O=b.globalScope[I],!0!==O.valueset&&(O.value=x(b,O.node),O.valueset=!0),U=O.value;else throw Error(a.nodeErrorMessage(g,"RUNTIME","VARIABLENOTFOUND"));}catch(N){throw N;}return U;case "MemberExpression":return E(b,g);case "Literal":return g.value;case "ThisExpression":throw Error(a.nodeErrorMessage(g,"RUNTIME","NOTSUPPORTED"));case "CallExpression":return H(b,g);case "UnaryExpression":var X;try{var Ka=
x(b,g.argument);if(c.isBoolean(Ka))if("!"===g.operator)X=!Ka;else throw Error(a.nodeErrorMessage(g,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));else if(c.isNumber(Ka))if("-"===g.operator)X=-1*Ka;else if("+"===g.operator)X=1*Ka;else throw Error(a.nodeErrorMessage(g,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));else throw Error(a.nodeErrorMessage(g,"RUNTIME","NOTSUPPORTEDTYPE"));}catch(Q){throw Q;}return X;case "BinaryExpression":return C(b,g);case "LogicalExpression":var na;a:try{if("AssignmentExpression"===
g.left.type||"UpdateExpression"===g.left.type)throw Error(a.nodeErrorMessage(g.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===g.right.type||"UpdateExpression"===g.right.type)throw Error(a.nodeErrorMessage(g.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var Ea=[x(b,g.left),x(b,g.right)],Z=Ea[0],Fa=Ea[1];if(c.isBoolean(Z)&&c.isBoolean(Fa))switch(g.operator){case "||":na=Z||Fa;break a;case "\x26\x26":na=Z&&Fa;break a;default:throw Error(a.nodeErrorMessage(g,
"RUNTIME","ONLYORORAND"));}else throw Error(a.nodeErrorMessage(g,"RUNTIME","ONLYBOOLEAN"));}catch(Ha){throw Ha;}return na;case "ConditionalExpression":throw Error(a.nodeErrorMessage(g,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{l=[];for(s=0;s<g.elements.length;s++){t=x(b,g.elements[s]);if(A(t))throw Error(a.nodeErrorMessage(g,"RUNTIME","FUNCTIONCONTEXTILLEGAL"));l.push(t)}}catch(ba){throw ba;}return l;case "ObjectExpression":l={};for(s=0;s<g.properties.length;s++){B=x(b,g.properties[s]);
if(A(B.value))throw Error("Illegal Argument");l[B.key.toString()]=B.value}return new e(l);case "Property":return{key:"Identifier"===g.key.type?g.key.name:x(b,g.key),value:x(b,g.value)};case "Array":throw Error(a.nodeErrorMessage(g,"RUNTIME","NOTSUPPORTED"));default:throw Error(a.nodeErrorMessage(g,"RUNTIME","UNREOGNISED"));}}catch(Oa){throw Oa;}}function D(b,g){var d=x(b,g.right);"VariableDeclaration"===g.left.type&&x(b,g.left);var p=null,s="VariableDeclaration"===g.left.type?g.left.declarations[0].id.name:
g.left.name;null!==b.localScope&&void 0!==b.localScope[s]&&(p=b.localScope[s]);null===p&&void 0!==b.globalScope[s]&&(p=b.globalScope[s]);if(null===p)throw Error(a.nodeErrorMessage(g,"RUNTIME","VARIABLENOTDECLARED"));if(c.isArray(d)||c.isString(d)){for(var t=0;t<d.length&&!(p.value=t,s=x(b,g.body),s===P);t++)if(s instanceof R)return s;return V}if(d instanceof e||d instanceof l){d=d.keys();for(t=0;t<d.length&&!(p.value=d[t],s=x(b,g.body),s===P);t++)if(s instanceof R)return s}else return V}function K(b,
g,d,e){switch(g){case "\x3d":return b;case "/\x3d":return c.toNumber(d)/c.toNumber(b);case "*\x3d":return c.toNumber(d)*c.toNumber(b);case "-\x3d":return c.toNumber(d)-c.toNumber(b);case "+\x3d":return c.isString(d)||c.isString(b)?c.toString(d)+c.toString(b):c.toNumber(d)+c.toNumber(b);case "%\x3d":return c.toNumber(d)%c.toNumber(b);default:throw Error(a.nodeErrorMessage(e,"RUNTIME","OPERATORNOTRECOGNISED"));}}function E(b,g){try{var d=x(b,g.object);if(null===d)throw Error(a.nodeErrorMessage(g,"RUNTIME",
"NOTFOUND"));if(!1===g.computed){if(d instanceof e||d instanceof l)return d.field(g.property.name)}else{var p=x(b,g.property);if(d instanceof e||d instanceof l){if(c.isString(p))return d.field(p)}else if(c.isArray(d)){if(c.isNumber(p)&&isFinite(p)&&Math.floor(p)===p)return d[p]}else if(c.isString(d)&&c.isNumber(p)&&isFinite(p)&&Math.floor(p)===p)return d[p]}throw Error(a.nodeErrorMessage(g,"RUNTIME","INVALIDTYPE"));}catch(s){throw s;}}function C(b,g){try{var d=[x(b,g.left),x(b,g.right)],e=d[0],p=
d[1];switch(g.operator){case "\x3d\x3d":return c.equalityTest(e,p);case "\x3d":return c.equalityTest(e,p);case "!\x3d":return!c.equalityTest(e,p);case "\x3c":return e<p;case "\x3e":return e>p;case "\x3c\x3d":return e<=p;case "\x3e\x3d":return e>=p;case "+":return c.isString(e)||c.isString(p)?c.toString(e)+c.toString(p):c.toNumber(e)+c.toNumber(p);case "-":return c.toNumber(e)-c.toNumber(p);case "*":return c.toNumber(e)*c.toNumber(p);case "/":return c.toNumber(e)/c.toNumber(p);case "%":return c.toNumber(e)%
c.toNumber(p);default:throw Error(a.nodeErrorMessage(g,"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(l){throw l;}}function H(b,c){try{if("Identifier"!==c.callee.type)throw Error(a.nodeErrorMessage(c,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==b.localScope&&void 0!==b.localScope[c.callee.name.toLowerCase()]){var g=b.localScope[c.callee.name.toLowerCase()];if(g.value instanceof U)return g.value.fn(b,c);if(g.value instanceof u)return I(b,c,g.value.definition);throw Error(a.nodeErrorMessage(c,"RUNTIME",
"NOTAFUNCTION"));}if(void 0!==b.globalScope[c.callee.name.toLowerCase()]){g=b.globalScope[c.callee.name.toLowerCase()];if(g.value instanceof U)return g.value.fn(b,c);if(g.value instanceof u)return I(b,c,g.value.definition);throw Error(a.nodeErrorMessage(c,"RUNTIME","NOTAFUNCTION"));}throw Error(a.nodeErrorMessage(c,"RUNTIME","NOTFOUND"));}catch(d){throw d;}}function G(a){return null==a?"":c.isArray(a)?"Array":c.isDate(a)?"Date":c.isString(a)?"String":c.isBoolean(a)?"Boolean":c.isNumber(a)?"Number":
a instanceof e?"Dictionary":a instanceof l?"Feature":a instanceof h?"Point":a instanceof b?"Polygon":a instanceof n?"Polyline":a instanceof k?"MultiPoint":a instanceof r?"Envelope":A(a)?"Function":a===V?"Void":"number"===typeof a&&isNaN(a)?"Number":"Unrecognised Type"}function J(a,b,g,d){try{var e=x(a,b.arguments[g]);if(c.equalityTest(e,d))return x(a,b.arguments[g+1]);var p=b.arguments.length-g;return 1===p?x(a,b.arguments[g]):2===p?null:J(a,b,g+2,d)}catch(l){throw l;}}function F(a,b,g,d){try{if(!0===
d)return x(a,b.arguments[g+1]);if(3===b.arguments.length-g)return x(a,b.arguments[g+2]);var e=x(a,b.arguments[g+2]);if(!1===c.isBoolean(e))throw Error("WHEN needs boolean test conditions");return F(a,b,g+2,e)}catch(p){throw p;}}function O(a,b){var c=a.length,g=Math.floor(c/2);if(0===c)return[];if(1===c)return[a[0]];for(var d=O(a.slice(0,g),b),c=O(a.slice(g,c),b),g=[];0<d.length||0<c.length;)if(0<d.length&&0<c.length){var e=b(d[0],c[0]);isNaN(e)&&(e=0);0>=e?(g.push(d[0]),d=d.slice(1)):(g.push(c[0]),
c=c.slice(1))}else 0<d.length?(g.push(d[0]),d=d.slice(1)):0<c.length&&(g.push(c[0]),c=c.slice(1));return g}function N(a,b,c){try{var g=a.body;if(c.length!==a.params.length)throw Error("Invalid Parameter calls to function.");for(var d=0;d<c.length;d++)b.localScope[a.params[d].name.toLowerCase()]={d:null,value:c[d],valueset:!0,node:null};var e=x(b,g);if(e instanceof R)return e.value;if(e===P)throw Error("Cannot Break from a Function");if(e===fa)throw Error("Cannot Continue from a Function");return e instanceof
S?e.value:e}catch(p){throw p;}}function I(a,b,c){return y(a,b,function(b,g,d){b={spatialReference:a.spatialReference,applicationCache:void 0===a.applicationCache?null:a.applicationCache,globalScope:a.globalScope,depthCounter:a.depthCounter+1,localScope:{}};if(64<b.depthCounter)throw Error("Exceeded maximum function depth");return N(c,b,d)})}function B(a){return function(){var b={applicationCache:void 0===a.context.applicationCache?null:a.context.applicationCache,spatialReference:a.context.spatialReference,
localScope:{},depthCounter:a.context.depthCounter+1,globalScope:a.context.globalScope};if(64<b.depthCounter)throw Error("Exceeded maximum function depth");return N(a.definition,b,arguments)}}var R=function(){return function(a){this.value=a}}(),S=function(){return function(a){this.value=a}}(),U=function(){return function(a){this.fn=a}}(),V={type:"VOID"},P={type:"BREAK"},fa={type:"CONTINUE"},X={};t.registerFunctions(X,y);p.registerFunctions(X,y);g.registerFunctions(X,y);s.registerFunctions(X,y,A);v.registerFunctions(X,
y);X["typeof"]=function(a,b){return y(a,b,function(a,b,g){c.pcCheck(g,1,1);a=G(g[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};X.iif=function(a,b){try{c.pcCheck(null===b.arguments?[]:b.arguments,3,3);var g=x(a,b.arguments[0]);if(!1===c.isBoolean(g))throw Error("IF Function must have a boolean test condition");return!0===g?x(a,b.arguments[1]):x(a,b.arguments[2])}catch(d){throw d;}};X.decode=function(a,b){try{if(2>b.arguments.length)throw Error("Missing Parameters");if(2===
b.arguments.length)return x(a,b.arguments[1]);if(0===(b.arguments.length-1)%2)throw Error("Must have a default value result.");var c=x(a,b.arguments[0]);return J(a,b,1,c)}catch(g){throw g;}};X.when=function(a,b){try{if(3>b.arguments.length)throw Error("Missing Parameters");if(0===b.arguments.length%2)throw Error("Must have a default value result.");var g=x(a,b.arguments[0]);if(!1===c.isBoolean(g))throw Error("WHEN needs boolean test conditions");return F(a,b,0,g)}catch(d){throw d;}};X.top=function(a,
b){return y(a,b,function(a,b,g){c.pcCheck(g,2,2);if(c.isArray(g[0]))return g[1].length>=g[0].length?g[0]:g[0].slice(0,c.toNumber(g[1]));throw Error("Top cannot accept this parameter type");})};X.first=function(a,b){return y(a,b,function(a,b,g){c.pcCheck(g,1,1);return c.isArray(g[0])?0===g[0].length?null:g[0][0]:null})};X.sort=function(a,b){return y(a,b,function(a,b,g){c.pcCheck(g,1,2);if(!1===c.isArray(g[0]))throw Error("Illegal Argument");if(1<g.length){if(!1===A(g[1]))throw Error("Illegal Argument");
a=g[0];var d=B(g[1]);a=O(a,function(a,b){return d(a,b)})}else{a=g[0];if(0===a.length)return[];g={};for(b=0;b<a.length;b++){var e=G(a[b]);""!==e&&(g[e]=!0)}if(!0===g.Array||!0===g.Dictionary||!0===g.Feature||!0===g.Point||!0===g.Polygon||!0===g.Polyline||!0===g.MultiPoint||!0===g.Envelope||!0===g.Function)return a.slice(0);b=0;var e="",p;for(p in g)b++,e=p;a=1<b||"String"===e?O(a,function(a,b){return null===a||void 0===a?null===b||void 0===b?0:1:null===b||void 0===b?-1:a.toString()<b.toString()?-1:
a.toString()===b.toString()?0:1}):"Number"===e?O(a,function(a,b){return a-b}):"Boolean"===e?O(a,function(a,b){return a===b?0:a?-1:1}):"Date"===e?O(a,function(a,b){return b-a}):a.slice(0)}return a})};q.functionHelper={fixSpatialReference:c.fixSpatialReference,parseArguments:w,standardFunction:y};q.executeScript=function(a,b,c){c||(c=new d(102100));var g=b.vars,p=b.customfunctions,l={};g||(g={});p||(p={});l.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};l.pi={value:Math.PI,valueset:!0,
node:null};for(var s in X)l[s]={value:new U(X[s]),valueset:!0,node:null};for(s in p)l[s]={value:new U(p[s]),"native":!0,valueset:!0,node:null};for(s in g)l[s]=g[s]instanceof f?{value:new e(g[s]),valueset:!0,node:null}:{value:g[s],valueset:!0,node:null};a=x({spatialReference:c,globalScope:l,localScope:null,depthCounter:1,applicationCache:void 0===b.applicationCache?null:b.applicationCache},a.body[0].body);a instanceof R&&(a=a.value);a instanceof S&&(a=a.value);if(a===V)throw Error("Cannot return VOID");
if(a===P)throw Error("Cannot return BREAK");if(a===fa)throw Error("Cannot return CONTINUE");if(a instanceof u)throw Error("Cannot return FUNCTION");if(a instanceof U)throw Error("Cannot return FUNCTION");return a};q.extractFieldLiterals=function(b,c){void 0===c&&(c=!1);return a.findFieldLiterals(b,c)};q.validateScript=function(b,c){return a.validateScript(b,c,"simple")};q.referencesMember=function(b,c){return a.referencesMember(b,c)};q.referencesFunction=function(b,c){return a.referencesFunction(b,
c)}})},"esri/SpatialReference":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ./kernel ./lang".split(" "),function(m,q,b,f,n,h){var r=[-2.0037508342788905E7,2.0037508342788905E7],k=[-2.0037508342787E7,2.0037508342787E7];m=m(null,{declaredClass:"esri.SpatialReference",constructor:function(d){d&&(b.isObject(d)?b.mixin(this,d):b.isString(d)?this.wkt=d:this.wkid=d)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:r,origin:k,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:r,origin:k,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:r,origin:k,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:r,origin:k,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==q.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==q.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(b){var c=!1;b&&(c=this.isWebMercator()&&4326===b.wkid||b.isWebMercator()&&4326===this.wkid);return c},isWebMercator:function(){return this._isWebMercator()},equals:function(b){var c=!1;b&&(this===b&&
(c=!0),this.wkid||b.wkid?c=this.wkid===b.wkid||this.isWebMercator()&&b.isWebMercator()||this.wkid===b.latestWkid||b.wkid===this.latestWkid:this.wkt&&b.wkt&&(c=this.wkt.toUpperCase()===b.wkt.toUpperCase()));return c},toJson:function(){var b=null,c=h.isDefined;c(this.wkid)?b={wkid:this.wkid}:c(this.wkt)&&(b={wkt:this.wkt});b&&c(this.latestWkid)&&(b.latestWkid=this.latestWkid);return b}});f("extend-esri")&&(n.SpatialReference=m);return m})},"esri/layers/LabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../symbols/TextSymbol ../symbols/ShieldLabelSymbol".split(" "),
function(m,q,b,f,n,h,r,k){m=m(null,{declaredClass:"esri.layers.LabelClass",labelPlacement:null,labelExpression:null,format:null,fieldInfos:null,useCodedValues:null,symbol:null,maxScale:0,minScale:0,where:null,sizeInfo:null,_labelPlacementLookup:{"above-center":"esriServerPointLabelPlacementAboveCenter","above-left":"esriServerPointLabelPlacementAboveLeft","above-right":"esriServerPointLabelPlacementAboveRight","below-center":"esriServerPointLabelPlacementBelowCenter","below-left":"esriServerPointLabelPlacementBelowLeft",
"below-right":"esriServerPointLabelPlacementBelowRight","center-center":"esriServerPointLabelPlacementCenterCenter","center-left":"esriServerPointLabelPlacementCenterLeft","center-right":"esriServerPointLabelPlacementCenterRight","above-after":"esriServerLinePlacementAboveAfter","above-along":"esriServerLinePlacementAboveAlong","above-before":"esriServerLinePlacementAboveBefore","above-start":"esriServerLinePlacementAboveStart","above-end":"esriServerLinePlacementAboveEnd","below-after":"esriServerLinePlacementBelowAfter",
"below-along":"esriServerLinePlacementBelowAlong","below-before":"esriServerLinePlacementBelowBefore","below-start":"esriServerLinePlacementBelowStart","below-end":"esriServerLinePlacementBelowEnd","center-after":"esriServerLinePlacementCenterAfter","center-along":"esriServerLinePlacementCenterAlong","center-before":"esriServerLinePlacementCenterBefore","center-start":"esriServerLinePlacementCenterStart","center-end":"esriServerLinePlacementCenterEnd","always-horizontal":"esriServerPolygonPlacementAlwaysHorizontal"},
constructor:function(b){if(b&&(q.mixin(this,b),this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)||(this.labelPlacement=h.valueOf(this._labelPlacementLookup,b.labelPlacement)),b.format&&(this.format=b.format),b.fieldInfos&&(this.fieldInfos=b.fieldInfos),b.symbol&&(this.symbol="esriSHD"===b.symbol.type?new k(b.symbol):new r(b.symbol)),b=this.sizeInfo))b.minSize&&(b.minSize=f.pt2px(b.minSize)),b.maxSize&&(b.maxSize=f.pt2px(b.maxSize))},getSymbol:function(){return this.symbol},toJson:function(){var b=
this.sizeInfo;b&&(b=q.mixin({},b),b.minSize&&(b.minSize=f.px2pt(b.minSize)),b.maxSize&&(b.maxSize=f.px2pt(b.maxSize)));b={labelExpression:this.labelExpression,labelExpressionInfo:this.labelExpressionInfo&&q.clone(this.labelExpressionInfo),format:this.format,fieldInfos:this.fieldInfos,useCodedValues:this.useCodedValues,maxScale:this.maxScale,minScale:this.minScale,where:this.where,sizeInfo:b,labelPlacement:this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)?this._labelPlacementLookup[this.labelPlacement]:
this.labelPlacement,symbol:this.symbol&&this.symbol.toJson()};return h.fixJson(b)}});b("extend-esri")&&q.setObject("layers.LabelClass",m,n);return m})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(m,q){var b={};m.setObject("dojo.date.stamp",b);b.fromISOString=function(f,n){b._isoRegExp||(b._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var h=b._isoRegExp.exec(f),r=null;if(h){h.shift();h[1]&&
h[1]--;h[6]&&(h[6]*=1E3);n&&(n=new Date(n),q.forEach(q.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(b){return n["get"+b]()}),function(b,a){h[a]=h[a]||b}));r=new Date(h[0]||1970,h[1]||0,h[2]||1,h[3]||0,h[4]||0,h[5]||0,h[6]||0);100>h[0]&&r.setFullYear(h[0]||1970);var k=0,d=h[7]&&h[7].charAt(0);"Z"!=d&&(k=60*(h[8]||0)+(Number(h[9])||0),"-"!=d&&(k*=-1));d&&(k-=r.getTimezoneOffset());k&&r.setTime(r.getTime()+6E4*k)}return r};b.toISOString=function(b,n){var h=function(a){return 10>
a?"0"+a:a};n=n||{};var r=[],k=n.zulu?"getUTC":"get",d="";"time"!=n.selector&&(d=b[k+"FullYear"](),d=["0000".substr((d+"").length)+d,h(b[k+"Month"]()+1),h(b[k+"Date"]())].join("-"));r.push(d);if("date"!=n.selector){d=[h(b[k+"Hours"]()),h(b[k+"Minutes"]()),h(b[k+"Seconds"]())].join(":");k=b[k+"Milliseconds"]();n.milliseconds&&(d+="."+(100>k?"0":"")+h(k));if(n.zulu)d+="Z";else if("time"!=n.selector)var k=b.getTimezoneOffset(),c=Math.abs(k),d=d+((0<k?"-":"+")+h(Math.floor(c/60))+":"+h(c%60));r.push(d)}return r.join("T")};
return b})},"esri/layers/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/Polyline".split(" "),function(m,q,b,f,n,h,r,k){m=m(null,{declaredClass:"esri.layers._GridLayout",constructor:function(b,c,a,e){this.origin=b;this.cellWidth=c.width;this.cellHeight=c.height;this.mapWidth=a.width;this.mapHeight=a.height;this.srInfo=e},setResolution:function(b){this._resolution=(b.xmax-b.xmin)/this.mapWidth;
this.srInfo&&(b=Math.round(2*this.srInfo.valid[1]/this._resolution),b=Math.round(b/this.cellWidth),this._frameStats=[b,0,b-1])},getCellCoordinates:function(b){var c=this._resolution,a=this.origin;return{row:Math.floor((a.y-b.y)/(this.cellHeight*c)),col:Math.floor((b.x-a.x)/(this.cellWidth*c))}},normalize:function(b){var c=this._frameStats;if(c){var a=c[0],e=c[1],c=c[2];b<e?(b%=a,b=b<e?b+a:b):b>c&&(b%=a)}return b},intersects:function(d,c){var a=this.srInfo;return a?b.some(c._getParts(a),function(a){return d.intersects(a.extent)}):
d.intersects(c)},getCellExtent:function(b,c){var a=this._resolution,e=this.origin,l=this.cellWidth,k=this.cellHeight;return new r(c*l*a+e.x,e.y-(b+1)*k*a,(c+1)*l*a+e.x,e.y-b*k*a,new h(e.spatialReference.toJson()))},getLatticeID:function(b){var c=this.getCellCoordinates({x:b.xmin,y:b.ymax}),a=this.getCellCoordinates({x:b.xmax,y:b.ymin});b=c.row;var e=a.row,c=this.normalize(c.col),a=this.normalize(a.col);return b+"_"+e+"_"+c+"_"+a},sorter:function(b,c){return b<c?-1:1},getCellsInExtent:function(b,c){var a=
this.getCellCoordinates({x:b.xmin,y:b.ymax}),e=this.getCellCoordinates({x:b.xmax,y:b.ymin}),l=a.row,h=e.row,a=a.col,e=e.col,t=[],p,g,s,v=[],w=[],f,n,r,q=[];for(p=l;p<=h;p++)for(g=a;g<=e;g++)s=this.normalize(g),b=this.getCellExtent(p,s),t.push({row:p,col:s,extent:b,resolution:this._resolution}),c&&(v.push(b.xmin,b.xmax),w.push(b.ymin,b.ymax));a=this.normalize(a);e=this.normalize(e);v.sort(this.sorter);w.sort(this.sorter);g=v.length;for(p=g-1;0<=p;p--)p<g-1&&v[p]===v[p+1]&&v.splice(p,1);g=w.length;
for(p=g-1;0<=p;p--)p<g-1&&w[p]===w[p+1]&&w.splice(p,1);if(v.length&&w.length){s=v[0];f=v[v.length-1];n=w[0];r=w[w.length-1];g=v.length;for(p=0;p<g;p++)q.push([[v[p],r],[v[p],n]]);g=w.length;for(p=0;p<g;p++)q.push([[s,w[p]],[f,w[p]]]);p=new k({paths:q,spatialReference:this.origin.spatialReference.toJson()});t.push({latticeID:l+"_"+h+"_"+a+"_"+e,lattice:p,resolution:this._resolution})}return{minRow:l,maxRow:h,minCol:a,maxCol:e,cells:t}}});f("extend-esri")&&q.setObject("layers._GridLayout",m,n);return m})},
"esri/layers/FeatureTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../graphic".split(" "),function(m,q,b,f,n,h){m=m(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(b){b&&q.isObject(b)&&(this.name=b.name,this.description=b.description,this.drawingTool=b.drawingTool,b=b.prototype,this.prototype=new h(b.geometry,null,b.attributes))},toJson:function(){return n.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,
prototype:this.prototype&&this.prototype.toJson()})}});q.mixin(m,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",
TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});b("extend-esri")&&q.setObject("layers.FeatureTemplate",m,f);return m})},"esri/arcade/lib/esprima":function(){(function(m,q){"function"===typeof define&&define.amd?define(["exports"],q):"undefined"!==typeof exports?q(exports):q(m.esprima={})})(this,function(m){function q(a,b){if(!a)throw Error("ASSERT: "+b);}function b(a){return 48<=
a&&57>=a}function f(a){return 0<="0123456789abcdefABCDEF".indexOf(a)}function n(a){return 0<="01234567".indexOf(a)}function h(a){return 10===a||13===a||8232===a||8233===a}function r(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||92===a||128<=a&&Oa.NonAsciiIdentifierStart.test(String.fromCharCode(a))}function k(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||48<=a&&57>=a||92===a||128<=a&&Oa.NonAsciiIdentifierPart.test(String.fromCharCode(a))}function d(a){switch(a){default:return!1}}
function c(a){if(ha&&d(a))return!0;a=a.toLowerCase();switch(a.length){case 2:return"if"===a||"in"===a;case 3:return"var"===a||"for"===a;case 4:return"else"===a;case 5:return"break"===a;case 6:return"return"===a;case 8:return"function"===a.toLowerCase()||"continue"===a;default:return!1}}function a(a,b,c,g,d){q("number"===typeof c,"Comment must have valid position");Y.lastCommentStart>=c||(Y.lastCommentStart=c,a={type:a,value:b},L.range&&(a.range=[c,g]),L.loc&&(a.loc=d),L.comments.push(a),L.attachComment&&
(L.leadingComments.push(a),L.trailingComments.push(a)))}function e(b){var c,g,d;c=z-b;for(g={start:{line:$,column:z-ea-b}};z<ka;)if(d=M.charCodeAt(z),++z,h(d)){L.comments&&(b=M.slice(c+b,z-1),g.end={line:$,column:z-ea-1},a("Line",b,c,z-1,g));13===d&&10===M.charCodeAt(z)&&++z;++$;ea=z;return}L.comments&&(b=M.slice(c+b,z),g.end={line:$,column:z-ea},a("Line",b,c,z,g))}function l(){var b,c;for(c=0===z;z<ka;)if(b=M.charCodeAt(z),32===b||9===b||11===b||12===b||160===b||5760<=b&&0<=[5760,6158,8192,8193,
8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(b))++z;else if(h(b))++z,13===b&&10===M.charCodeAt(z)&&++z,++$,ea=z,c=!0;else if(47===b)if(b=M.charCodeAt(z+1),47===b)++z,++z,e(2),c=!0;else if(42===b){++z;++z;a:{var g=b=void 0,d=void 0,d=void 0;L.comments&&(b=z-2,g={start:{line:$,column:z-ea-2}});for(;z<ka;)if(d=M.charCodeAt(z),h(d))13===d&&10===M.charCodeAt(z+1)&&++z,++$,++z,ea=z,z>=ka&&B();else{if(42===d&&47===M.charCodeAt(z+1)){++z;++z;L.comments&&(d=M.slice(b+2,z-2),
g.end={line:$,column:z-ea},a("Block",d,b,z,g));break a}++z}B()}}else break;else if(c&&45===b)if(45===M.charCodeAt(z+1)&&62===M.charCodeAt(z+2))z+=3,e(3);else break;else if(60===b)if("!--"===M.slice(z+1,z+4))++z,++z,++z,++z,e(4);else break;else break}function u(a){var b,c,g=0;b="u"===a?4:2;for(a=0;a<b;++a)if(z<ka&&f(M[z]))c=M[z++],g=16*g+"0123456789abcdef".indexOf(c.toLowerCase());else return"";return String.fromCharCode(g)}function t(){var a,b;a=M.charCodeAt(z++);b=String.fromCharCode(a);92===a&&
(117!==M.charCodeAt(z)&&B(),++z,a=u("u"),(!a||"\\"===a||!r(a.charCodeAt(0)))&&B(),b=a);for(;z<ka;){a=M.charCodeAt(z);if(!k(a))break;++z;b+=String.fromCharCode(a);92===a&&(b=b.substr(0,b.length-1),117!==M.charCodeAt(z)&&B(),++z,a=u("u"),(!a||"\\"===a||!k(a.charCodeAt(0)))&&B(),b+=a)}return b}function p(){var a=z,b=M.charCodeAt(z),c,g=M[z];switch(b){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++z,L.tokenize&&(40===b?L.openParenToken=L.tokens.length:
123===b&&(L.openCurlyToken=L.tokens.length)),{type:Q.Punctuator,value:String.fromCharCode(b),lineNumber:$,lineStart:ea,start:a,end:z};default:if(c=M.charCodeAt(z+1),61===c)switch(b){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return z+=2,{type:Q.Punctuator,value:String.fromCharCode(b)+String.fromCharCode(c),lineNumber:$,lineStart:ea,start:a,end:z};case 33:case 61:return z+=2,61===M.charCodeAt(z)&&++z,{type:Q.Punctuator,value:M.slice(a,z),lineNumber:$,lineStart:ea,
start:a,end:z}}}b=M.substr(z,4);if("\x3e\x3e\x3e\x3d"===b)return z+=4,{type:Q.Punctuator,value:b,lineNumber:$,lineStart:ea,start:a,end:z};b=b.substr(0,3);if("\x3e\x3e\x3e"===b||"\x3c\x3c\x3d"===b||"\x3e\x3e\x3d"===b)return z+=3,{type:Q.Punctuator,value:b,lineNumber:$,lineStart:ea,start:a,end:z};b=b.substr(0,2);if(g===b[1]&&0<="+-\x3c\x3e\x26|".indexOf(g)||"\x3d\x3e"===b)return z+=2,{type:Q.Punctuator,value:b,lineNumber:$,lineStart:ea,start:a,end:z};if(0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(g))return++z,
{type:Q.Punctuator,value:g,lineNumber:$,lineStart:ea,start:a,end:z};B()}function g(){var a,c,g;g=M[z];q(b(g.charCodeAt(0))||"."===g,"Numeric literal must start with a decimal digit or a decimal point");c=z;a="";if("."!==g){a=M[z++];g=M[z];if("0"===a){if("x"===g||"X"===g){++z;for(a="";z<ka&&f(M[z]);)a+=M[z++];0===a.length&&B();r(M.charCodeAt(z))&&B();return{type:Q.NumericLiteral,value:parseInt("0x"+a,16),lineNumber:$,lineStart:ea,start:c,end:z}}if("b"===g||"B"===g){++z;for(g="";z<ka;){a=M[z];if("0"!==
a&&"1"!==a)break;g+=M[z++]}0===g.length&&B();z<ka&&(a=M.charCodeAt(z),(r(a)||b(a))&&B());return{type:Q.NumericLiteral,value:parseInt(g,2),lineNumber:$,lineStart:ea,start:c,end:z}}if("o"===g||"O"===g||n(g)){n(g)?(g=!0,a="0"+M[z++]):(g=!1,++z,a="");for(;z<ka&&n(M[z]);)a+=M[z++];!g&&0===a.length&&B();(r(M.charCodeAt(z))||b(M.charCodeAt(z)))&&B();return{type:Q.NumericLiteral,value:parseInt(a,8),octal:g,lineNumber:$,lineStart:ea,start:c,end:z}}g&&b(g.charCodeAt(0))&&B()}for(;b(M.charCodeAt(z));)a+=M[z++];
g=M[z]}if("."===g){for(a+=M[z++];b(M.charCodeAt(z));)a+=M[z++];g=M[z]}if("e"===g||"E"===g){a+=M[z++];g=M[z];if("+"===g||"-"===g)a+=M[z++];if(b(M.charCodeAt(z)))for(;b(M.charCodeAt(z));)a+=M[z++];else B()}r(M.charCodeAt(z))&&B();return{type:Q.NumericLiteral,value:parseFloat(a),lineNumber:$,lineStart:ea,start:c,end:z}}function s(){W=null;l();O("Regular Expression language structures not supported")}function v(){l();s()}function w(){var a;a=L.tokens[L.tokens.length-1];if(!a)return v();if("Punctuator"===
a.type){if("]"===a.value)return p();if(")"===a.value)return(a=L.tokens[L.openParenToken-1])&&"Keyword"===a.type&&("if"===a.value.toLowerCase()||"while"===a.value.toLowerCase()||"for"===a.value.toLowerCase()||"with"===a.value.toLowerCase())?v():p();if("}"===a.value){if(L.tokens[L.openCurlyToken-3]&&"Keyword"===L.tokens[L.openCurlyToken-3].type){if(a=L.tokens[L.openCurlyToken-4],!a)return p()}else if(L.tokens[L.openCurlyToken-4]&&"Keyword"===L.tokens[L.openCurlyToken-4].type){if(a=L.tokens[L.openCurlyToken-
5],!a)return v()}else return p();if(0<=Ea.indexOf(a.value))return p()}return v()}return"Keyword"===a.type&&"this"!==a.value?v():p()}function y(){var a;l();if(z>=ka)return{type:Q.EOF,lineNumber:$,lineStart:ea,start:z,end:z};a=M.charCodeAt(z);if(r(a)){var d;a=z;if(92===M.charCodeAt(z))d=t();else a:{var e;for(d=z++;z<ka;){e=M.charCodeAt(z);if(92===e){z=d;d=t();break a}if(k(e))++z;else break}d=M.slice(d,z)}return{type:1===d.length?Q.Identifier:c(d)?Q.Keyword:"null"===d.toLowerCase()?Q.NullLiteral:"true"===
d.toLowerCase()||"false"===d.toLowerCase()?Q.BooleanLiteral:Q.Identifier,value:d,lineNumber:$,lineStart:ea,start:a,end:z}}if(40===a||41===a||59===a)return p();if(39===a||34===a){var s="",v,m,x;e=!1;var A,y;A=$;y=ea;a=M[z];q("'"===a||'"'===a,"String literal must starts with a quote");d=z;for(++z;z<ka;)if(v=M[z++],v===a){a="";break}else if("\\"===v)if(v=M[z++],!v||!h(v.charCodeAt(0)))switch(v){case "u":case "x":if("{"===M[z]){++z;m=v=m=void 0;m=M[z];v=0;for("}"===m&&B();z<ka;){m=M[z++];if(!f(m))break;
v=16*v+"0123456789abcdef".indexOf(m.toLowerCase())}(1114111<v||"}"!==m)&&B();65535>=v?v=String.fromCharCode(v):(m=(v-65536>>10)+55296,v=String.fromCharCode(m,(v-65536&1023)+56320));s+=v}else x=z,(m=u(v))?s+=m:(z=x,s+=v);break;case "n":s+="\n";break;case "r":s+="\r";break;case "t":s+="\t";break;case "b":s+="\b";break;case "f":s+="\f";break;case "v":s+="\x0B";break;default:n(v)?(m="01234567".indexOf(v),0!==m&&(e=!0),z<ka&&n(M[z])&&(e=!0,m=8*m+"01234567".indexOf(M[z++]),0<="0123".indexOf(v)&&(z<ka&&
n(M[z]))&&(m=8*m+"01234567".indexOf(M[z++]))),s+=String.fromCharCode(m)):s+=v}else++$,"\r"===v&&"\n"===M[z]&&++z,ea=z;else if(h(v.charCodeAt(0)))break;else s+=v;""!==a&&B();return{type:Q.StringLiteral,value:s,octal:e,startLineNumber:A,startLineStart:y,lineNumber:$,lineStart:ea,start:d,end:z}}return 46===a?b(M.charCodeAt(z+1))?g():p():b(a)?g():L.tokenize&&47===a?w():p()}function A(){var a,b,c;l();a={start:{line:$,column:z-ea}};b=y();a.end={line:$,column:z-ea};b.type!==Q.EOF&&(c=M.slice(b.start,b.end),
a={type:na[b.type],value:c,range:[b.start,b.end],loc:a},b.regex&&(a.regex={pattern:b.regex.pattern,flags:b.regex.flags}),L.tokens.push(a));return b}function x(){var a;a=W;z=a.end;$=a.lineNumber;ea=a.lineStart;W="undefined"!==typeof L.tokens?A():y();z=a.end;$=a.lineNumber;ea=a.lineStart;return a}function D(){var a,b,c;a=z;b=$;c=ea;W="undefined"!==typeof L.tokens?A():y();z=a;$=b;ea=c}function K(){this.line=$;this.column=z-ea}function E(){this.start=new K;this.end=null}function C(a){this.start=a.type===
Q.StringLiteral?{line:a.startLineNumber,column:a.start-a.startLineStart}:{line:a.lineNumber,column:a.start-a.lineStart};this.end=null}function H(){z=W.start;W.type===Q.StringLiteral?($=W.startLineNumber,ea=W.startLineStart):($=W.lineNumber,ea=W.lineStart);L.range&&(this.range=[z,0]);L.loc&&(this.loc=new E)}function G(a){L.range&&(this.range=[a.start,0]);L.loc&&(this.loc=new C(a))}function J(){var a,b,c,g;a=z;b=$;c=ea;l();g=$!==b;z=a;$=b;ea=c;return g}function F(a,b,c){var g=Error("Line "+a+": "+c);
g.index=b;g.lineNumber=a;g.column=b-ea+1;g.description=c;return g}function O(a){var b,c;b=Array.prototype.slice.call(arguments,1);c=a.replace(/%(\d)/g,function(a,c){q(c<b.length,"Message reference must be in range");return b[c]});throw F($,z,c);}function N(a){var b,c;b=Array.prototype.slice.call(arguments,1);c=a.replace(/%(\d)/g,function(a,c){q(c<b.length,"Message reference must be in range");return b[c]});c=F($,z,c);if(L.errors)L.errors.push(c);else throw c;}function I(a,b){var c=ba.UnexpectedToken;
a&&(c=b?b:a.type===Q.EOF?ba.UnexpectedEOS:a.type===Q.Identifier?ba.UnexpectedIdentifier:a.type===Q.NumericLiteral?ba.UnexpectedNumber:a.type===Q.StringLiteral?ba.UnexpectedString:ba.UnexpectedToken,a.type===Q.Keyword&&ha&&d(a.value)&&(c=ba.StrictReservedWord));c=c.replace("%0",a?a.value:"ILLEGAL");return a&&"number"===typeof a.lineNumber?F(a.lineNumber,a.start,c):F($,z,c)}function B(a,b){throw I(a,b);}function R(a,b){var c=I(a,b);if(L.errors)L.errors.push(c);else throw c;}function S(a){var b=x();
(b.type!==Q.Punctuator||b.value!==a)&&B(b)}function U(){var a;L.errors?(a=W,a.type===Q.Punctuator&&","===a.value?x():a.type===Q.Punctuator&&";"===a.value?(x(),R(a)):R(a,ba.UnexpectedToken)):S(",")}function V(a){var b=x();(b.type!==Q.Keyword||b.value.toLowerCase()!==a.toLowerCase())&&B(b)}function P(a){return W.type===Q.Punctuator&&W.value===a}function fa(a){return W.type===Q.Keyword&&W.value.toLowerCase()===a.toLowerCase()}function X(){var a;59===M.charCodeAt(z)||P(";")?x():(a=$,l(),$===a&&W.type!==
Q.EOF&&!P("}")&&B(W))}function sa(a){return a.type===Z.Identifier||a.type===Z.MemberExpression}function da(a,b){var c,g,d=new H;c=ha;g=Ta();ha=c;return d.finishFunctionExpression(null,a,[],g)}function aa(){var a,b;a=ha;ha=!0;b=Ua();b=da(b.params);ha=a;return b}function ja(){var a,b=new H;a=x();return a.type===Q.StringLiteral||a.type===Q.NumericLiteral?(ha&&a.octal&&R(a,ba.StrictOctalLiteral),b.finishLiteral(a)):b.finishIdentifier(a.value)}function ua(){var a,b,c,g=new H;a=W;if(a.type===Q.Identifier)return b=
ja(),"get"===a.value&&!P(":")&&!P("(")?(b=ja(),S("("),S(")"),a=da([]),g.finishProperty("get",b,a,!1,!1)):"set"===a.value&&!P(":")&&!P("(")?(b=ja(),S("("),a=W,a.type!==Q.Identifier?(S(")"),R(a),a=da([])):(c=[Ba()],S(")"),a=da(c,a)),g.finishProperty("set",b,a,!1,!1)):P(":")?(x(),a=va(),g.finishProperty("init",b,a,!1,!1)):P("(")?(a=aa(),g.finishProperty("init",b,a,!0,!1)):g.finishProperty("init",b,b,!1,!0);if(a.type===Q.EOF||a.type===Q.Punctuator)B(a);else{b=ja();if(P(":"))return x(),a=va(),g.finishProperty("init",
b,a,!1,!1);if(P("("))return a=aa(),g.finishProperty("init",b,a,!0,!1);B(x())}}function ma(){var a,b,c,g;if(P("("))return S("("),P(")")?(x(),b=Fa.ArrowParameterPlaceHolder):(++Y.parenthesisCount,b=ya(),S(")")),b;if(P("[")){b=[];var e=new H;for(S("[");!P("]");)P(",")?(x(),b.push(null)):(b.push(va()),P("]")||S(","));x();return e.finishArrayExpression(b)}if(P("{")){b=[];var p;a={};c=String;var l=new H;for(S("{");!P("}");)e=ua(),p=e.key.type===Z.Identifier?e.key.name:c(e.key.value),g="init"===e.kind?Ha.Data:
"get"===e.kind?Ha.Get:Ha.Set,p="$"+p,Object.prototype.hasOwnProperty.call(a,p)?(a[p]===Ha.Data?ha&&g===Ha.Data?N(ba.StrictDuplicateProperty):g!==Ha.Data&&N(ba.AccessorDataProperty):g===Ha.Data?N(ba.AccessorDataProperty):a[p]&g&&N(ba.AccessorGetSet),a[p]|=g):a[p]=g,b.push(e),P("}")||U();S("}");return l.finishObjectExpression(b)}a=W.type;g=new H;if(a===Q.Identifier)c=g.finishIdentifier(x().value);else if(a===Q.StringLiteral||a===Q.NumericLiteral)ha&&W.octal&&R(W,ba.StrictOctalLiteral),c=g.finishLiteral(x());
else if(a===Q.Keyword){if(fa("function")){g=null;var t,l=[];p=[];var k;a=new H;V("function");P("(")||(c=W,g=Ba(),!ha&&d(c.value)&&(b=c,e=ba.StrictReservedWord));t=Ua(b);l=t.params;p=t.defaults;c=t.stricted;b=t.firstRestricted;t.message&&(e=t.message);k=ha;t=Ta();ha&&b&&B(b,e);ha&&c&&R(c,e);ha=k;return a.finishFunctionExpression(g,l,p,t)}fa("this")?(x(),c=g.finishThisExpression()):B(x())}else a===Q.BooleanLiteral?(b=x(),b.value="true"===b.value.toLowerCase(),c=g.finishLiteral(b)):a===Q.NullLiteral?
(b=x(),b.value=null,c=g.finishLiteral(b)):P("/")||P("/\x3d")?(c="undefined"!==typeof L.tokens?g.finishLiteral(v()):g.finishLiteral(s()),D()):B(x());return c}function pa(){var a=[];S("(");if(!P(")"))for(;z<ka;){a.push(va());if(P(")"))break;U()}S(")");return a}function qa(){S(".");var a,b=new H;a=x();a.type===Q.Identifier||(a.type===Q.Keyword||a.type===Q.BooleanLiteral||a.type===Q.NullLiteral)||B(a);return b.finishIdentifier(a.value)}function ra(){var a;S("[");a=ya();S("]");return a}function ca(){var a,
b,c=new H;V("new");var g;q(Y.allowIn,"callee of new expression always allow in keyword.");g=W;for(a=fa("new")?ca():ma();;)if(P("["))b=ra(),a=(new G(g)).finishMemberExpression("[",a,b);else if(P("."))b=qa(),a=(new G(g)).finishMemberExpression(".",a,b);else break;b=P("(")?pa():[];return c.finishNewExpression(a,b)}function za(){var a,b,c=W,g,d=Y.allowIn;b=W;Y.allowIn=!0;for(a=fa("new")?ca():ma();;)if(P("."))g=qa(),a=(new G(b)).finishMemberExpression(".",a,g);else if(P("("))g=pa(),a=(new G(b)).finishCallExpression(a,
g);else if(P("["))g=ra(),a=(new G(b)).finishMemberExpression("[",a,g);else break;Y.allowIn=d;if(W.type===Q.Punctuator&&(P("++")||P("--"))&&!J())sa(a)||N(ba.InvalidLHSInAssignment),b=x(),a=(new G(c)).finishPostfixExpression(b.value,a);return a}function oa(){var a,b,c;W.type!==Q.Punctuator&&W.type!==Q.Keyword?b=za():P("++")||P("--")?(c=W,a=x(),b=oa(),sa(b)||N(ba.InvalidLHSInAssignment),b=(new G(c)).finishUnaryExpression(a.value,b)):P("+")||P("-")||P("~")||P("!")?(c=W,a=x(),b=oa(),b=(new G(c)).finishUnaryExpression(a.value,
b)):fa("delete")||fa("void")||fa("typeof")?(c=W,a=x(),b=oa(),b=(new G(c)).finishUnaryExpression(a.value,b),ha&&("delete"===b.operator&&b.argument.type===Z.Identifier)&&N(ba.StrictDelete)):b=za();return b}function xa(a,b){var c=0;if(a.type!==Q.Punctuator&&a.type!==Q.Keyword)return 0;switch(a.value){case "||":c=1;break;case "\x26\x26":c=2;break;case "|":c=3;break;case "^":c=4;break;case "\x26":c=5;break;case "\x3d\x3d":case "!\x3d":case "\x3d\x3d\x3d":case "!\x3d\x3d":c=6;break;case "\x3c":case "\x3e":case "\x3c\x3d":case "\x3e\x3d":case "instanceof":c=
7;break;case "in":c=b?7:0;break;case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":c=8;break;case "+":case "-":c=9;break;case "*":case "/":case "%":c=11}return c}function Ca(){var a,b,c,g,d,e;a=W;b=oa();if(b===Fa.ArrowParameterPlaceHolder)return b;c=W;g=xa(c,Y.allowIn);if(0===g)return b;c.prec=g;x();a=[a,W];e=oa();for(d=[b,c,e];0<(g=xa(W,Y.allowIn));){for(;2<d.length&&g<=d[d.length-2].prec;)e=d.pop(),c=d.pop().value,b=d.pop(),a.pop(),b=(new G(a[a.length-1])).finishBinaryExpression(c,b,e),d.push(b);
c=x();c.prec=g;d.push(c);a.push(W);b=oa();d.push(b)}g=d.length-1;b=d[g];for(a.pop();1<g;)b=(new G(a.pop())).finishBinaryExpression(d[g-1].value,d[g-2],b),g-=2;return b}function wa(a){var b,c,g,d,e,p,l;d=[];e=[];p=0;l={paramSet:{}};b=0;for(c=a.length;b<c;b+=1)if(g=a[b],g.type===Z.Identifier)d.push(g),e.push(null),Qa(l,g,g.name);else if(g.type===Z.AssignmentExpression)d.push(g.left),e.push(g.right),++p,Qa(l,g.left,g.left.name);else return null;l.message===ba.StrictParamDupe&&(a=ha?l.stricted:l.firstRestricted,
B(a,l.message));0===p&&(e=[]);return{params:d,defaults:e,rest:null,stricted:l.stricted,firstRestricted:l.firstRestricted,message:l.message}}function va(){var a,b,c,g;a=Y.parenthesisCount;g=W;var d,e,p;p=W;b=Ca();b!==Fa.ArrowParameterPlaceHolder&&P("?")&&(x(),d=Y.allowIn,Y.allowIn=!0,e=va(),Y.allowIn=d,S(":"),d=va(),b=(new G(p)).finishConditionalExpression(b,e,d));if(b===Fa.ArrowParameterPlaceHolder||P("\x3d\x3e"))if(Y.parenthesisCount===a||Y.parenthesisCount===a+1)if(b.type===Z.Identifier?c=wa([b]):
b.type===Z.AssignmentExpression?c=wa([b]):b.type===Z.SequenceExpression?c=wa(b.expressions):b===Fa.ArrowParameterPlaceHolder&&(c=wa([])),c)return a=c,g=new G(g),S("\x3d\x3e"),c=ha,b=P("{")?Ta():va(),ha&&a.firstRestricted&&B(a.firstRestricted,a.message),ha&&a.stricted&&R(a.stricted,a.message),ha=c,g.finishArrowFunctionExpression(a.params,a.defaults,b,b.type!==Z.BlockStatement);W.type!==Q.Punctuator?a=!1:(a=W.value,a="\x3d"===a||"*\x3d"===a||"/\x3d"===a||"%\x3d"===a||"+\x3d"===a||"-\x3d"===a||"\x3c\x3c\x3d"===
a||"\x3e\x3e\x3d"===a||"\x3e\x3e\x3e\x3d"===a||"\x26\x3d"===a||"^\x3d"===a||"|\x3d"===a);a&&(sa(b)||N(ba.InvalidLHSInAssignment),a=x(),c=va(),b=(new G(g)).finishAssignmentExpression(a.value,b,c));return b}function ya(){var a,b=W;a=va();if(P(",")){for(a=[a];z<ka&&P(",");)x(),a.push(va());a=(new G(b)).finishSequenceExpression(a)}return a}function Ba(){var a,b=new H;a=x();a.type!==Q.Identifier&&(ha&&a.type===Q.Keyword&&d(a.value)?R(a,ba.StrictReservedWord):B(a));return b.finishIdentifier(a.value)}function Va(a){var b=
null,c,g=new H;c=Ba();"const"===a?(S("\x3d"),b=va()):P("\x3d")&&(x(),b=va());return g.finishVariableDeclarator(c,b)}function Na(a){var b=[];do{b.push(Va(a));if(!P(","))break;x()}while(z<ka);return b}function ia(){var a=W.type,b,c,g;a===Q.EOF&&B(W);if(a===Q.Punctuator&&"{"===W.value){g=new H;S("{");for(b=[];z<ka&&!P("}");){c=Ma();if("undefined"===typeof c)break;b.push(c)}S("}");return g.finishBlockStatement(b)}g=new H;if(a===Q.Punctuator)switch(W.value){case ";":return g=new H,S(";"),g.finishEmptyStatement();
case "(":return b=ya(),X(),g.finishExpressionStatement(b)}else if(a===Q.Keyword)switch(W.value.toLowerCase()){case "break":return b=null,V("break"),59===M.charCodeAt(z)?(x(),!Y.inIteration&&!Y.inSwitch&&O(ba.IllegalBreak),g=g.finishBreakStatement(null)):J()?(!Y.inIteration&&!Y.inSwitch&&O(ba.IllegalBreak),g=g.finishBreakStatement(null)):(W.type===Q.Identifier&&(b=Ba(),c="$"+b.name,Object.prototype.hasOwnProperty.call(Y.labelSet,c)||O(ba.UnknownLabel,b.name)),X(),null===b&&(!Y.inIteration&&!Y.inSwitch)&&
O(ba.IllegalBreak),g=g.finishBreakStatement(b)),g;case "continue":return b=null,V("continue"),59===M.charCodeAt(z)?(x(),Y.inIteration||O(ba.IllegalContinue),g=g.finishContinueStatement(null)):J()?(Y.inIteration||O(ba.IllegalContinue),g=g.finishContinueStatement(null)):(W.type===Q.Identifier&&(b=Ba(),c="$"+b.name,Object.prototype.hasOwnProperty.call(Y.labelSet,c)||O(ba.UnknownLabel,b.name)),X(),null===b&&!Y.inIteration&&O(ba.IllegalContinue),g=g.finishContinueStatement(b)),g;case "for":var d,e,p,l;
p=Y.allowIn;d=a=e=null;V("for");S("(");if(P(";"))x();else{if(fa("var")){Y.allowIn=!1;var s=new H;d=x();l=Na();d=s.finishVariableDeclaration(l,d.value);Y.allowIn=p;1===d.declarations.length&&fa("in")&&(x(),b=d,c=ya(),d=null)}else Y.allowIn=!1,d=ya(),Y.allowIn=p,fa("in")&&(sa(d)||N(ba.InvalidLHSInForIn),x(),b=d,c=ya(),d=null);"undefined"===typeof b&&S(";")}"undefined"===typeof b&&(P(";")||(a=ya()),S(";"),P(")")||(e=ya()));S(")");l=Y.inIteration;Y.inIteration=!0;p=ia();Y.inIteration=l;return"undefined"===
typeof b?g.finishForStatement(d,a,e,p):g.finishForInStatement(b,c,p);case "function":return hb(g);case "if":return V("if"),S("("),b=ya(),S(")"),c=ia(),fa("else")?(x(),a=ia()):a=null,g.finishIfStatement(b,c,a);case "return":return b=null,V("return"),Y.inFunctionBody||N(ba.IllegalReturn),32===M.charCodeAt(z)&&r(M.charCodeAt(z+1))?(b=ya(),X(),g=g.finishReturnStatement(b)):J()?g=g.finishReturnStatement(null):(P(";")||!P("}")&&W.type!==Q.EOF&&(b=ya()),X(),g=g.finishReturnStatement(b)),g;case "var":return V("var"),
b=Na(),X(),g.finishVariableDeclaration(b,"var")}b=ya();if(b.type===Z.Identifier&&P(":"))return x(),a="$"+b.name,Object.prototype.hasOwnProperty.call(Y.labelSet,a)&&O(ba.Redeclaration,"Label",b.name),Y.labelSet[a]=!0,c=ia(),delete Y.labelSet[a],g.finishLabeledStatement(b,c);X();return g.finishExpressionStatement(b)}function Ta(){var a,b=[],c,g,d,e,p,l=new H;for(S("{");z<ka&&W.type===Q.StringLiteral;){c=W;a=Ma();b.push(a);if(a.expression.type!==Z.Literal)break;a=M.slice(c.start+1,c.end-1);"use strict"===
a?(ha=!0,g&&R(g,ba.StrictOctalLiteral)):!g&&c.octal&&(g=c)}c=Y.labelSet;g=Y.inIteration;d=Y.inSwitch;e=Y.inFunctionBody;p=Y.parenthesizedCount;Y.labelSet={};Y.inIteration=!1;Y.inSwitch=!1;Y.inFunctionBody=!0;for(Y.parenthesizedCount=0;z<ka&&!P("}");){a=Ma();if("undefined"===typeof a)break;b.push(a)}S("}");Y.labelSet=c;Y.inIteration=g;Y.inSwitch=d;Y.inFunctionBody=e;Y.parenthesizedCount=p;return l.finishBlockStatement(b)}function Qa(a,b,c){var g="$"+c;ha?Object.prototype.hasOwnProperty.call(a.paramSet,
g)&&(a.stricted=b,a.message=ba.StrictParamDupe):a.firstRestricted||(d(c)?(a.firstRestricted=b,a.message=ba.StrictReservedWord):Object.prototype.hasOwnProperty.call(a.paramSet,g)&&(a.firstRestricted=b,a.message=ba.StrictParamDupe));a.paramSet[g]=!0}function Ua(a){a={params:[],defaultCount:0,defaults:[],firstRestricted:a};S("(");if(!P(")"))for(a.paramSet={};z<ka;){var b=a,c=void 0,g=void 0,d=void 0,c=W,g=Ba();Qa(b,c,c.value);P("\x3d")&&(x(),d=va(),++b.defaultCount);b.params.push(g);b.defaults.push(d);
if(P(")"))break;S(",")}S(")");0===a.defaultCount&&(a.defaults=[]);return{params:a.params,defaults:a.defaults,stricted:a.stricted,firstRestricted:a.firstRestricted,message:a.message}}function hb(){var a,b=[],c=[],g,e,p,l,s,t=new H;V("function");b=W;a=Ba();!ha&&d(b.value)&&(p=b,l=ba.StrictReservedWord);g=Ua(p);b=g.params;c=g.defaults;e=g.stricted;p=g.firstRestricted;g.message&&(l=g.message);s=ha;g=Ta();ha&&p&&B(p,l);ha&&e&&R(e,l);ha=s;return t.finishFunctionDeclaration(a,b,c,g)}function Ma(){if(W.type===
Q.Keyword)switch(W.value){default:return"function"==W.value.toLowerCase()?hb():ia()}if(W.type!==Q.EOF)return ia()}function Ka(){var a,b,c,g=[];for(a=0;a<L.tokens.length;++a)b=L.tokens[a],c={type:b.type,value:b.value},b.regex&&(c.regex={pattern:b.regex.pattern,flags:b.regex.flags}),L.range&&(c.range=b.range),L.loc&&(c.loc=b.loc),g.push(c);L.tokens=g}var Q,na,Ea,Z,Fa,Ha,ba,Oa,M,ha,z,$,ea,ka,W,Y,L;Q={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,
RegularExpression:9};na={};na[Q.BooleanLiteral]="Boolean";na[Q.EOF]="\x3cend\x3e";na[Q.Identifier]="Identifier";na[Q.Keyword]="Keyword";na[Q.NullLiteral]="Null";na[Q.NumericLiteral]="Numeric";na[Q.Punctuator]="Punctuator";na[Q.StringLiteral]="String";na[Q.RegularExpression]="RegularExpression";Ea="( { [ in typeof instanceof new return case delete throw void \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3c\x3c\x3d \x3e\x3e\x3d \x3e\x3e\x3e\x3d \x26\x3d |\x3d ^\x3d , + - * / % ++ -- \x3c\x3c \x3e\x3e \x3e\x3e\x3e \x26 | ^ ! ~ \x26\x26 || ? : \x3d\x3d\x3d \x3d\x3d \x3e\x3d \x3c\x3d \x3c \x3e !\x3d !\x3d\x3d".split(" ");
Z={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",
FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"};Fa={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};
Ha={Data:1,Get:2,Set:4};ba={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",
MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",
StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",
AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};Oa={NonAsciiIdentifierStart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),
NonAsciiIdentifierPart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")};
G.prototype=H.prototype={processComment:function(){var a,b,c,g=L.bottomRightStack,d,e,p=g[g.length-1];if(!(this.type===Z.Program&&0<this.body.length)){if(0<L.trailingComments.length){c=[];for(d=L.trailingComments.length-1;0<=d;--d)e=L.trailingComments[d],e.range[0]>=this.range[1]&&(c.unshift(e),L.trailingComments.splice(d,1));L.trailingComments=[]}else p&&(p.trailingComments&&p.trailingComments[0].range[0]>=this.range[1])&&(c=p.trailingComments,delete p.trailingComments);if(p)for(;p&&p.range[0]>=
this.range[0];)a=p,p=g.pop();if(a)a.leadingComments&&a.leadingComments[a.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=a.leadingComments,a.leadingComments=void 0);else if(0<L.leadingComments.length){b=[];for(d=L.leadingComments.length-1;0<=d;--d)e=L.leadingComments[d],e.range[1]<=this.range[0]&&(b.unshift(e),L.leadingComments.splice(d,1))}b&&0<b.length&&(this.leadingComments=b);c&&0<c.length&&(this.trailingComments=c);g.push(this)}},finish:function(){L.range&&(this.range[1]=
z);L.loc&&(this.loc.end=new K,L.source&&(this.loc.source=L.source));L.attachComment&&this.processComment()},finishArrayExpression:function(a){this.type=Z.ArrayExpression;this.elements=a;this.finish();return this},finishAssignmentExpression:function(a,b,c){this.type=Z.AssignmentExpression;this.operator=a;this.left=b;this.right=c;this.finish();return this},finishBinaryExpression:function(a,b,c){this.type="||"===a||"\x26\x26"===a?Z.LogicalExpression:Z.BinaryExpression;this.operator=a;this.left=b;this.right=
c;this.finish();return this},finishBlockStatement:function(a){this.type=Z.BlockStatement;this.body=a;this.finish();return this},finishBreakStatement:function(a){this.type=Z.BreakStatement;this.label=a;this.finish();return this},finishCallExpression:function(a,b){this.type=Z.CallExpression;this.callee=a;this.arguments=b;this.finish();return this},finishConditionalExpression:function(a,b,c){this.type=Z.ConditionalExpression;this.test=a;this.consequent=b;this.alternate=c;this.finish();return this},finishContinueStatement:function(a){this.type=
Z.ContinueStatement;this.label=a;this.finish();return this},finishEmptyStatement:function(){this.type=Z.EmptyStatement;this.finish();return this},finishExpressionStatement:function(a){this.type=Z.ExpressionStatement;this.expression=a;this.finish();return this},finishForStatement:function(a,b,c,g){this.type=Z.ForStatement;this.init=a;this.test=b;this.update=c;this.body=g;this.finish();return this},finishForInStatement:function(a,b,c){this.type=Z.ForInStatement;this.left=a;this.right=b;this.body=c;
this.each=!1;this.finish();return this},finishFunctionDeclaration:function(a,b,c,g){this.type=Z.FunctionDeclaration;this.id=a;this.params=b;this.defaults=c;this.body=g;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishFunctionExpression:function(a,b,c,g){this.type=Z.FunctionExpression;this.id=a;this.params=b;this.defaults=c;this.body=g;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishIdentifier:function(a){this.type=Z.Identifier;this.name=
a;this.finish();return this},finishIfStatement:function(a,b,c){this.type=Z.IfStatement;this.test=a;this.consequent=b;this.alternate=c;this.finish();return this},finishLiteral:function(a){this.type=Z.Literal;this.value=a.value;this.raw=M.slice(a.start,a.end);a.regex&&(this.regex=a.regex);this.finish();return this},finishMemberExpression:function(a,b,c){this.type=Z.MemberExpression;this.computed="["===a;this.object=b;this.property=c;this.finish();return this},finishObjectExpression:function(a){this.type=
Z.ObjectExpression;this.properties=a;this.finish();return this},finishPostfixExpression:function(a,b){this.type=Z.UpdateExpression;this.operator=a;this.argument=b;this.prefix=!1;this.finish();return this},finishProgram:function(a){this.type=Z.Program;this.body=a;this.finish();return this},finishProperty:function(a,b,c,g,d){this.type=Z.Property;this.key=b;this.value=c;this.kind=a;this.method=g;this.shorthand=d;this.finish();return this},finishReturnStatement:function(a){this.type=Z.ReturnStatement;
this.argument=a;this.finish();return this},finishUnaryExpression:function(a,b){this.type="++"===a||"--"===a?Z.UpdateExpression:Z.UnaryExpression;this.operator=a;this.argument=b;this.prefix=!0;this.finish();return this},finishVariableDeclaration:function(a,b){this.type=Z.VariableDeclaration;this.declarations=a;this.kind=b;this.finish();return this},finishVariableDeclarator:function(a,b){this.type=Z.VariableDeclarator;this.id=a;this.init=b;this.finish();return this}};m.version="2.0.0-dev";m.tokenize=
function(a,b){var c,g;c=String;"string"!==typeof a&&!(a instanceof String)&&(a=c(a));M=a;z=0;$=0<M.length?1:0;ea=0;ka=M.length;W=null;Y={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};L={};b=b||{};b.tokens=!0;L.tokens=[];L.tokenize=!0;L.openParenToken=-1;L.openCurlyToken=-1;L.range="boolean"===typeof b.range&&b.range;L.loc="boolean"===typeof b.loc&&b.loc;"boolean"===typeof b.comment&&b.comment&&(L.comments=[]);"boolean"===typeof b.tolerant&&b.tolerant&&(L.errors=
[]);try{D();if(W.type===Q.EOF)return L.tokens;for(x();W.type!==Q.EOF;)try{x()}catch(d){if(L.errors){L.errors.push(d);break}else throw d;}Ka();g=L.tokens;"undefined"!==typeof L.comments&&(g.comments=L.comments);"undefined"!==typeof L.errors&&(g.errors=L.errors)}catch(e){throw e;}finally{L={}}return g};m.parse=function(a,b){var c,g;g=String;"string"!==typeof a&&!(a instanceof String)&&(a=g(a));M=a;z=0;$=0<M.length?1:0;ea=0;ka=M.length;W=null;Y={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,
inIteration:!1,inSwitch:!1,lastCommentStart:-1};L={};"undefined"!==typeof b&&(L.range="boolean"===typeof b.range&&b.range,L.loc="boolean"===typeof b.loc&&b.loc,L.attachComment="boolean"===typeof b.attachComment&&b.attachComment,L.loc&&(null!==b.source&&void 0!==b.source)&&(L.source=g(b.source)),"boolean"===typeof b.tokens&&b.tokens&&(L.tokens=[]),"boolean"===typeof b.comment&&b.comment&&(L.comments=[]),"boolean"===typeof b.tolerant&&b.tolerant&&(L.errors=[]),L.attachComment&&(L.range=!0,L.comments=
[],L.bottomRightStack=[],L.trailingComments=[],L.leadingComments=[]));try{var d;l();D();d=new H;ha=!1;var e;g=[];for(var p,s,t;z<ka;){p=W;if(p.type!==Q.StringLiteral)break;e=Ma();g.push(e);if(e.expression.type!==Z.Literal)break;s=M.slice(p.start+1,p.end-1);"use strict"===s?(ha=!0,t&&R(t,ba.StrictOctalLiteral)):!t&&p.octal&&(t=p)}for(;z<ka;){e=Ma();if("undefined"===typeof e)break;g.push(e)}c=d.finishProgram(g);"undefined"!==typeof L.comments&&(c.comments=L.comments);"undefined"!==typeof L.tokens&&
(Ka(),c.tokens=L.tokens);"undefined"!==typeof L.errors&&(c.errors=L.errors)}catch(k){throw k;}finally{L={}}return c};m.Syntax=function(){var a,b={};"function"===typeof Object.create&&(b=Object.create(null));for(a in Z)Z.hasOwnProperty(a)&&(b[a]=Z[a]);"function"===typeof Object.freeze&&Object.freeze(b);return b}()})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(m,q,b,f,n,h,r,k,d){var c=q.getObject("dojox.gfx",!0),a=c._base={};c._hasClass=function(a,b){var c=a.getAttribute("className");return c&&0<=(" "+c+" ").indexOf(" "+b+" ")};c._addClass=function(a,b){var c=a.getAttribute("className")||"";if(!c||0>(" "+c+" ").indexOf(" "+b+" "))a.setAttribute("className",c+(c?" ":"")+b)};c._removeClass=function(a,b){var c=a.getAttribute("className");c&&a.setAttribute("className",c.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};a._getFontMeasurements=function(){var a=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},b,c;f("ie")&&(c=n.doc.documentElement.style.fontSize||"",c||(n.doc.documentElement.style.fontSize="100%"));var d=k.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},n.body());for(b in a)d.style.fontSize=b,a[b]=16*Math.round(12*d.offsetHeight/16)/12/1E3;
f("ie")&&(n.doc.documentElement.style.fontSize=c);n.body().removeChild(d);return a};var e=null;a._getCachedFontMeasurements=function(b){if(b||!e)e=a._getFontMeasurements();return e};var l=null,u={};a._getTextBox=function(a,b,c){var e,t,h=arguments.length,f;l||(l=k.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},n.body()));e=l;e.className="";t=e.style;t.borderWidth="0";t.margin="0";t.padding="0";t.outline="0";if(1<h&&b)for(f in b)f in u||(t[f]=b[f]);2<h&&c&&(e.className=
c);e.innerHTML=a;e.getBoundingClientRect?(t=e.getBoundingClientRect(),t={l:t.left,t:t.top,w:t.width||t.right-t.left,h:t.height||t.bottom-t.top}):t=d.getMarginBox(e);e.innerHTML="";return t};a._computeTextLocation=function(a,b,c,d){var e={};switch(a.align){case "end":e.x=a.x-b;break;case "middle":e.x=a.x-b/2;break;default:e.x=a.x}e.y=a.y-c*(d?0.75:1);return e};a._computeTextBoundingBox=function(b){if(!c._base._isRendered(b))return{x:0,y:0,width:0,height:0};var g;g=b.getShape();var d=b.getFont()||c.defaultFont;
b=b.getTextWidth();d=c.normalizedLength(d.size);g=a._computeTextLocation(g,b,d,!0);return{x:g.x,y:g.y,width:b,height:d}};a._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var t=0;a._getUniqueId=function(){var a;do a=m._scopeName+"xUnique"+ ++t;while(r.byId(a));return a};a._fixMsTouchAction=function(a){a=a.rawNode;"undefined"!=typeof a.style.msTouchAction&&(a.style.msTouchAction="none")};q.mixin(c,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",
points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",
color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(b){var d=
a[b];if(d)return new d;d=a[b]=new Function;d.prototype=c["default"+b];return new d}}(),normalizeColor:function(a){return a instanceof b?a:new b(a)},normalizeParameters:function(a,b){var c;if(b){var d={};for(c in a)c in b&&!(c in d)&&(a[c]=b[c])}return a},makeParameters:function(a,b){var c=null;if(!b)return q.delegate(a);var d={};for(c in a)c in d||(d[c]=q.clone(c in b?b[c]:a[c]));return d},formatNumber:function(a,b){var c=a.toString();if(0<=c.indexOf("e"))c=a.toFixed(4);else{var d=c.indexOf(".");
0<=d&&5<c.length-d&&(c=a.toFixed(4))}return 0>a?c:b?" "+c:c},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var b=c.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=a[0];b.variant=a[1];b.weight=a[2];var d=a[3].indexOf("/");b.size=0>d?a[3]:a[3].substring(0,d);var e=4;0>d&&("/"==a[4]?e=6:"/"==a[4].charAt(0)&&(e=5));e<a.length&&(b.family=a.slice(e).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return c._base._getCachedFontMeasurements()["12pt"]/
12},pt2px:function(a){return a*c.px_in_pt()},px2pt:function(a){return a/c.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var b=c.px_in_pt(),d=parseFloat(a);switch(a.slice(-2)){case "px":return d;case "pt":return d*b;case "in":return 72*d*b;case "pc":return 12*d*b;case "mm":return d*c.mm_in_pt*b;case "cm":return d*c.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,
equalSources:function(a,b){return a&&b&&a===b},switchTo:function(a){var b="string"==typeof a?c[a]:a;b&&(h.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){c[a]=b[a]}),"string"==typeof a?c.renderer=a:h.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return c.renderer=c[a]&&c[a].Surface===c.Surface?a:null}))}});return c})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),
function(m,q,b,f,n,h,r,k,d,c,a,e,l,u,t,p,g,s,v,w,y){var A={},x=function(a){var b=(new r(a.owningSystemUrl)).host;a=(new r(a.server)).host;var c=/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},D=function(a,b){return!(!x(a)||!b||!f.some(b,function(b){return b.test(a.server)}))},K,E=m(v,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=b.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=
[];this._getOAuthHash()},defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/dev\.arcgis\.com/i,
tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],registerServers:function(a){var b=this.serverInfos;b?(a=f.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=b.concat(a)):this.serverInfos=a;f.forEach(a,function(a){a.owningSystemUrl&&
this._portals.push(a.owningSystemUrl);if(a.hasPortal){this._portals.push(a.server);var b=l.defaults.io.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);p.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,""));p.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var b=this.oAuthInfos;b?(a=f.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=b.concat(a)):this.oAuthInfos=a},registerToken:function(a){var c=this._sanitizeUrl(a.server),
g=this.findServerInfo(c),d=!0,e;g||(g=new t